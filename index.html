<!DOCTYPE html>
<html>

<head>
    <title>G-Code Visualizer</title>
    <link rel="stylesheet" href="/src/style.css">
    <script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.3/ace.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>

<body>

    <div id="mainContainer" class="main-container">
        <div class="menu">
            <ul>
                <li id="simulationTab">Simulation</li>
                <li id="controlTab">Control</li>
                <li id="quickTasksTab">Quick Tasks</li>
                <li id="plannerTab">Planner</li>
                <li id="helpTab">Help</li>
            </ul>
        </div>

        <div id="simulationContainer" class="main-container">
            <div id="simulationContent" class="controls-container">
                <div id="gcodeContainer" style="position: relative;">
                    <div id="gcodeEditor" style="height: 200px; width: 100%;"></div>
                </div>
                <div class="innerContainer">
                    <input type="file" id="fileInput" accept=".txt,.gcode">
                </div>
                <div class="innerContainer">
                    <button id="simulateButton">Simulate</button>
                    <button id="clearButton">Clear</button>
                    <button id="helpButton">How to use</button>
                </div>


                <div class="innerContainer" id="loadAndSave">


                    <hr>
                    <div class="innerContainer toolbar">
                        <input type="text" class="saveGCodeNameInput" placeholder="name of save"></input>
                        <button class="saveGCodeButton" title="Save GCode to local browser storage">Save local</button>
                    </div>
                    <div class="innerContainer toolbar">
                        <select class="loadGCodeSelect"></select>
                        <button class="loadGCodeButton" title="Load GCode from local browser storage">Load</button>
                        <button class="deleteGCodeButton" title="Delete GCode from local browser storage">Delete</button>
                    </div>
                    <hr>
                </div>
            </div>

            <div class="canvas-container">
                <canvas id="gcodeCanvas" width="785" height="600"></canvas>
                <div id="sliderContainer" class="innerContainer" style="display: none; width: 400px;">
                    <input type="range" id="progressSlider" min="0" max="100" value="0" style="width: 100%;">
                    <div id="sliderLabel" style="text-align: center;"><br>Drag to see moves</div>
                </div>
                <div id="displayOptionsContainer" class="innerContainer" style="display: none;">
                    <input type="checkbox" id="showCuts" checked> Show Cut Moves
                    </label>
                    <label>
                        <input type="checkbox" id="showNonCuts" checked>
                        Show Non-Cut Moves
                    </label>
                </div>
                <div id="sliderContainer" class="innerContainer" style="display: none; width: 400px;">
                    <input type="range" id="progressSlider" min="0" max="100" value="0" style="width: 100%;">
                    <div id="sliderLabel" style="text-align: center;"><br>Drag to see moves</div>
                </div>
                <div class="innerContainer"><button id="zoomButton" title="Zoom in">Zoom In</button></div>
            </div>

        </div>

        <div id="interactiveComponentsContainer" class="main-container">
            <div id="connectionContainer" class="connection-container" style="display: none;">
                <div class="innerContainer">
                    <button id="connectButton" title="Connect to Nano ELS H4">Connect</button>
                </div>
            </div>
            <div id="controlsContainer" class="main-container" style="display: none;">
                <div id="controlsContent" class="controls-container">

                    <div id="latheControls">
                        <div id="jogControls">

                            <span id="toolText" class="tool-label" style="--col: 1; --row: 1">Current Tool</span>

                            <!-- Tools -->
                            <select class="tool-select" style="--col: 1; --row: 2" id="toolSelector">
                                <option value="T0">T0</option>
                                <option value="T1">T1</option>
                                <option value="T2">T2</option>
                                <option value="T3">T3</option>
                                <option value="T4">T4</option>
                                <option value="T5">T5</option>
                                <option value="T6">T6</option>
                                <option value="T7">T7</option>
                                <option value="T8">T8</option>
                                <option value="T9">T9</option>
                                <option value="T10">T10</option>
                                <option value="T11">T11</option>
                                <option value="T12">T12</option>
                                <option value="T13">T13</option>
                                <option value="T14">T14</option>
                                <option value="T15">T15</option>
                                <option value="T16">T16</option>
                                <option value="T17">T17</option>
                                <option value="T18">T18</option>
                                <option value="T19">T19</option>
                                <option value="T20">T20</option>
                                <option value="T21">T21</option>
                                <option value="T22">T22</option>
                                <option value="T23">T23</option>
                                <option value="T24">T24</option>
                                <option value="T25">T25</option>
                                <option value="T26">T26</option>
                                <option value="T27">T27</option>
                                <option value="T28">T28</option>
                                <option value="T29">T29</option>
                            </select>

                            <button class="tool-edit" style="--col: 1; --row: 3;" id="editToolsButton">Edit
                                Tools</button>

                            <button class="tool-btn change-tool" style="--col: 3; --row: 2;" id="toolChange">Change
                                Tool</button>

                            <span id="jogText" class="jog-labels" style="--col: 7; --row: 1">Move</span>
                            <span id="fastText" class="jog-labels" style="--col: 6; --row: 2">Fast</span>
                            <span id="slowText" class="jog-labels" style="--col: 6; --row: 3">Slow</span>
                            <button class="arrow fast jog-btn" style="--col: 7; --row: 2" id="fastForward">
                                <i class="fas fa-arrow-up"></i></button>
                            <button class="arrow fast jog-btn" style="--col: 7; --row: 6" id="fastBackward">
                                <i class="fas fa-arrow-down"></i></button>
                            <button class="arrow fast jog-btn" style="--col: 5; --row: 4" id="fastLeft">
                                <i class="fas fa-arrow-left"></i></button>
                            <button class="arrow fast jog-btn" style="--col: 9; --row: 4" id="fastRight">
                                <i class="fas fa-arrow-right"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 7; --row: 3" id="slowForward">
                                <i class="fas fa-arrow-up"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 7; --row: 5" id="slowBackward">
                                <i class="fas fa-arrow-down"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 6; --row: 4" id="slowLeft">
                                <i class="fas fa-arrow-left"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 8; --row: 4" id="slowRight">
                                <i class="fas fa-arrow-right"></i></button>
                        </div>
                        <div id="incrementControls">
                            <button class="increment-btn" data-increment="0.01">0.01</button>
                            <button class="increment-btn" data-increment="0.1">0.1</button>
                            <button class="increment-btn active" data-increment="1">1</button>
                            <button class="increment-btn" data-increment="10">10</button>
                        </div>
                        <div id="feedrateControls" class="innerContentCentre control-inputs">
                            <label for="fastFeedrate">Fast Feedrate:</label>
                            <input type="text" id="fastFeedrate" name="fastFeedrate" value="200">
                            <label for="slowFeedrate">Slow Feedrate:</label>
                            <input type="text" id="slowFeedrate" name="slowFeedrate" value="50">
                        </div>
                        <div id="distanceControl" class="innerContentCentre control-inputs">
                            <label for="moveDistance">Move Distance (mm):</label>
                            <input type="text" id="moveDistance" name="moveDistance" value="1">
                        </div>
                    </div>

                    <div id="gcodeResponseContainer" style="display: none;">
                        <div id="gcodeResponseHeader">GCode Responses</div>
                        <div id="gcodeResponseEditor" style="height: 200px; width: 100%;"></div>
                        <div class="senderError" style="display: none;"></div>
                        <div id="senderProgressContainer">
                            <span id="senderProgressLabel" style="display: none;">Progress...</span>
                            <progress id="senderProgress" max="1" style="display: none;"></progress>
                        </div>
                    </div>
                </div>
                <div class="controls-container">
                    <div class="innerContainer control-inputs">
                        <div class="innerContentCentre control-inputs">
                            <span>Send single command</span>
                        </div>
                        <div class="innerContentCentre sender-inputs">
                            <input id="singleCommandSender" type="text" name="singleCommandSender" autocomplete="off"></input>
                            <div class="innerContentCentre control-inputs">
                                <button id="gcodeSendSingleCommandButton" title="Send GCode to CNC">Send</button>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="controls-container">
                    <div id="gcodeSenderContainer" style="position: relative;">
                        <span>Send multi line commands</span>
                        <div id="gcodeSenderEditor" style="height: 200px; width: 100%;"></div>
                    </div>
                    <div class="innerContainer">
                        <button id="gcodeSenderButton" title="Send GCode to CNC">Send</button>
                        <button id="stopButton" style="display: none;">Stop</button>
                    </div>
                </div>
                <script type="module" src="/src/main.ts"></script>
            </div>
            <div id="quickTasksContainer" class="main-container" style="display: none;">
                <div id="quickTasksContent" class="controls-container">
                    <div class="innerContainer">
                        <h1>Quick Tasks</h1>
                        <button id="quickTaskFacingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- L-shape -->
                                        <path d="M5 45 L35 45 L35 5" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="50" y1="45" x2="50" y2="10" stroke="white" stroke-width="3" />

                                        <!-- Arrow head -->
                                        <path d="M42 17 L50 5 L58 17 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Facing</p>
                            </div>
                        </button>
                        <button id="quickTaskProfilingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Rotated L-shape -->
                                        <path d="M55 5 L5 5 L5 35" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="22" y1="30" x2="50" y2="30" stroke="white" stroke-width="3" />

                                        <!-- Arrow head (filled) -->
                                        <path d="M22 22 L10 30 L22 38 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Profiling</p>
                            </div>
                        </button>
                        <button id="quickTaskDrillingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Top and bottom horizontal lines -->
                                        <line x1="5" y1="18" x2="50" y2="18" stroke="white" stroke-width="2"></line>
                                        <line x1="5" y1="32" x2="50" y2="32" stroke="white" stroke-width="2"></line>
                                        
                                        <!-- Pointed tip at left -->
                                        <line x1="5" y1="18" x2="0" y2="25" stroke="white" stroke-width="2"></line>
                                        <line x1="5" y1="32" x2="0" y2="25" stroke="white" stroke-width="2"></line>
                                        
                                        <!-- Diagonal flute lines -->
                                        <line x1="10" y1="18" x2="15" y2="32" stroke="white" stroke-width="2"></line>
                                        <line x1="20" y1="18" x2="25" y2="32" stroke="white" stroke-width="2"></line>
                                        <line x1="30" y1="18" x2="35" y2="32" stroke="white" stroke-width="2"></line>
                                        <line x1="40" y1="18" x2="45" y2="32" stroke="white" stroke-width="2"></line>
                                    </svg>
                                </div>
                                <p>Drilling</p>
                            </div>
                        </button>
                        <button id="quickTaskBoringButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Correctly rotated squared U-shape (90° clockwise) -->
                                        <path d="M55 5 L5 5 L5 45 L55 45" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="22" y1="25" x2="42" y2="25" stroke="white" stroke-width="3" />

                                        <!-- Arrow head (filled) -->
                                        <path d="M22 17 L10 25 L22 33 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Boring</p>
                            </div>
                        </button>
                        <button id="quickTaskGroovingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 60">
                                        <!-- U-shape rotated correctly (facing up) -->
                                        <path d="M5 55 L5 5 L45 5 L45 55" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="25" y1="45" x2="25" y2="15" stroke="white" stroke-width="3" />

                                        <!-- Arrow head (filled) -->
                                        <path d="M17 22 L25 10 L33 22 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Grooving</p>
                            </div>
                        </button>

                        <button id="quickTaskConeButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Sideways trapezoid -->
                                        <path d="M10 5 L50 15 L50 35 L10 45 Z" fill="none" stroke="white"
                                            stroke-width="3" />
                                    </svg>
                                </div>
                                <p>Cone</p>
                            </div>
                        </button>

                        <button id="quickTaskThreadingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Background rectangle -->
                                        <!--<rect x="0" y="7.5" width="60" height="35" fill="#e0e0e0"></rect> -->

                                        <!-- Thread lines -->
                                        <line x1="6" y1="41.7" x2="18" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="15" y1="41.7" x2="27" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="24" y1="41.7" x2="36" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="33" y1="41.7" x2="45" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="42" y1="41.7" x2="54" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <!-- Corrected start of thread -->
                                        <line x1="-3" y1="41.7" x2="9" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <!-- Corrected end of thread -->
                                        <line x1="51" y1="41.7" x2="63" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                    </svg>
                                </div>
                                <p>Threading</p>
                            </div>
                        </button>
                        <button id="quickTaskToolOffsetsButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Left arrow (pointing up) - thicker shaft -->
                                        <line x1="7.5" y1="45" x2="7.5" y2="10" stroke="white" stroke-width="3" />
                                        <path d="M4 13 L7.5 7.5 L11 13 Z" fill="white" />

                                        <!-- Bottom arrow (pointing right) - thicker shaft -->
                                        <line x1="6" y1="44" x2="50" y2="44" stroke="white" stroke-width="3" />
                                        <path d="M48 40.5 L53.5 44 L48 47.5 Z" fill="white" />

                                        <!-- Gear shifted up 1 unit -->
                                        <path
                                            d="M28 9 L31 9 L32.5 13 L35 14.5 L39 11.5 L40.5 14 L38 18 L39.5 20.5 L43.5 22 L43.5 25 L39.5 26.5 L38 29 L40.5 33 L39 35.5 L35 32.5 L32.5 34 L31 38 L28 38 L26.5 34 L24 32.5 L20 35.5 L18.5 33 L21 29 L19.5 26.5 L15.5 25 L15.5 22 L19.5 20.5 L21 18 L18.5 14 L20 11.5 L24 14.5 L26.5 13 L28 9 M29.5 18 A5 5 0 0 0 29.5 29 A5 5 0 0 0 29.5 18"
                                            fill="white" />
                                    </svg>
                                </div>
                                <p>Tool Offsets</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>

            <div id="plannerContainer" class="main-container" style="display: none;">
                <div id="plannerContent" class="planner-container">
                    <div class="innerContainer">
                        <h1>Planner</h1>
                        <div class="planner-guidance">
                            <span>Use this tool to create a job of tasks to execute. This can be manual, gcode, button
                                press
                                emulation or a
                                combination
                                of them.
                                When you click execute the job wizard will execute the tasks one after another. Each
                                task
                                with require confirmation to start.</span>
                        </div>
                    </div>
                    <div id="taskContainer">
                        <div class="container-wrapper-outer">
                            <div class="container-wrapper">
                                <h2>Current Job</h2>
                                <span>Drag an available task to below</span>
                                <div id="tasksToExecute" class="task-container">
                                </div>
                            </div>
                            <div class="container-wrapper">
                                <button id="executeJobButton">Execute Job</button>
                            </div>
                            <hr>
                            <div class="container-wrapper">
                                <div class="innerContainer" id="loadAndSaveJob">
                                    <div class="innerContainer toolbar">
                                        <button id="saveJobButton" class="planner-save-button" title="Save Job to local browser storage">Save
                                            Job</button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <button id="newJobButton" class="planner-save-button" title="Create a new job">New
                                            Job</button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <button id="loadJobButton" class="planner-load-delete-buttons" title="Load Job from local browser storage">Load</button>
                                        <button id="deleteJobButton" class="planner-load-delete-buttons" title="Delete Job from local browser storage">Delete</button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <span class="planner-saving-label">Group:</span>
                                        <select id="groupLoadSelect" class="planner-load-select">
                                        </select>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <span class="planner-saving-label">Job:</span>
                                        <select id="jobLoadSelect" class="planner-load-select">
                                        </select>
                                    </div>
                                    <div class="container-wrapper-inner">
                                        <hr>
                                    </div>
                                    <span class="planner-saving-label">Import and export Job to JSON</span>
                                    <div class="innerContainer toolbar">
                                        <button id="importJobButton" class="planner-load-delete-buttons" title="Import Job from JSON file">Import</button>
                                        <button id="exportJobButton" class="planner-load-delete-buttons" title="Export Job to JSON">Export</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container-wrapper-outer">
                            <div class="container-wrapper">
                                <h2>Available Tasks</h2>
                                <div id="availableTasks" class="task-container">
                                </div>
                            </div>
                            <div class="container-wrapper">
                                <div class="container-wrapper-inner">
                                    <span>Drag here to delete</span>
                                </div>
                                <div id="deleteTasks" class="container-wrapper-delete">
                                </div>
                            </div>
                            <div class="container-wrapper">
                                <button id="addNewTaskButton">Add New Task</button>
                            </div>
                            <div class="container-wrapper-inner">
                                <hr class="no-marge">
                            </div>
                            <div class="container-wrapper">
                                <div class="innerContainer" id="loadAndSaveAvailableTasks">
                                    <div><span>Task Collections</span></div>
                                    <div class="innerContainer toolbar">
                                        <button id='saveAvailableTaskCollection' class="planner-save-button" title="Save Task to local browser storage">Save tasks to a collection
                                            <i class="far fa-save show-info icon-tooltip"
                                                data-tooltip="Save to local machine"></i>
                                        </button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <select id="availableTaskCollections" class="planner-load-select">
                                            <option value="" disabled>Select your option</option>
                                        </select>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <button id="loadTaskCollection" class="planner-load-delete-buttons" title="Load selected collection">Load collection</button>
                                        <button id="deleteTaskCollection" class="planner-load-delete-buttons" title="Delete selected collection">Delete collection</button>
                                    </div>
                                    <div class="container-wrapper-inner">
                                        <hr>
                                    </div>
                                    <span class="planner-saving-label">Import and export tasks via JSON</span>
                                    <div class="innerContainer toolbar">
                                        <button id="importAvailableTasks" class="planner-load-delete-buttons" title="Import tasks from JSON file">Import</button>
                                        <button id="exportAvailableTasks" class="planner-load-delete-buttons" title="Export tasks to JSON">Export</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="helpContainer" class="main-container" style="display: none;">
                <div id="helpContent" class="controls-container">
                    <div class="innerContainer">
                        <h1>Help Page</h1>
                        <p>Some functionality offered by this tool is not present on the Nano ELS h4/h5 controller by default such as gcode threading and tool offsets. Please see my custom firmware page to download my fork of the firmware: </p>
                        <p><a href="https://github.com/Festivejelly/nanoels/blob/main/h4/h4.ino" target="_blank">Github
                                Repo</a></p>
                    </div>
                </div>
            </div>

        </div>

        <!-------------------------------- Modals------------------------------->
        <!-- Edit Tool Modal -->
        <div id="editToolsModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Edit Tools</h2>
                <div class="modal-pad-bottom-flex">
                    <div class="modal-pad-bottom-flex">
                        <table class="table-auto flex-1">
                            <thead>
                                <tr class="flex w-full">
                                    <th class="flex-none w-16 p-1 text-left border-b">
                                        Tool
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            Z Position<br>Offset
                                        </div>
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            Z Cut<br>Compensation
                                        </div>
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            X Position<br>Offset
                                        </div>
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            X Cut<br>Compensation
                                        </div>
                                    </th>
                                    <th class="flex-none w-16 p-1 text-left border-b">
                                        Action
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="toolOffsetTableBody">
                                <!-- Rows will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-pad-bottom-flex">
                        <button id="editToolSaveAll" class="execute" title="Save Offsets for tool">
                            <div class="icon-container">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
                                    <!-- Outer disk shape -->
                                    <path d="M10 5 L40 5 L45 10 L45 40 L40 45 L10 45 L5 40 L5 10 Z" fill="none"
                                        stroke="white" stroke-width="2" />

                                    <!-- Inner rectangle (disk label) -->
                                    <rect x="15" y="5" width="20" height="15" fill="none" stroke="white"
                                        stroke-width="2" />

                                    <!-- Center circle (represents disk hole) -->
                                    <circle cx="25" cy="30" r="8" fill="none" stroke="white" stroke-width="2" />
                                </svg>
                            </div>
                            <Span>Save All</Span>
                        </button>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="editToolsModalCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Facing Modal-->
        <div id="quickTaskFacingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Facing Modal</h2>
                <div class="modal-pad-bottom">
                    <span id="quickTaskFacingDescription">The facing task will perform a facing operation based off of your current position to the centreline</span>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskFacingFeedRate">Facing Feed Rate</label>
                    <input type="text" id="quickTaskFacingFeedRate" name="quickTaskFacingFeedRate" placeholder="100">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskFacingExecuteButton" class="execute" title="Execute facing command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskFacingStopButton" class="execute" title="Stop facing command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskFacingLabel">Execution in progress...</span>
                    <progress id="quickTaskFacingProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskFacingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Profiling Modal-->
        <div id="quickTaskProfilingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Profiling Quick Task</h2>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingLength">Length to profile (mm)</label>
                    <input type="text" id="quickTaskProfilingLength" name="quickTaskProfilingLength" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingFeedRate">Cutting Feed rate</label>
                    <input type="text" id="quickTaskProfilingFeedRate" name="quickTaskProfilingFeedRate" placeholder="100">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingRetractFeedRate">Retract Feed rate</label>
                    <input type="text" id="quickTaskProfilingRetractFeedRate" name="quickTaskProfilingRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingType">Profiling Type
                        <span class="tooltip-icon"
                            data-tooltip="Absolute cuts to a specified diameter. Relative cuts to a specified depth.">?</span>
                    </label>
                    <select id="quickTaskProfilingType" name="quickTaskProfilingType">
                        <option value="Absolute" selected>Absolute</option>
                        <option value="Relative">Relative</option>
                    </select>
                </div>
                <div class="modal-pad-bottom" id="quickTaskProfilingFinalDiameterContainer">
                    <label for="quickTaskProfilingFinalDiameter">Final Diameter</label>
                    <input type="number" id="quickTaskProfilingFinalDiameter" name="quickTaskProfilingFinalDiameter" placeholder="1">
                </div>
                <div class="modal-pad-bottom" id="quickTaskProfilingDepthContainer" style="display: none;">
                    <label for="quickTaskProfilingDepth">Depth of cut (mm)</label>
                    <input type="number" id="quickTaskProfilingDepth" name="quickTaskProfilingDepth" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingPasses">Passes
                        <span class="tooltip-icon" data-tooltip="This value is calculated">?</span>
                    </label>
                    <input type="number" id="quickTaskProfilingPasses" name="quickTaskProfilingPasses" placeholder="4" value="4" min="1" step="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingDepthPerPass">Depth Per Pass (mm)
                        <span class="tooltip-icon"
                            data-tooltip="This value might get adjusted if the depth isnt devisible exactly by this value">?</span>
                    </label>
                    <input type="number" id="quickTaskProfilingDepthPerPass" name="quickTaskProfilingDepthPerPass" placeholder="0.2" value="0.2">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingFinishingDepth">Depth of finishing pass (mm)
                    </label>
                    <input type="number" id="quickTaskProfilingFinishingDepth" name="quickTaskProfilingFinishingDepth" placeholder="0.1" value="0.1">
                </div>
                <div class="modal-pad-bottom">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskProfilingExecuteButton" class="execute" title="Execute profiling command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskProfilingStopButton" class="execute" title="Stop profiling command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskProfilingLabel">Execution in progress...</span>
                    <progress id="quickTaskProfilingProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskProfilingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Drilling Modal-->
        <div id="quickTaskDrillingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Drilling Task</h2>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingDepth">Drilling Depth (mm)</label>
                    <input type="text" id="quickTaskDrillingDepth" name="quickTaskDrillingDepth" placeholder="10">
                </div>

                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingFeedRate">Drilling Feed Rate</label>
                    <input type="text" id="quickTaskDrillingFeedRate" name="quickTaskDrillingFeedRate" placeholder="50" value="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingRetractFeedRate">Retract Feed Rate</label>
                    <input type="text" id="quickTaskDrillingRetractFeedRate" name="quickTaskDrillingRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingPeckCheckbox">Peck Drilling</label>
                    <input type="checkbox" id="quickTaskDrillingPeckCheckbox" name="quickTaskDrillingPeckCheckbox" value="Pecking">
                </div>

                <div class="modal-pad-bottom" id="quickTaskDrillingPeckingDepthContainer" style="display: none;">
                    <label for="quickTaskDrillingPeckingDepth">Pecking Depth (mm)</label>
                    <input type="text" id="quickTaskDrillingPeckingDepth" name="quickTaskDrillingPeckingDepth" placeholder="2">
                </div>

                <div class="modal-pad-bottom">
                    <button id="quickTaskDrillingExecuteButton" class="execute" title="Execute drilling command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskDrillingStopButton" class="execute" title="Stop drilling command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskDrillingLabel">Execution in progress...</span>
                    <progress id="quickTaskDrillingProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskDrillingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Boring Modal-->
        <div id="quickTaskBoringModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Boring Quick Task</h2>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringDepth">Boring Hole Depth (mm)</label>
                    <input type="text" id="quickTaskBoringDepth" name="quickTaskBoringDepth" placeholder="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringFeedRate">Cut Feed Rate</label>
                    <input type="text" id="quickTaskBoringFeedRate" name="quickTaskBoringFeedRate" placeholder="100">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringRetractFeedRate">Retract Feed Rate</label>
                    <input type="text" id="quickTaskBoringRetractFeedRate" name="quickTaskBoringRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringType">Boring Type
                        <span class="tooltip-icon"
                            data-tooltip="Absolute cuts to a specified diameter. Relative cuts to a specified depth.">?</span>
                    </label>
                    <select id="quickTaskBoringType" name="quickTaskBoringType">
                        <option value="Absolute" selected>Absolute</option>
                        <option value="Relative">Relative</option>
                    </select>
                </div>
                <div class="modal-pad-bottom" id="quickTaskBoringFinalDiameterContainer">
                    <label for="quickTaskBoringFinalDiameter">Final Diameter</label>
                    <input type="number" id="quickTaskBoringFinalDiameter" name="quickTaskBoringFinalDiameter" placeholder="1">
                </div>
                <div class="modal-pad-bottom" id="quickTaskBoringDepthOfCutContainer" style="display: none;">
                    <label for="quickTaskBoringDepthOfCut">Depth of cut (mm)</label>
                    <input type="number" id="quickTaskBoringDepthOfCut" name="quickTaskBoringDepthOfCut" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringPasses">Passes
                        <span class="tooltip-icon" data-tooltip="This value is calculated">?</span>
                    </label>
                    <input type="number" id="quickTaskBoringPasses" name="quickTaskBoringPasses" placeholder="1" value="4" min="1" step="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringDepthPerPass">Depth Per Pass (mm)
                        <span class="tooltip-icon"
                            data-tooltip="This value might get adjusted if the depth isnt devisible exactly by this value">?</span>
                    </label>
                    <input type="number" id="quickTaskBoringDepthPerPass" name="quickTaskBoringDepthPerPass" placeholder="0.2" value="0.2">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringFinishingDepth">Depth of finishing pass (mm)
                    </label>
                    <input type="number" id="quickTaskBoringFinishingDepth" name="quickTaskBoringFinishingDepth" placeholder="0.1" value="0.1">
                </div>
                <div class="modal-pad-bottom">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskBoringExecuteButton" class="execute" title="Execute Boring command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskBoringStopButton" class="execute" title="Stop boring command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskBoringProgressBarLabel">Execution in progress...</span>
                    <progress id="quickTaskBoringProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskBoringCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Grooving Modal-->
        <div id="quickTaskGroovingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Grooving Modal</h2>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingDepth">Depth of groove in mm:</label>
                    <input type="text" id="quickTaskGroovingDepth" name="quickTaskGroovingDepth" placeholder="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingWidth">Width of groove in mm:</label>
                    <input type="text" id="quickTaskGroovingWidth" name="quickTaskGroovingWidth" placeholder="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingFeedRate">Cut Feed rate</label>
                    <input type="text" id="quickTaskGroovingFeedRate" name="quickTaskGroovingFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingRetractFeedRate">Retract Feed rate</label>
                    <input type="text" id="quickTaskGroovingRetractFeedRate" name="quickTaskGroovingRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskGroovingExecuteButton" class="execute" title="Execute grooving command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskGroovingStopButton" class="execute" title="Stop grooving command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskGroovingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Cone Modal-->
        <div id="quickTaskConeModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Quick Task: Cone</h2>
                <div class="modal-pad-bottom">
                    <label for="coneStartingDepth">Starting Depth (radius mm)</label>
                    <input type="text" id="coneStartingDepth" name="coneStartingDepth" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="coneEndingDepth">Ending Depth (radius mm)</label>
                    <input type="text" id="coneEndingDepth" name="coneEndingDepth" placeholder="0.2">
                </div>
                <div class="modal-pad-bottom">
                    <label for="coneInternalExternal">External or Internal</label>
                    <select id="coneInternalExternal" name="coneInternalExternal">
                        <option value="External">External</option>
                        <option value="Internal">Internal</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="coneLength">Length</label>
                    <input type="text" id="coneLength" name="coneLength" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="conePasses">Passes</label>
                    <input type="text" id="conePasses" name="conePasses" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskConeExecuteButton" class="execute" title="Execute cone command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskConeStopButton" class="execute" title="Stop cone command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskConeCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Threading Modal-->
        <div id="quickTaskThreadingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Threading Quick Task</h2>

                <div class="modal-pad-bottom">
                    <span id="quickTaskThreadingDescription">The threading task will automatically cut a thread based on the outer diameter spec of the thread.<br>
                        The beginning of the thread length will start from your current position</span>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingExternalOrInternal">External or Internal</label>
                    <select id="quickTaskThreadingExternalOrInternal" name="quickTaskThreadingExternalOrInternal">
                        <option value="External" selected>External</option>
                        <option value="Internal">Internal</option>
                    </select>
                </div>

                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingType">Threading Type</label>
                    <select id="quickTaskThreadingType" name="quickTaskThreadingType">
                        <option value="Metric" selected>Metric</option>
                        <option value="UNC">UNC</option>
                        <option value="Custom" disabled>Custom</option>
                    </select>
                </div>

                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingSize">Thread Size</label>
                    <select id="quickTaskThreadingSize" name="quickTaskThreadingSize" disabled>
                        <option value="">Select Thread Size</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingDirection">Thread Direction</label>
                    <select id="quickTaskThreadingDirection" name="quickTaskThreadingDirection">
                        <option value="Right" selected>Right handed thread</option>
                        <option value="Left">Left handed thread</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingLength">Thread Length (mm)</label>
                    <input type="text" id="quickTaskThreadingLength" name="quickTaskThreadingLength" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingPasses">Number of passes
                        <span class="tooltip-icon"
                        data-tooltip="Automatically calculated based on 0.1mm per pass. But you can set your own passes.">?</span>
                    </label>
                    <input type="text" id="quickTaskThreadingPasses" name="quickTaskThreadingPasses" placeholder="5">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskThreadingExecuteButton" class="execute" title="Execute threading command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskThreadingStopButton" class="execute" title="Stop threading command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                    <div class="modal-pad-bottom" style="display: none;">
                        <span id="quickTaskThreadingProgressBarLabel">Execution in progress...</span>
                        <progress id="quickTaskThreadingProgressBar" max="1"></progress>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskThreadingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Tool offsets Modal-->
        <div id="quickTaskToolOffsetsModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Tool offsets wizard</h2>

                <div class="modal-pad-bottom">
                    <p>Before setting offsets be sure your primary tool (T0 which should be a grooving tool) has been zero'ed on your centre line and Z reference. See this video guide: link</p>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsToolNumber">Tool Number (eg T1)</label>
                    <select type="text" id="quickTaskToolOffsetsToolNumber" name="quickTaskToolOffsetsToolNumber" placeholder="T1">
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsToolType">Tool Type
                        <span class="tooltip-icon"
                            data-tooltip="External tools touch off on front of probe, Internal on the rear.">?</span>
                    </label>
                    <select id="quickTaskToolOffsetsToolType" name="toolOffsetsToolType">
                        <option value="External-Profiling" selected>External: Profiling</option>
                        <option value="External-Facing">External: Facing</option>
                        <option value="External-Grooving">External: Grooving</option>
                        <option value="External-Threading">External: Threading</option>
                        <option value="External-Other">External: Other</option>
                        <option value="Internal-Boring">Internal: Boring</option>
                        <option value="Internal-Grooving">Internal: Grooving</option>
                        <option value="Internal-Threading">Internal: Threading</option>S
                        <option value="Internal-Other">Internal: Other</option>
                        <option value="Drill">Drill</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsOffsetX">X Value</label>
                    <input type="text" id="quickTaskToolOffsetsOffsetX" name="quickTaskToolOffsetsOffsetX" placeholder="0">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsOffsetZ">Z Value</label>
                    <input type="text" id="quickTaskToolOffsetsOffsetZ" name="quickTaskToolOffsetsOffsetZ" placeholder="0">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsProbeDiameter">Probe diameter</label>
                    <input type="text" id="quickTaskToolOffsetsProbeDiameter" name="quickTaskToolOffsetsProbeDiameter" placeholder="5">
                </div>
                <div class="modal-pad-bottom">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskToolOffsetsExecuteButton" class="execute" title="Set tool offset">
                        <Span>Set Tool Offset</Span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskToolOffsetsStopButton" class="execute" title="Stop gcode" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                    <div class="modal-pad-bottom" style="display: none;">
                        <span id="quickTaskToolOffsetsLabel">Execution in progress...</span>
                        <progress id="quickTaskToolOffsetsProgressBar" max="1"></progress>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskToolOffsetsCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Not Connected warning -->
        <div id="notConnectedModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Not Connected</h2>
                <div class="modal-pad-bottom">
                    <span>Please connect to the controller before executing jobs</span>
                </div>
                <div class="modal-pad">
                    <button id="notConnectedCloseButton">Close</button>
                </div>
            </div>
        </div>
        <!-- Manual Task Modal -->
        <div id="manualTaskModal" class="task-modal">
            <div class="task-modal-content">
                <h2>Manual Task Instructions</h2>
                <hr>
                <div>
                    <span id="manualTaskName"></span>
                </div>
                <div class="modal-pad">
                    <textarea id="manualTaskInstructions" name="manualTaskInstructions" class="full-width-textarea" rows="4" cols="50" disabled></textarea>
                </div>
                <div class="modal-pad">
                    <button id="cancelManualTask">Cancel</button>
                    <button id="completeManualTask" class="interaction-ready-button">Next Task --></button>
                </div>
            </div>
        </div>
        <!-- Gcode Task Modal -->
        <div id="cncTaskModal" class="task-modal">
            <div class="task-modal-content">
                <h2>CNC Task Gcode</h2>
                <hr>
                <div>
                    <span id="cncTaskName"></span>
                </div>
                <div class="modal-pad">
                    <textarea id="cncTaskGcode" name="cncTaskGcode" class="full-width-textarea" rows="4" cols="50" disabled></textarea>
                </div>
                <div class="modal-pad">
                    <button id="cancelCncTask">Cancel</button>
                    <button id="executeGcode">Execute Gcode</button>
                </div>
                <div class="modal-pad">
                    <button id="completeCncTask" disabled>Next Task --></button>
                </div>
                <div id="currentGcodeLineContainer" class="modal-pad">
                    <span id="currentGcodeLineLabel">Current Gcode Line:</span>
                    <span id="currentGcodeLine"></span>
                </div>
                <div id="currentFeedrateContainer" class="modal-pad">
                    <span id="currentFeedrateLabel">Current Feedrate:</span>
                    <span id="currentFeedrate"></span>
                </div>
                <div id="cncTaskSenderProgressContainer" class="modal-pad">
                    <span id="cncTaskSenderProgressLabel">Execution in progress...</span>
                    <progress id="cncTaskSenderProgress" max="1"></progress>
                </div>
            </div>
        </div>
        <!-- key Emulation Task Modal -->
        <div id="emulationTaskModal" class="task-modal">
            <div class="task-modal-content">
                <h2>Key Emulation Task</h2>
                <hr>
                <div>
                    <span id="emulationTaskName"></span>
                </div>
                <div class="modal-pad">
                    <ul id="emulationExecutionTasks">
                        <!-- List items will be added here -->
                    </ul>
                    <div class="modal-pad">
                        <button id="completeEmulationTask" disabled>Mark Complete</button>
                    </div>
                    <div id="emulationTaskSenderProgressContainer" class="modal-pad">
                        <span id="emulationTaskSenderProgressLabel">Execution in progress...</span>
                        <progress id="emulationTaskSenderProgress" max="1"></progress>
                    </div>
                </div>
            </div>
        </div>
        <!-- All tasks Complete Modal -->
        <div id="completeTaskModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>All Tasks Complete</h2>
                <div class="modal-pad">
                    <button id="completeTaskCloseButton">Close</button>
                </div>
            </div>
        </div>
        <!-- Job Cancelled Modal -->
        <div id="jobCancelledModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Job Cancelled</h2>
                <div>
                    <button id="jobCancelledCloseButton">Close</button>
                </div>
            </div>
        </div>
        <!-- Save Job Modal -->
        <div id="saveJobModal" class="task-modal">
            <div class="task-modal-content">
                <span id="saveJobModalClose" class="close-modal">&times;</span>
                <h2>Save Job</h2>
                <hr>
                <div class="modal-pad">Job Group Name:</div>
                <div>
                    <select id="saveJobGroupNameSelect">
                    </select>
                </div>
                <div id="newJobGroupNameContainer" style="display: none;">
                    <div class="modal-pad">New Job Group name:</div>
                    <div>
                        <input id="saveJobGroupNameInput" type="text" class="planner-save-text" placeholder="Name of Group"></input>
                    </div>
                </div>
                <div class="modal-pad">Name of Job:</div>
                <div>
                    <select id="saveJobNameSelect">
                    </select>
                </div>
                <div id="newJobNameContainer" style="display: none;">
                    <div class="modal-pad">New Job name:</div>
                    <div>
                        <input id="saveJobNameInput" type="text" class="planner-save-text" placeholder="Name of Job"></input>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="saveJobSaveButton">Save</button>
                </div>
            </div>
        </div>
        <!-- export Job Modal -->
        <div id="exportJobModal" class="task-modal">
            <div class="task-modal-content">
                <span id="exportJobModalClose" class="close-modal">&times;</span>
                <h2>Export Job</h2>
                <hr>
                <div class="modal-pad">Job Group:</div>
                <div>
                    <select id="exportJobGroupNameSelect">
                    </select>
                </div>
                <div class="modal-pad">Job:</div>
                <div>
                    <select id="exportJobNameSelect">
                    </select>
                </div>
                <div class="modal-pad">
                    <button id="exportJobSaveButton">Save</button>
                </div>
            </div>
        </div>
        <!-- Save Collection -->
        <div id="saveCollectionModal" class="task-modal">
            <div class="task-modal-content">
                <span id="saveCollectionModalClose" class="close-modal">&times;</span>
                <div>
                    <div>Which collection would you like to save the tasks to?</div>
                    <div class="modal-pad">
                        <select id="saveCollectionModalToSaveTo" name="collectionToSaveToModal">
                        </select>
                    </div>
                    <div id="newCollectionNameContainerModal" style="display: none;">
                        <div class="modal-pad">New Collection Name:</div>
                        <div>
                            <input type="text" id="newCollectionNameModal" name="newCollectionNameModal" placeholder="Enter collection name...">
                        </div>
                    </div>

                    <div class="modal-pad">
                        <button id="saveAvailableTaskCollectionButtonModal">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- new task modal-->
        <div id="newTaskModal" class="task-modal">
            <div class="task-modal-content">
                <span id="closeNewTaskModal" class="close-modal">&times;</span>
                <div id="newTaskHelpText">
                    <h2 id="taskTextTitle">Add a new task</h2>
                    <hr>
                    <div class="modal-pad">Task Name:</div>
                    <div>
                        <input type="text" id="newTaskName" name="newTaskName" placeholder="Enter task name...">
                    </div>
                    <div class="modal-pad">Task Type:</div>
                    <div>
                        <select id="newTaskType" name="newTaskType">
                            <option value="manual">Manual</option>
                            <option value="gcode">GCode</option>
                            <option value="emulation" disabled>Key Emulation</option>
                        </select>
                    </div>
                    <div class="modal-pad">Task Description:</div>
                    <div>
                        <textarea id="newTaskDescription" name="newTaskDescription" class="full-width-textarea" rows="4" cols="50" placeholder="Enter Description..."></textarea>
                    </div>
                    <div id="gcodeTaskContainer" style="display:none">
                        <div class="modal-pad">Task GCode:</div>
                        <div>
                            <textarea id="newTaskGcode" name="newTaskGcode" class="full-width-textarea" rows="4" cols="50" placeholder="Disabled for manual tasks" disabled></textarea>
                        </div>

                        <div class="modal-pad">
                            <label for="newTaskGcodeRepeatable">
                                <input type="checkbox" id="newTaskGcodeRepeatable" name="newTaskGcodeRepeatable">
                                Check to make task repeatable
                            </label>
                        </div>
                    </div>
                    <hr>
                    <div id="emulationOuterContainer" class="emulate-noselect" style="display:none">
                        <div>
                            <span>Use built in controller functions by emulating button presses
                                Simply click the buttons you want to emulate to build up a sequence which will be
                                displayed at the bottom. Each emulated press will have a 500ms delay between them.
                                <br>
                                <br>
                                <i>Tip: Hover over the buttons for a description.</i>
                            </span>
                        </div>
                        <div id="emulationInnerContainer">
                            <div class="flexCol outerCol">
                                <div id="numberContainer">
                                    <div id="emulationNewTasksNumbers">
                                        <button id="emulateKey9" data-button-key="B_9" class="standard-font material-symbols-outlined">
                                            9
                                        </button>
                                        <button id="emulateKey8" data-button-key="B_8" class="standard-font material-symbols-outlined">
                                            8
                                        </button>
                                        <button id="emulateKey7" data-button-key="B_7" class="standard-font material-symbols-outlined">
                                            7
                                        </button>
                                        <button id="emulateKey6" data-button-key="B_6" class="standard-font material-symbols-outlined">
                                            6
                                        </button>
                                        <button id="emulateKey5" data-button-key="B_5" class="standard-font material-symbols-outlined">
                                            5
                                        </button>
                                        <button id="emulateKey4" data-button-key="B_4" class="standard-font material-symbols-outlined">
                                            4
                                        </button>
                                        <button id="emulateKey3" data-button-key="B_3" class="standard-font material-symbols-outlined">
                                            3
                                        </button>
                                        <button id="emulateKey2" data-button-key="B_2" class="standard-font material-symbols-outlined">
                                            2
                                        </button>
                                        <button id="emulateKey1" data-button-key="B_1" class="standard-font material-symbols-outlined">
                                            1
                                        </button>
                                        <button id="emulateKey0" data-button-key="B_0" class="standard-font material-symbols-outlined">
                                            0
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="flexCol middleCol">
                                <div id="modeContainer">
                                    <div id="emulationNewTasksMode">
                                        <button id="emulateKeyBack" data-button-key="B_BACKSPACE" class="material-symbols-outlined">
                                            backspace
                                        </button>
                                        <button id="emulateKeyGearbox" data-button-key="B_MODE_GEARS" class="material-symbols-outlined">
                                            manufacturing
                                        </button>
                                        <button id="emulateKeyTurning" data-button-key="B_MODE_TURN" class="material-symbols-outlined">
                                            reply
                                        </button>
                                        <button id="emulateKeyFacing" data-button-key="B_MODE_FACE" class="material-symbols-outlined">
                                            turn_slight_left
                                        </button>
                                        <button id="emulateKeyCone" data-button-key="B_MODE_CONE" class="material-symbols-outlined">
                                            arrow_forward_ios
                                        </button>
                                        <button id="emulateKeyParting" data-button-key="B_MODE_CUT" class="material-symbols-outlined">
                                            publish
                                        </button>
                                        <button id="emulateKeyThreading" data-button-key="B_MODE_THREAD" class="material-symbols-outlined">
                                            home_improvement_and_tools
                                        </button>
                                        <button id="emulateKeyMode" data-button-key="B_MODE_OTHER" class="standard-font material-symbols-outlined">
                                            M
                                        </button>
                                    </div>
                                </div>
                                <div id="movementContainer">
                                    <div id="emulationNewTasksMovement">
                                        <button id="emulateKeyLeft" data-button-key="B_LEFT" class="material-symbols-outlined">
                                            arrow_left_alt
                                        </button>
                                        <button id="emulateKeyRight" data-button-key="B_RIGHT" class="material-symbols-outlined">
                                            arrow_right_alt
                                        </button>
                                        <button id="emulateKeyUp" data-button-key="B_UP" class="material-symbols-outlined">
                                            arrow_upward_alt
                                        </button>
                                        <button id="emulateKeyDown" data-button-key="B_DOWN" class="material-symbols-outlined">
                                            arrow_downward_alt
                                        </button>
                                        <button id="emulateKeyPlay" data-button-key="B_ON" class="material-symbols-outlined">
                                            play_arrow
                                        </button>
                                        <button id="emulateKeyStop" data-button-key="B_OFF" class="material-symbols-outlined">
                                            crop_square
                                        </button>
                                        <button id="emulateKeyStopLeft" data-button-key="B_STOPL" class="material-symbols-outlined">
                                            keyboard_tab_rtl
                                        </button>
                                        <button id="emulateKeyStopRight" data-button-key="B_STOPR" class="material-symbols-outlined">
                                            keyboard_tab
                                        </button>
                                        <button id="emulateKeyStopUp" data-button-key="B_STOPU" class="material-symbols-outlined">
                                            vertical_align_top
                                        </button>
                                        <button id="emulateKeyStopDown" data-button-key="B_STOPD" class="material-symbols-outlined">
                                            vertical_align_bottom
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="flexCol outerCol">
                                <div id="otherContainer">
                                    <div id="emulationNewTasksOther">
                                        <button id="emulateKeyZ" data-button-key="B_Z" class="standard-font material-symbols-outlined">
                                            Z
                                        </button>
                                        <button id="emulateKeyX" data-button-key="B_X" class="standard-font material-symbols-outlined">
                                            X
                                        </button>
                                        <button id="emulateKeyB" data-button-key="B_B" class="standard-font material-symbols-outlined">
                                            B
                                        </button>
                                        <button id="emulateKeyA" data-button-key="B_A" class="standard-font material-symbols-outlined">
                                            A
                                        </button>
                                        <button id="emulateKeyAngle" data-button-key="B_DISPL" class="material-symbols-outlined" title="Angle/Taco">
                                            rotate_left
                                        </button>
                                        <button id="emulateKeySteps" data-button-key="B_STEPZ" class="material-symbols-outlined">
                                            signal_cellular_alt
                                        </button>
                                        <button id="emulateKeySettings" data-button-key="B_SETTINGS" class="material-symbols-outlined">
                                            settings
                                        </button>
                                        <button id="emulateKeyReverse" data-button-key="B_REVERSE" class="material-symbols-outlined">
                                            sync_alt
                                        </button>
                                        <button id="emulateKeyMeasure" data-button-key="B_MEASURE" class="material-symbols-outlined">
                                            space_bar
                                        </button>
                                        <button id="emulateKeyPlus" data-button-key="B_PLUS" class="standard-font material-symbols-outlined">
                                            +
                                        </button>
                                        <button id="emulateKeyMinus" data-button-key="B_MINUS" class="standard-font material-symbols-outlined">
                                            -
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <span>
                                Emulated sequence: <i>Tip: Drag to reorder or delete</i>
                            </span>
                        </div>
                        <div class="emulation-modal-pad-border">
                            <div id="emulationNewTasks">
                            </div>
                        </div>
                        <div class="modal-pad-bottom">
                            <div id="emulatedTasksDelete" class="container-wrapper-inner">
                                <span>
                                    Drag here to delete
                                </span>
                            </div>
                            <div id="emulatedButtonListDelete" class="container-wrapper-delete">

                            </div>
                        </div>
                    </div>
                    <div class="modal-pad">Collection to save to:</div>
                    <div>
                        <select id="collectionToSaveTo" name="collectionToSaveTo">
                        </select>
                    </div>
                    <div id="newCollectionNameContainer" style="display: none;">
                        <div class="modal-pad">New Collection Name:</div>
                        <div>
                            <input type="text" id="newCollectionName" name="newCollectionName" placeholder="Enter collection name...">
                        </div>
                    </div>
                    <div class="modal-pad">
                        <button id="saveNewTaskButton">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="helpModal" class="help-modal">
            <div class="help-modal-content">
                <span id="closeHelpModal" class="close-modal">&times;</span>
                <div id="helpText">
                    <div>This tool is designed to be used in conjunction with LatheCode:</div>
                    <div><a href="https://kachurovskiy.github.io/lathecode/" target="_blank">https://kachurovskiy.github.io/lathecode/</a></div>
                    <div><strong>Please note that this tool is to be used at your own risk and I cannot gaurentee that
                            it will work. This tool targets my custom fork of the H4 firmware which you can find
                            here:</strong> <a href="https://github.com/Festivejelly/nanoels" target="_blank">https://github.com/Festivejelly/nanoels</a></div>
                    <hr>
                    <div>How to use:</div>
                    <ul style="list-style-type: disc; padding-left: 20px;">
                        <li>Use LatheCode to generate the G-code, then paste it into this tool.</li>
                        <li>You can also write the G-code by hand for simple operations such as boring or grooving.
                            <a href="#" id="exampleCode">Click here</a> to load an example.
                        </li>
                        <li>Click"Simulate" to plot the moves onto the canvas.</li>
                        <li>movement lines marked with"; cut" will show in <span class="line red-line"></span><span class="text-red">red</span>.</li>
                        <li>movement lines marked with"; travel" will show in <span class="line green-line"></span><span class="text-green">green</span>.</li>
                        <li>movement lines marked with"; retract" will show in <span class="line orange-line"></span><span class="text-orange">orange</span>.</li>
                        <li>movement lines not marked will default to <span class="line green-line"></span><span class="text-green">green</span>.</li>
                        <li>All other moves will be considered travel moves and will show in green.</li>
                        <li>Any G-code you paste or write can be saved into the browser's local storage. This is useful for saving common operations.</li>
                        <li>When you're ready, you can send the G-code to the Nano ELS H4 by clicking"Send."
                        </li>
                        <li>More functionality to come soon! Version 0.2</li>
                        <li>Please provide feedback, raise issues or make suggestions here: <a href="https://github.com/Festivejelly/LatheGcodeVisualiser" target="_blank">https://github.com/Festivejelly/LatheGcodeVisualiser</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="zoomModal" class="zoom-modal">
            <div class="zoom-modal-content" style="background-color: #242424;">
                <span id="closeZoomModal" class="close-modal">&times;</span>
                <canvas id="zoomCanvas" width="1600" height="1200"></canvas>
                <div id="sliderAndButtonContainer">
                    <div id="zoomSliderContainer" class="innerContainer" style="width: 400px;">
                        <input type="range" id="zoomProgressSlider" min="0" max="100" value="0" style="width: 100%;">
                        <div id="zoomSliderLabel" style="text-align: center;"><br>Drag to see moves</div>
                    </div>
                    <div id="displayOptionsContainerZoom" class="innerContainer">
                        <input type="checkbox" id="showCutsZoom" checked> Show Cut Moves
                        </label>
                        <label>
                            <input type="checkbox" id="showNonCutsZoom" checked>
                            Show Non-Cut Moves
                        </label>
                    </div>
                    <button id="zoomCloseButton">Close</button>
                </div>
            </div>
        </div>
    </div>
</body>

</html>