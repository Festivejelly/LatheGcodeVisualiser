<!DOCTYPE html>
<html>

<head>
    <title>G-Code Visualizer</title>
    <script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.3/ace.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <script type="module" crossorigin>
var bt=Object.defineProperty;var Ct=(e,n,o)=>n in e?bt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o;var De=(e,n,o)=>(Ct(e,typeof n!="symbol"?n+"":n,o),o);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();var SenderClient=(e=>(e.GCODE="gcode",e.PLANNER="planner",e.QUICKTASKS="quicktasks",e))(SenderClient||{});class SenderStatus{constructor(n,o,i,s,r,l,p,c,g,y,M,h,Te){this.isConnected=n,this.condition=o,this.error=i,this.progress=s,this.currentLine=r,this.feedRate=l,this.z=p,this.x=c,this.y=g,this.feed=y,this.rpm=M,this.version=h,this.lastResponse=Te}}const dt=class dt{constructor(){De(this,"listeners",[]);De(this,"activeClient",null);De(this,"port",null);De(this,"readTimeout",0);De(this,"reader",null);De(this,"writer",null);De(this,"isOn",!1);De(this,"waitForOkOrError",!1);De(this,"lines",[]);De(this,"lineIndex",0);De(this,"unparsedResponse","");De(this,"remainingResponse","");De(this,"error","");De(this,"statusReceived",!1);De(this,"currentLine","");De(this,"feedRate",0);De(this,"z",0);De(this,"x",0);De(this,"y",0);De(this,"feed",0);De(this,"rpm",0);De(this,"isDisconnecting",!1);De(this,"lastStatus",null);De(this,"version","");De(this,"lastResponse","");De(this,"currentCommandListeners",[]);De(this,"remainingStatus","")}static getInstance(){return dt.instance||(dt.instance=new dt),dt.instance}setActiveClient(n){this.activeClient=n,console.log(`Active client set to: ${n}`)}clearActiveClient(){this.activeClient=null,console.log("Active client cleared")}getStatus(){return this.lastStatus=new SenderStatus(this.port!==null,this.isOn?"run":"idle",this.error,this.lines.length?this.lineIndex/this.lines.length:0,this.currentLine,this.feedRate,this.z,this.x,this.y,this.feed,this.rpm,this.version,this.lastResponse),this.lastStatus}getCurrentCommand(){return this.currentLine}addStatusChangeListener(n,o){this.listeners.push({callback:n,client:o})}notifyStatusChange(){this.listeners.forEach(n=>{n.client===this.activeClient?(console.debug(`Notifying ${n.client} listener`),n.callback()):console.debug(`Skipping ${n.client} listener (not active)`)})}addCurrentCommandListener(n){this.currentCommandListeners.push(n)}notifyCurrentCommand(n){this.currentCommandListeners.forEach(o=>o(n))}setStatus(n){if(n=this.remainingStatus+n,this.remainingStatus="",n.startsWith("<")&&(n=n.substring(1)),n.endsWith(">"))n=n.slice(0,-1);else{this.remainingStatus=n;return}const o=n.split("|");if(o.length>=3){if(this.statusReceived=!0,o[1].startsWith("WPos:")){const i=o[1].substring(5).split(",");this.x=Number(i[0]),this.y=Number(i[1]),this.z=Number(i[2])}if(o[2].startsWith("FS:")){const i=o[2].substring(3).split(",");this.feed=Number(i[0]),this.rpm=Number(i[1])}o[3].startsWith("Id:")&&(this.version=String(o[3].substring(3)))}this.notifyStatusChange(),appendLineToResponseEditor(`response: ${n}`),console.log(`response: "${n}"`)}setError(n){this.error=n,appendLineToResponseEditor(n),this.notifyStatusChange()}isConnected(){return this.lastStatus!==null&&this.lastStatus.isConnected}async connect(){try{if(this.setActiveClient("gcode"),this.port)this.closePort();else{if(await this.selectPort(),this.write("!"),await this.askForStatus(),!await waitForTrue(()=>this.statusReceived)){this.setError("Device is not reponding, is it in GCODE mode?");return}this.isDisconnecting=!1,this.isOn=!1,this.setError(""),this.waitForOkOrError=!1,this.unparsedResponse=""}}catch(n){console.log(n)}this.notifyStatusChange()}async disconnect(){this.isDisconnecting=!0,this.port&&this.closePort()}getDisconnectingStatus(){return this.isDisconnecting}async start(n,o){n&&(this.setActiveClient(o),this.isOn=!0,this.lines=n.split(`
`),this.lineIndex=0,this.waitForOkOrError=!1,this.write("~"),this.writeCurrentLine(),this.notifyStatusChange())}async sendCommand(n,o){this.setActiveClient(o),this.isOn=!0,this.lines=[n],this.lineIndex=0,this.waitForOkOrError=!1,this.write("~"),this.writeCurrentLine(),this.notifyStatusChange()}async sendCommands(n,o){this.setActiveClient(o),this.isOn=!0,this.lines=n,this.lineIndex=0,this.waitForOkOrError=!1,this.write("~"),this.writeCurrentLine(),this.notifyStatusChange()}async getPosition(n){if(this.setActiveClient(n),this.statusReceived=!1,await this.write("?"),!await waitForTrue(()=>this.statusReceived))throw new Error("Failed to get position update");return this.notifyStatusChange(),this.getStatus()}async getToolOffsets(n){if(this.setActiveClient(n),this.lastResponse="",await this.sendCommand("#",n),!await waitForTrueWithTimeout(()=>this.lastResponse.includes("toolOffsets:")&&this.lastResponse.includes("ok"),50,100))throw new Error("Failed to get tool offsets");return this.stop(),this.lastResponse}async stop(){this.error="",await this.write("!"),this.isOn&&(this.isOn=!1,this.notifyStatusChange(),this.clearActiveClient())}async write(n){if(this.port){if(console.log("command: ",n),!this.port.writable){n!="?"&&this.setError("Port is not writable, try reconnecting the USB and switching to GCODE mode.");return}if(!this.writer)try{const o=new TextEncoderStream;o.readable.pipeTo(this.port.writable),this.writer=o.writable.getWriter()}catch(o){this.setError("Failed to write: "+o);return}await this.writer.write(n)}}async writeCurrentLine(){if(!this.isOn||this.waitForOkOrError)return;if(this.lineIndex>=this.lines.length){this.stop();return}const n=this.lines[this.lineIndex].split(";")[0].trim();if(!n){this.lineIndex++,this.writeCurrentLine();return}this.currentLine=n,this.notifyCurrentCommand(this.currentLine),this.waitForOkOrError=!0,appendLineToResponseEditor(`command: ${n}`),await this.write(n+`
`),await this.readFromPort()}async processResponse(n){this.unparsedResponse=(this.remainingResponse+n).trimStart(),this.remainingResponse="";const o=this.unparsedResponse.split(/\r?\n/).map(i=>i.replace(/\r/g,""));for(let i of o){const s=i.match(/(<[^>]+>)/);if(s&&s.length>1){s.shift();for(const r of s)i=i.replace(r,"");this.setStatus(s.pop())}i.startsWith("error:")?(this.remainingResponse+=i,appendLineToResponseEditor(`response: ${this.remainingResponse}`),console.log(`response: "${this.remainingResponse}"`),this.setError(i),this.remainingResponse="",this.stop()):i.startsWith("ok")||i.endsWith("ok")?(this.remainingResponse+=i,appendLineToResponseEditor(`response: ${this.remainingResponse}`),this.lastResponse=this.remainingResponse,console.log(`response: "${this.remainingResponse}"`),this.remainingResponse="",this.waitForOkOrError=!1,this.lineIndex++,this.notifyStatusChange(),this.isOn&&await this.writeCurrentLine()):this.remainingResponse+=i}this.unparsedResponse=""}async selectPort(){if(this.port&&this.closePort(),navigator.serial?this.port=await navigator.serial.requestPort():(this.error="This browser does not support Serial API, try Chrome or Edge",this.notifyStatusChange()),this.port)try{await this.port.open({baudRate:115200}),this.notifyStatusChange(),this.readSoon()}catch(n){this.setError(`Unable to open port - likely some other app is using it - try closing Arduino IDE.
${n}`),this.closePort()}}async askForStatus(){try{await this.write("?")}catch(n){this.setError(`Device disconnected? ${n}`),this.closePort()}}readSoon(){clearTimeout(this.readTimeout),this.readTimeout=window.setTimeout(()=>this.readFromPort(),200)}async readFromPort(){if(this.port)try{if(!this.port.readable){this.readSoon();return}if(!this.reader){const o=new TextDecoderStream;this.port.readable.pipeTo(o.writable),this.reader=o.readable.getReader()}const{value:n}=await this.reader.read();if(!n){this.readSoon();return}await this.processResponse(n),this.readSoon()}catch(n){this.setError(n.message||String(n)),this.closePort()}}async closePort(){if(this.port){if(clearTimeout(this.readTimeout),this.reader){try{await this.reader.cancel(),this.reader.releaseLock()}catch(n){console.error("Error cancelling reader: ",n)}this.reader=null}if(this.writer){try{await this.writer.close(),this.writer.releaseLock()}catch(n){console.error("Error closing writer: ",n)}this.writer=null}await new Promise(n=>setTimeout(n,500));try{await this.port.close()}catch(n){console.error("Error closing port: ",n)}this.port=null,this.statusReceived=!1,this.z=0,this.x=0,this.feed=0,this.rpm=0}}};De(dt,"instance",null);let Sender=dt;function appendLineToResponseEditor(e){var n=gcodeResponseEditor.getSession(),o=n.getLength(),i=new Date().toLocaleTimeString(),s=`[${i}] ${e}
`;n.insert({row:o,column:0},s)}function waitForTrue(e){return new Promise(n=>{let o=0;function i(){e()?n(!0):o>=10?n(!1):(o++,setTimeout(i,100))}i()})}function waitForTrueWithTimeout(e,n=50,o=100){return new Promise(i=>{let s=0;function r(){e()?i(!0):s>=n?i(!1):(s++,setTimeout(r,o))}r()})}const gcodeCommands=[{command:"?",description:"Get position and version info"},{command:"#",description:"Display tool offsets"},{command:"!",description:"Stop running Gcode"},{command:"~",description:"Continue running Gcode"},{command:"M17 Y",description:"Enable Y axis"},{command:"M18 Y",description:"Disable Y axis"},{command:"G90",description:"Set to absolute positioning"},{command:"G91",description:"Set to relative positioning"}];class GCode{constructor(){De(this,"sendButton");De(this,"sendSingleCommandButton");De(this,"stopButton");De(this,"senderError");De(this,"runProgress");De(this,"runProgressLabel");De(this,"connectButton");De(this,"gcodeResponseContainer");De(this,"jogButtons");De(this,"toolButtons");De(this,"sender");De(this,"singleCommandSender");De(this,"minimumVersion");De(this,"editTools");De(this,"editToolsModal");De(this,"editToolsClose");De(this,"editToolSaveAll");De(this,"fastFeedrateInput");De(this,"slowFeedrateInput");De(this,"moveDistanceInput");const n=document.getElementById("singleCommandSender");n.placeholder="Type or select G-code command...",n.addEventListener("click",()=>{let c=document.getElementById("gcode-dropdown");if(!c){c=document.createElement("div"),c.id="gcode-dropdown",c.className="gcode-dropdown",gcodeCommands.forEach(({command:y,description:M})=>{const h=document.createElement("div");h.textContent=`${y} - ${M}`,h.className="gcode-option",h.addEventListener("click",()=>{n.value=y,c.remove()}),c.appendChild(h)});const g=n.getBoundingClientRect();c.style.left=g.left+"px",c.style.top=g.bottom+2+"px",c.style.width=g.width+"px",document.body.appendChild(c)}}),document.addEventListener("click",c=>{const g=document.getElementById("gcode-dropdown");g&&!n.contains(c.target)&&!g.contains(c.target)&&g.remove()}),this.minimumVersion="H4V12FJ",this.senderError=document.querySelector(".senderError"),this.runProgress=document.getElementById("senderProgress"),this.runProgressLabel=document.getElementById("senderProgressLabel"),this.connectButton=document.getElementById("connectButton"),this.gcodeResponseContainer=document.getElementById("gcodeResponseContainer"),this.moveDistanceInput=document.getElementById("moveDistance"),this.fastFeedrateInput=document.getElementById("fastFeedrate"),this.slowFeedrateInput=document.getElementById("slowFeedrate"),this.jogButtons=document.querySelectorAll("#latheControls .jog-btn"),this.toolButtons=document.querySelectorAll("#latheControls .tool-btn"),this.sendButton=document.getElementById("gcodeSenderButton"),this.sendSingleCommandButton=document.getElementById("gcodeSendSingleCommandButton"),this.singleCommandSender=document.getElementById("singleCommandSender"),this.sender=Sender.getInstance(),this.sender.addStatusChangeListener(()=>this.handleStatusChange(),SenderClient.GCODE);let o=localStorage.getItem("fastFeedrate"),i=localStorage.getItem("slowFeedrate"),s=localStorage.getItem("moveDistance");o&&(this.fastFeedrateInput.value=o,localStorage.setItem("fastFeedrate",o)),i&&(this.slowFeedrateInput.value=i,localStorage.setItem("slowFeedrate",i)),s&&(this.moveDistanceInput.value=s,localStorage.setItem("moveDistance",s)),this.fastFeedrateInput.addEventListener("change",()=>{localStorage.setItem("fastFeedrate",this.fastFeedrateInput.value)}),this.slowFeedrateInput.addEventListener("change",()=>{localStorage.setItem("slowFeedrate",this.slowFeedrateInput.value)}),this.moveDistanceInput.addEventListener("change",()=>{localStorage.setItem("moveDistance",this.moveDistanceInput.value)}),this.jogButtons.forEach(c=>{c.addEventListener("click",()=>{var Fe;if(!((Fe=this.sender)!=null&&Fe.isConnected())){alert("Please connect to the controller first.");return}let g="",y="",M="",h=!0;c.id=="fastForward"?(g=this.fastFeedrateInput.value,y="X",M=this.moveDistanceInput.value,h=!0):c.id=="slowForward"?(g=this.slowFeedrateInput.value,y="X",M=this.moveDistanceInput.value,h=!0):c.id=="fastBackward"?(g=this.fastFeedrateInput.value,y="X",M=this.moveDistanceInput.value,h=!1):c.id=="slowBackward"?(g=this.slowFeedrateInput.value,y="X",M=this.moveDistanceInput.value,h=!1):c.id=="fastLeft"?(g=this.fastFeedrateInput.value,y="Z",M=this.moveDistanceInput.value,h=!0):c.id=="slowLeft"?(g=this.slowFeedrateInput.value,y="Z",M=this.moveDistanceInput.value,h=!0):c.id=="fastRight"?(g=this.fastFeedrateInput.value,y="Z",M=this.moveDistanceInput.value,h=!1):c.id=="slowRight"?(g=this.slowFeedrateInput.value,y="Z",M=this.moveDistanceInput.value,h=!1):c.id=="fastUp"?(g=this.fastFeedrateInput.value,y="Y",M=this.moveDistanceInput.value,h=!0):c.id=="slowUp"?(g=this.slowFeedrateInput.value,y="Y",M=this.moveDistanceInput.value,h=!0):c.id=="fastDown"?(g=this.fastFeedrateInput.value,y="Y",M=this.moveDistanceInput.value,h=!1):c.id=="slowDown"&&(g=this.slowFeedrateInput.value,y="Y",M=this.moveDistanceInput.value,h=!1);let Pe=`G0 ${y}${h===!0?"":"-"}${M} F${g}`;if(this.sender){let $=new Array(3);$[0]="G91",$[1]=Pe,$[2]="G90",this.sender.sendCommands($,SenderClient.GCODE)}})});const r=document.getElementById("toolChange"),l=document.getElementById("toolSelector");r.addEventListener("click",()=>{var g;if(!((g=this.sender)!=null&&g.isConnected())){alert("Please connect to the controller first.");return}if(this.sender.getStatus().version!=this.minimumVersion){alert(`This feature is only available on firmware version ${this.minimumVersion} or later. Please see help tab for more information.`);return}let c=new Array(1);c[0]=l.value,this.sender&&this.sender.sendCommands(c,SenderClient.GCODE)}),this.editTools=document.getElementById("editToolsButton"),this.editToolsModal=document.getElementById("editToolsModal"),this.editToolsClose=document.getElementById("editToolsModalCloseButton"),this.editToolSaveAll=document.getElementById("editToolSaveAll"),this.editTools.addEventListener("click",async()=>{var c;if(!((c=this.sender)!=null&&c.isConnected())){alert("Please connect to the controller first.");return}if(this.editToolsModal.style.display="block",this.sender){const g=document.getElementById("toolOffsetTableBody");g&&(g.innerHTML="");const y=await this.sender.getToolOffsets(SenderClient.GCODE);p(y).forEach(h=>{h.tool!=0&&this.addToolRow(h.tool,h.z,h.x,h.w,h.u)}),console.log("Tool Offsets As Response: "+y)}}),this.editToolSaveAll.addEventListener("click",()=>{var M;if(!((M=this.sender)!=null&&M.isConnected())){alert("Please connect to the controller first.");return}const c=document.getElementById("toolOffsetTableBody");if(!c)return;const g=c.children,y=new Array(g.length);for(let h=0;h<g.length;h++){const Te=g[h],Pe=parseInt(Te.children[0].children[0].value.replace("T","")),Fe=parseFloat(Te.children[1].children[0].value),$=parseFloat(Te.children[2].children[0].value),Ne=parseFloat(Te.children[3].children[0].value),Xe=parseFloat(Te.children[4].children[0].value);y[h]=`G10 P${Pe} Z${Fe} X${Ne} W${$} U${Xe}`}this.sender&&this.sender.sendCommands(y,SenderClient.GCODE)});const p=c=>c.replace("toolOffsets:","").replace("ok","").split("|").map(M=>{const h=M.match(/T(\d+)/),Te=h?parseInt(h[1]):0,Pe=M.match(/Z=(-?\d+\.?\d*)/),Fe=M.match(/X=(-?\d+\.?\d*)/),$=M.match(/W=(-?\d+\.?\d*)/),Ne=M.match(/U=(-?\d+\.?\d*)/);return{tool:Te,z:Pe?parseFloat(Pe[1]):0,x:Fe?parseFloat(Fe[1]):0,w:$?parseFloat($[1]):0,u:Ne?parseFloat(Ne[1]):0}}).filter(M=>!isNaN(M.tool));this.editToolsClose.addEventListener("click",()=>{this.editToolsModal.style.display="none"}),this.connectButton.addEventListener("click",()=>{var c;this.gcodeResponseContainer.style.display="block",!((c=this.sender)!=null&&c.isConnected())&&this.sender&&this.sender.connect()}),this.sendButton.addEventListener("click",()=>{var c;if(!((c=this.sender)!=null&&c.isConnected())){alert("Please connect to the controller first.");return}this.sender&&(this.sendButton.disabled=!0,this.sendSingleCommandButton.disabled=!0,this.jogButtons.forEach(g=>{g.disabled=!0}),this.toolButtons.forEach(g=>{g.disabled=!0}),this.sender.start(gcodeSenderEditor.getValue(),SenderClient.GCODE))}),this.sendSingleCommandButton.addEventListener("click",()=>{var c;if(!((c=this.sender)!=null&&c.isConnected())){alert("Please connect to the controller first.");return}this.sender&&(this.sendButton.disabled=!0,this.sendSingleCommandButton.disabled=!0,this.jogButtons.forEach(g=>{g.disabled=!0}),this.toolButtons.forEach(g=>{g.disabled=!0}),this.sender.sendCommand(this.singleCommandSender.value,SenderClient.GCODE))}),this.stopButton=document.getElementById("stopButton"),this.stopButton.addEventListener("click",()=>this.sender.stop()),this.stopButton.style.display="none"}addToolRow(n,o,i,s,r){const l=document.getElementById("toolOffsetTableBody");if(!l)return;const p=document.createElement("tr"),c=document.createElement("td");c.className="tool-cell";const g=document.createElement("input");g.type="text",g.value=`T${n}`,g.readOnly=!0,g.className="tool-input",c.appendChild(g);const y=document.createElement("td");y.className="data-cell";const M=document.createElement("input");M.type="number",M.value=o.toString(),M.step="0.001",M.className="input-cell",y.appendChild(M);const h=document.createElement("td");h.className="data-cell";const Te=document.createElement("input");Te.type="number",Te.value=s.toString(),Te.step="0.001",Te.className="input-cell",h.appendChild(Te);const Pe=document.createElement("td");Pe.className="data-cell";const Fe=document.createElement("input");Fe.type="number",Fe.value=i.toString(),Fe.step="0.001",Fe.className="input-cell",Pe.appendChild(Fe);const $=document.createElement("td");$.className="data-cell";const Ne=document.createElement("input");Ne.type="number",Ne.value=r.toString(),Ne.step="0.001",Ne.className="input-cell",$.appendChild(Ne);const Xe=document.createElement("td");Xe.className="action-cell";const Ke=document.createElement("button");Ke.className="tool-save-button",Ke.title=`Save Tool T${n} Offsets`,Ke.innerHTML=`
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="24" height="24">
                <path d="M10 5 L40 5 L45 10 L45 40 L40 45 L10 45 L5 40 L5 10 Z" fill="none" stroke="white" stroke-width="2" />
                <rect x="15" y="5" width="20" height="15" fill="none" stroke="white" stroke-width="2" />
                <circle cx="25" cy="30" r="8" fill="none" stroke="white" stroke-width="2" />
            </svg>
        `,Ke.addEventListener("click",()=>{const We=Fe.value,d=M.value,j=Te.value,u=Ne.value,k=`G10 P${n} Z${d} X${We} W${j} U${u}`;this.sender&&this.sender.sendCommand(k,SenderClient.GCODE)}),Xe.appendChild(Ke),p.append(c,y,h,Pe,$,Xe),l.appendChild(p)}handleStatusChange(){if(!this.sender)return;const n=this.sender.getStatus();if(n.isConnected===!1){this.connectButton.innerText="Connect",this.connectButton.disabled=!1,this.connectButton.style.backgroundColor="";return}else this.connectButton.innerText="Connected",this.connectButton.disabled=!0,this.connectButton.style.backgroundColor="green";const o=n.condition==="run";this.runProgress&&(this.runProgress.value=n.progress,this.runProgress.style.display=o?"block":"none",this.runProgressLabel.style.display=o?"block":"none",o?o&&(this.sendButton.style.display="none"):(this.sendButton.disabled=!1,this.sendButton.style.display="inline-block",this.sendSingleCommandButton.disabled=!1,this.jogButtons.forEach(s=>{s.disabled=!1}),this.toolButtons.forEach(s=>{s.disabled=!1}))),this.stopButton&&(this.stopButton.style.display=o?"inline-block":"none");const i=this.sender.getDisconnectingStatus();this.senderError&&!i&&(n.error?(this.senderError.style.display="block",this.senderError.innerText=n.error,this.showError(),this.appendLineToResponseEditor(n.error)):(this.hideError(),this.senderError.innerText=""))}appendLineToResponseEditor(n){var o=gcodeResponseEditor.getSession(),i=o.getLength(),s=new Date().toLocaleTimeString(),r=`[${s}] ${n}
`;o.insert({row:i,column:0},r)}showError(){this.senderError.style.display="block"}hideError(){this.senderError.style.display="none"}}const exampleGcode=`; This example shows a boring operation, then an internal grooving operation

G21 ; metric
G18 ; ZX plane
G90 ; absolute positioning
F200
X0 ; zero your tool X on centerline
Z0 ; zero your tool Z at the right edge of the stock
G91 ; relative positioning

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;1mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;2mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;3mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;4mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;5mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;6mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;7mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;8mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;9mm

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

Z0.25 ; cut
X-5 ; cut

X5 ; retract

;10mm

Z-10

Z3.25 ; cut
X-5 ; cut

X-1.7 ; cut

X6.7 ; retract
Z-3.25 ; retract
`;function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var atoa$1=function(n,o){return Array.prototype.slice.call(n,o)},si=typeof setImmediate=="function",tick;si?tick=function(e){setImmediate(e)}:tick=function(e){setTimeout(e,0)};var tickyBrowser=tick,ticky=tickyBrowser,debounce$1=function(n,o,i){n&&ticky(function(){n.apply(i||null,o||[])})},atoa=atoa$1,debounce=debounce$1,emitter$1=function(n,o){var i=o||{},s={};return n===void 0&&(n={}),n.on=function(r,l){return s[r]?s[r].push(l):s[r]=[l],n},n.once=function(r,l){return l._once=!0,n.on(r,l),n},n.off=function(r,l){var p=arguments.length;if(p===1)delete s[r];else if(p===0)s={};else{var c=s[r];if(!c)return n;c.splice(c.indexOf(l),1)}return n},n.emit=function(){var r=atoa(arguments);return n.emitterSnapshot(r.shift()).apply(this,r)},n.emitterSnapshot=function(r){var l=(s[r]||[]).slice(0);return function(){var p=atoa(arguments),c=this||n;if(r==="error"&&i.throws!==!1&&!l.length)throw p.length===1?p[0]:p;return l.forEach(function(y){i.async?debounce(y,p,c):y.apply(c,p),y._once&&n.off(r,y)}),n}},n},NativeCustomEvent=window.CustomEvent;function useNative(){try{var e=new NativeCustomEvent("cat",{detail:{foo:"bar"}});return e.type==="cat"&&e.detail.foo==="bar"}catch{}return!1}var customEvent$1=useNative()?NativeCustomEvent:typeof document<"u"&&typeof document.createEvent=="function"?function(n,o){var i=document.createEvent("CustomEvent");return o?i.initCustomEvent(n,o.bubbles,o.cancelable,o.detail):i.initCustomEvent(n,!1,!1,void 0),i}:function(n,o){var i=document.createEventObject();return i.type=n,o?(i.bubbles=!!o.bubbles,i.cancelable=!!o.cancelable,i.detail=o.detail):(i.bubbles=!1,i.cancelable=!1,i.detail=void 0),i},eventmap$1=[],eventname="",ron=/^on/;for(eventname in window)ron.test(eventname)&&eventmap$1.push(eventname.slice(2));var eventmap_1=eventmap$1,customEvent=customEvent$1,eventmap=eventmap_1,doc$1=window.document,addEvent=addEventEasy,removeEvent=removeEventEasy,hardCache=[];window.addEventListener||(addEvent=addEventHard,removeEvent=removeEventHard);var crossvent$1={add:addEvent,remove:removeEvent,fabricate:fabricateEvent};function addEventEasy(e,n,o,i){return e.addEventListener(n,o,i)}function addEventHard(e,n,o){return e.attachEvent("on"+n,wrap(e,n,o))}function removeEventEasy(e,n,o,i){return e.removeEventListener(n,o,i)}function removeEventHard(e,n,o){var i=unwrap(e,n,o);if(i)return e.detachEvent("on"+n,i)}function fabricateEvent(e,n,o){var i=eventmap.indexOf(n)===-1?r():s();e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on"+n,i);function s(){var l;return doc$1.createEvent?(l=doc$1.createEvent("Event"),l.initEvent(n,!0,!0)):doc$1.createEventObject&&(l=doc$1.createEventObject()),l}function r(){return new customEvent(n,{detail:o})}}function wrapperFactory(e,n,o){return function(s){var r=s||window.event;r.target=r.target||r.srcElement,r.preventDefault=r.preventDefault||function(){r.returnValue=!1},r.stopPropagation=r.stopPropagation||function(){r.cancelBubble=!0},r.which=r.which||r.keyCode,o.call(e,r)}}function wrap(e,n,o){var i=unwrap(e,n,o)||wrapperFactory(e,n,o);return hardCache.push({wrapper:i,element:e,type:n,fn:o}),i}function unwrap(e,n,o){var i=find(e,n,o);if(i){var s=hardCache[i].wrapper;return hardCache.splice(i,1),s}}function find(e,n,o){var i,s;for(i=0;i<hardCache.length;i++)if(s=hardCache[i],s.element===e&&s.type===n&&s.fn===o)return i}var cache={},start="(?:^|\\s)",end="(?:\\s|$)";function lookupClass(e){var n=cache[e];return n?n.lastIndex=0:cache[e]=n=new RegExp(start+e+end,"g"),n}function addClass(e,n){var o=e.className;o.length?lookupClass(n).test(o)||(e.className+=" "+n):e.className=n}function rmClass(e,n){e.className=e.className.replace(lookupClass(n)," ").trim()}var classes$1={add:addClass,rm:rmClass},emitter=emitter$1,crossvent=crossvent$1,classes=classes$1,doc=document,documentElement=doc.documentElement;function dragula(e,n){var o=arguments.length;o===1&&Array.isArray(e)===!1&&(n=e,e=[]);var i,s,r,l,p,c,g,y,M,h,Te,Pe=null,Fe,$=n||{};$.moves===void 0&&($.moves=always),$.accepts===void 0&&($.accepts=always),$.invalid===void 0&&($.invalid=Me),$.containers===void 0&&($.containers=e||[]),$.isContainer===void 0&&($.isContainer=never),$.copy===void 0&&($.copy=!1),$.copySortSource===void 0&&($.copySortSource=!1),$.revertOnSpill===void 0&&($.revertOnSpill=!1),$.removeOnSpill===void 0&&($.removeOnSpill=!1),$.direction===void 0&&($.direction="vertical"),$.ignoreInputTextSelection===void 0&&($.ignoreInputTextSelection=!0),$.mirrorContainer===void 0&&($.mirrorContainer=doc.body);var Ne=emitter({containers:$.containers,start:Se,end:Ge,cancel:st,remove:rt,destroy:j,canMove:J,dragging:!1});return $.removeOnSpill===!0&&Ne.on("over",ut).on("out",mt),Ke(),Ne;function Xe(G){return Ne.containers.indexOf(G)!==-1||$.isContainer(G)}function Ke(G){var Le=G?"remove":"add";touchy(documentElement,Le,"mousedown",k),touchy(documentElement,Le,"mouseup",Je)}function We(G){var Le=G?"remove":"add";touchy(documentElement,Le,"mousemove",f)}function d(G){var Le=G?"remove":"add";crossvent[Le](documentElement,"selectstart",u),crossvent[Le](documentElement,"click",u)}function j(){Ke(!0),Je({})}function u(G){Fe&&G.preventDefault()}function k(G){c=G.clientX,g=G.clientY;var Le=whichMouseButton(G)!==1||G.metaKey||G.ctrlKey;if(!Le){var Re=G.target,Ze=_(Re);Ze&&(Fe=Ze,We(),G.type==="mousedown"&&(isInput(Re)?Re.focus():G.preventDefault()))}}function f(G){if(Fe){if(whichMouseButton(G)===0){Je({});return}if(!(G.clientX!==void 0&&Math.abs(G.clientX-c)<=($.slideFactorX||0)&&G.clientY!==void 0&&Math.abs(G.clientY-g)<=($.slideFactorY||0))){if($.ignoreInputTextSelection){var Le=getCoord("clientX",G)||0,Re=getCoord("clientY",G)||0,Ze=doc.elementFromPoint(Le,Re);if(isInput(Ze))return}var ot=Fe;We(!0),d(),Ge(),Oe(ot);var Ve=getOffset(r);l=getCoord("pageX",G)-Ve.left,p=getCoord("pageY",G)-Ve.top,classes.add(h||r,"gu-transit"),ht(),it(G)}}}function _(G){if(!(Ne.dragging&&i)&&!Xe(G)){for(var Le=G;getParent(G)&&Xe(getParent(G))===!1;)if($.invalid(G,Le)||(G=getParent(G),!G))return;var Re=getParent(G);if(Re&&!$.invalid(G,Le)){var Ze=$.moves(G,Re,Le,nextEl(G));if(Ze)return{item:G,source:Re}}}}function J(G){return!!_(G)}function Se(G){var Le=_(G);Le&&Oe(Le)}function Oe(G){vt(G.item,G.source)&&(h=G.item.cloneNode(!0),Ne.emit("cloned",h,G.item,"copy")),s=G.source,r=G.item,y=M=nextEl(G.item),Ne.dragging=!0,Ne.emit("drag",r,s)}function Me(){return!1}function Ge(){if(Ne.dragging){var G=h||r;Qe(G,getParent(G))}}function He(){Fe=!1,We(!0),d(!0)}function Je(G){if(He(),!!Ne.dragging){var Le=h||r,Re=getCoord("clientX",G)||0,Ze=getCoord("clientY",G)||0,ot=getElementBehindPoint(i,Re,Ze),Ve=lt(ot,Re,Ze);Ve&&(h&&$.copySortSource||!h||Ve!==s)?Qe(Le,Ve):$.removeOnSpill?rt():st()}}function Qe(G,Le){var Re=getParent(G);h&&$.copySortSource&&Le===s&&Re.removeChild(r),nt(Le)?Ne.emit("cancel",G,s,s):Ne.emit("drop",G,Le,s,M),et()}function rt(){if(Ne.dragging){var G=h||r,Le=getParent(G);Le&&Le.removeChild(G),Ne.emit(h?"cancel":"remove",G,Le,s),et()}}function st(G){if(Ne.dragging){var Le=arguments.length>0?G:$.revertOnSpill,Re=h||r,Ze=getParent(Re),ot=nt(Ze);ot===!1&&Le&&(h?Ze&&Ze.removeChild(h):s.insertBefore(Re,y)),ot||Le?Ne.emit("cancel",Re,s,s):Ne.emit("drop",Re,Ze,s,M),et()}}function et(){var G=h||r;He(),pt(),G&&classes.rm(G,"gu-transit"),Te&&clearTimeout(Te),Ne.dragging=!1,Pe&&Ne.emit("out",G,Pe,s),Ne.emit("dragend",G),s=r=h=y=M=Te=Pe=null}function nt(G,Le){var Re;return Le!==void 0?Re=Le:i?Re=M:Re=nextEl(h||r),G===s&&Re===y}function lt(G,Le,Re){for(var Ze=G;Ze&&!ot();)Ze=getParent(Ze);return Ze;function ot(){var Ve=Xe(Ze);if(Ve===!1)return!1;var ct=gt(Ze,G),tt=ft(Ze,ct,Le,Re),Ie=nt(Ze,tt);return Ie?!0:$.accepts(r,Ze,s,tt)}}function it(G){if(!i)return;G.preventDefault();var Le=getCoord("clientX",G)||0,Re=getCoord("clientY",G)||0,Ze=Le-l,ot=Re-p;i.style.left=Ze+"px",i.style.top=ot+"px";var Ve=h||r,ct=getElementBehindPoint(i,Le,Re),tt=lt(ct,Le,Re),Ie=tt!==null&&tt!==Pe;(Ie||tt===null)&&(Tt(),Pe=tt,kt());var _e=getParent(Ve);if(tt===s&&h&&!$.copySortSource){_e&&_e.removeChild(Ve);return}var $e,Ue=gt(tt,ct);if(Ue!==null)$e=ft(tt,Ue,Le,Re);else if($.revertOnSpill===!0&&!h)$e=y,tt=s;else{h&&_e&&_e.removeChild(Ve);return}($e===null&&Ie||$e!==Ve&&$e!==nextEl(Ve))&&(M=$e,tt.insertBefore(Ve,$e),Ne.emit("shadow",Ve,tt,s));function at(yt){Ne.emit(yt,Ve,Pe,s)}function kt(){Ie&&at("over")}function Tt(){Pe&&at("out")}}function ut(G){classes.rm(G,"gu-hide")}function mt(G){Ne.dragging&&classes.add(G,"gu-hide")}function ht(){if(!i){var G=r.getBoundingClientRect();i=r.cloneNode(!0),i.style.width=getRectWidth(G)+"px",i.style.height=getRectHeight(G)+"px",classes.rm(i,"gu-transit"),classes.add(i,"gu-mirror"),$.mirrorContainer.appendChild(i),touchy(documentElement,"add","mousemove",it),classes.add($.mirrorContainer,"gu-unselectable"),Ne.emit("cloned",i,r,"mirror")}}function pt(){i&&(classes.rm($.mirrorContainer,"gu-unselectable"),touchy(documentElement,"remove","mousemove",it),getParent(i).removeChild(i),i=null)}function gt(G,Le){for(var Re=Le;Re!==G&&getParent(Re)!==G;)Re=getParent(Re);return Re===documentElement?null:Re}function ft(G,Le,Re,Ze){var ot=$.direction==="horizontal",Ve=Le!==G?tt():ct();return Ve;function ct(){var _e=G.children.length,$e,Ue,at;for($e=0;$e<_e;$e++)if(Ue=G.children[$e],at=Ue.getBoundingClientRect(),ot&&at.left+at.width/2>Re||!ot&&at.top+at.height/2>Ze)return Ue;return null}function tt(){var _e=Le.getBoundingClientRect();return Ie(ot?Re>_e.left+getRectWidth(_e)/2:Ze>_e.top+getRectHeight(_e)/2)}function Ie(_e){return _e?nextEl(Le):Le}}function vt(G,Le){return typeof $.copy=="boolean"?$.copy:$.copy(G,Le)}}function touchy(e,n,o,i){var s={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},r={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},l={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};window.navigator.pointerEnabled?crossvent[n](e,r[o],i):window.navigator.msPointerEnabled?crossvent[n](e,l[o],i):(crossvent[n](e,s[o],i),crossvent[n](e,o,i))}function whichMouseButton(e){if(e.touches!==void 0)return e.touches.length;if(e.which!==void 0&&e.which!==0)return e.which;if(e.buttons!==void 0)return e.buttons;var n=e.button;if(n!==void 0)return n&1?1:n&2?3:n&4?2:0}function getOffset(e){var n=e.getBoundingClientRect();return{left:n.left+getScroll("scrollLeft","pageXOffset"),top:n.top+getScroll("scrollTop","pageYOffset")}}function getScroll(e,n){return typeof window[n]<"u"?window[n]:documentElement.clientHeight?documentElement[e]:doc.body[e]}function getElementBehindPoint(e,n,o){e=e||{};var i=e.className||"",s;return e.className+=" gu-hide",s=doc.elementFromPoint(n,o),e.className=i,s}function never(){return!1}function always(){return!0}function getRectWidth(e){return e.width||e.right-e.left}function getRectHeight(e){return e.height||e.bottom-e.top}function getParent(e){return e.parentNode===doc?null:e.parentNode}function isInput(e){return e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.tagName==="SELECT"||isEditable(e)}function isEditable(e){return!e||e.contentEditable==="false"?!1:e.contentEditable==="true"?!0:isEditable(getParent(e))}function nextEl(e){return e.nextElementSibling||n();function n(){var o=e;do o=o.nextSibling;while(o&&o.nodeType!==1);return o}}function getEventHost(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function getCoord(e,n){var o=getEventHost(n),i={pageX:"clientX",pageY:"clientY"};return e in i&&!(e in o)&&i[e]in o&&(e=i[e]),o[e]}var dragula_1=dragula;const dragula$1=getDefaultExportFromCjs(dragula_1);class KeyEmulation{static getButtonName(n){const o=this.buttons.find(i=>i.id===n);return o?o.name:""}static createKeyPressEvent(n,o){const i=this.buttons.find(r=>r.id===n);if(!i)throw new Error(`No button found with id: ${n}`);let s=i.number;return s&=127,o&&(s|=128),s}}De(KeyEmulation,"buttons",[{name:"arrow_left_alt",id:"B_LEFT",number:57},{name:"arrow_right_alt",id:"B_RIGHT",number:37},{name:"arrow_upward_alt",id:"B_UP",number:47},{name:"arrow_downward_alt",id:"B_DOWN",number:67},{name:"+",id:"B_MINUS",number:5},{name:"-",id:"B_PLUS",number:64},{name:"play_arrow",id:"B_ON",number:17},{name:"crop_square",id:"B_OFF",number:27},{name:"keyboard_tab_rtl",id:"B_STOPL",number:7},{name:"keyboard_tab",id:"B_STOPR",number:15},{name:"vertical_align_top",id:"B_STOPU",number:6},{name:"vertical_align_bottom",id:"B_STOPD",number:16},{name:"rotate_left",id:"B_DISPL",number:14},{name:"signal_cellular_alt",id:"B_STEP",number:24},{name:"settings",id:"B_SETTINGS",number:34},{name:"space_bar",id:"B_MEASURE",number:54},{name:"sync_alt",id:"B_REVERSE",number:44},{name:"1",id:"B_0",number:51},{name:"2",id:"B_1",number:41},{name:"3",id:"B_2",number:61},{name:"4",id:"B_3",number:31},{name:"5",id:"B_4",number:2},{name:"6",id:"B_5",number:21},{name:"7",id:"B_6",number:12},{name:"8",id:"B_7",number:11},{name:"9",id:"B_8",number:22},{name:"10",id:"B_9",number:1},{name:"backspace",id:"B_BACKSPACE",number:32},{name:"manufacturing",id:"B_MODE_GEARS",number:42},{name:"reply",id:"B_MODE_TURN",number:52},{name:"turn_slight_left",id:"B_MODE_FACE",number:62},{name:"arrow_forward_ios",id:"B_MODE_CONE",number:3},{name:"publish",id:"B_MODE_CUT",number:13},{name:"home_improvement_and_tools",id:"B_MODE_THREAD",number:23},{name:"M",id:"B_MODE_OTHER",number:33},{name:"X",id:"B_X",number:53},{name:"Z",id:"B_Z",number:43},{name:"A",id:"B_A",number:4},{name:"B",id:"B_B",number:63}]);let nanoid=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((n,o)=>(o&=63,o<36?n+=o.toString(36):o<62?n+=(o-26).toString(36).toUpperCase():o>62?n+="-":n+="_",n),"");var gapi=window.gapi=window.gapi||{};gapi._bs=new Date().getTime();(function(){var aa=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,n,o){return e==Array.prototype||e==Object.prototype||(e[n]=o.value),e},da=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof window=="object"&&window];for(var n=0;n<e.length;++n){var o=e[n];if(o&&o.Math==Math)return o}throw Error("Cannot find global object")},ea=da(this),fa=function(e,n){if(n)e:{var o=ea;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in o))break e;o=o[s]}e=e[e.length-1],i=o[e],n=n(i),n!=i&&n!=null&&aa(o,e,{configurable:!0,writable:!0,value:n})}},ha=function(e){var n=0;return function(){return n<e.length?{done:!1,value:e[n++]}:{done:!0}}};fa("Symbol",function(e){if(e)return e;var n=function(s,r){this.ba=s,aa(this,"description",{configurable:!0,writable:!0,value:r})};n.prototype.toString=function(){return this.ba};var o=0,i=function(s){if(this instanceof i)throw new TypeError("Symbol is not a constructor");return new n("jscomp_symbol_"+(s||"")+"_"+o++,s)};return i}),fa("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var n="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),o=0;o<n.length;o++){var i=ea[n[o]];typeof i=="function"&&typeof i.prototype[e]!="function"&&aa(i.prototype,e,{configurable:!0,writable:!0,value:function(){return ia(ha(this))}})}return e});var ia=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},ja=function(e,n){e instanceof String&&(e+="");var o=0,i=!1,s={next:function(){if(!i&&o<e.length){var r=o++;return{value:n(r,e[r]),done:!1}}return i=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s};fa("Array.prototype.keys",function(e){return e||function(){return ja(this,function(n){return n})}});var m=this||self,ka=function(e){var n=typeof e;return n!="object"?n:e?Array.isArray(e)?"array":n:"null"},la=function(e,n,o){return e.call.apply(e.bind,arguments)},ma=function(e,n,o){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,i),e.apply(n,s)}}return function(){return e.apply(n,arguments)}},na=function(e,n,o){return na=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?la:ma,na.apply(null,arguments)},oa=function(e,n){function o(){}o.prototype=n.prototype,e.ma=n.prototype,e.prototype=new o,e.prototype.constructor=e,e.A=function(i,s,r){for(var l=Array(arguments.length-2),p=2;p<arguments.length;p++)l[p-2]=arguments[p];return n.prototype[s].apply(i,l)}},pa=function(e){return e},qa=function(e){var n=null,o=m.trustedTypes;if(!o||!o.createPolicy)return n;try{n=o.createPolicy(e,{createHTML:pa,createScript:pa,createScriptURL:pa})}catch(i){m.console&&m.console.error(i.message)}return n};function q(e){if(Error.captureStackTrace)Error.captureStackTrace(this,q);else{var n=Error().stack;n&&(this.stack=n)}e&&(this.message=String(e))}oa(q,Error),q.prototype.name="CustomError";var ra=function(e,n){e=e.split("%s");for(var o="",i=e.length-1,s=0;s<i;s++)o+=e[s]+(s<n.length?n[s]:"%s");q.call(this,o+e[i])};oa(ra,q),ra.prototype.name="AssertionError";var sa=function(e,n,o,i){var s="Assertion failed";if(o){s+=": "+o;var r=i}else e&&(s+=": "+e,r=n);throw new ra(""+s,r||[])},ta=function(e,n,o){return e||sa("",null,n,Array.prototype.slice.call(arguments,2)),e},ua=function(e,n){throw new ra("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))},va=function(e,n,o){typeof e!="string"&&sa("Expected string but got %s: %s.",[ka(e),e],n,Array.prototype.slice.call(arguments,2))},xa=function(e,n){e:{try{var o=e&&e.ownerDocument,i=o&&(o.defaultView||o.parentWindow);if(i=i||m,i.Element&&i.Location){var s=i;break e}}catch{}s=null}if(s&&typeof s[n]<"u"&&(!e||!(e instanceof s[n])&&(e instanceof s.Location||e instanceof s.Element))){if(s=typeof e,s=="object"&&e!=null||s=="function")try{var r=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch{r="<object could not be stringified>"}else r=e===void 0?"undefined":e===null?"null":typeof e;ua("Argument is not a %s (or a non-Element, non-Location mock); got: %s",n,r)}return e},ya,t=function(e,n){this.P=e===za&&n||"",this.ca=Aa};t.prototype.J=!0,t.prototype.H=function(){return this.P},t.prototype.toString=function(){return"Const{"+this.P+"}"};var Ba=function(e){return e instanceof t&&e.constructor===t&&e.ca===Aa?e.P:(ua("expected object of type Const, got '"+e+"'"),"type_error:Const")},Aa={},za={},v=function(e,n){this.N=n===Ca?e:""};v.prototype.J=!0,v.prototype.H=function(){return this.N.toString()},v.prototype.toString=function(){return"SafeUrl{"+this.N+"}"};var Da=function(e){return e instanceof v&&e.constructor===v?e.N:(ua("expected object of type SafeUrl, got '"+e+"' of type "+ka(e)),"type_error:SafeUrl")},Ea=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i,Fa=function(e){return e instanceof v?e:(e=typeof e=="object"&&e.J?e.H():String(e),ta(Ea.test(e),"%s does not match the safe URL pattern",e)||(e="about:invalid#zClosurez"),new v(e,Ca))},Ca={},w=function(e,n,o){this.M=o===Ga?e:""};w.prototype.J=!0,w.prototype.H=function(){return this.M.toString()},w.prototype.toString=function(){return"SafeHtml{"+this.M+"}"};var Ha=function(e){return e instanceof w&&e.constructor===w?e.M:(ua("expected object of type SafeHtml, got '"+e+"' of type "+ka(e)),"type_error:SafeHtml")},Ga={},Ia=new w(m.trustedTypes&&m.trustedTypes.emptyHTML||"",0,Ga),Ja={MATH:!0,SCRIPT:!0,STYLE:!0,SVG:!0,TEMPLATE:!0},Ka=function(e){var n=!1,o;return function(){return n||(o=e(),n=!0),o}}(function(){if(typeof document>"u")return!1;var e=document.createElement("div"),n=document.createElement("div");return n.appendChild(document.createElement("div")),e.appendChild(n),e.firstChild?(n=e.firstChild.firstChild,e.innerHTML=Ha(Ia),!n.parentElement):!1}),x=window,z=document,La=x.location,Ma=function(){},Na=/\[native code\]/,A=function(e,n,o){return e[n]=e[n]||o},Oa=function(e){for(var n=0;n<this.length;n++)if(this[n]===e)return n;return-1},Pa=function(e){e=e.sort();for(var n=[],o=void 0,i=0;i<e.length;i++){var s=e[i];s!=o&&n.push(s),o=s}return n},Qa=/&/g,Ra=/</g,Sa=/>/g,Ua=/"/g,Va=/'/g,Wa=function(e){return String(e).replace(Qa,"&amp;").replace(Ra,"&lt;").replace(Sa,"&gt;").replace(Ua,"&quot;").replace(Va,"&#39;")},B=function(){var e;if((e=Object.create)&&Na.test(e))e=e(null);else{e={};for(var n in e)e[n]=void 0}return e},C=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},Xa=function(e){if(Na.test(Object.keys))return Object.keys(e);var n=[],o;for(o in e)C(e,o)&&n.push(o);return n},D=function(e,n){e=e||{};for(var o in e)C(e,o)&&(n[o]=e[o])},Ya=function(e){return function(){x.setTimeout(e,0)}},E=function(e,n){if(!e)throw Error(n||"")},F=A(x,"gapi",{}),H=function(e,n,o){var i=new RegExp("([#].*&|[#])"+n+"=([^&#]*)","g");if(n=new RegExp("([?#].*&|[?#])"+n+"=([^&#]*)","g"),e=e&&(i.exec(e)||n.exec(e)))try{o=decodeURIComponent(e[2])}catch{}return o},Za=new RegExp(/^/.source+/([a-zA-Z][-+.a-zA-Z0-9]*:)?/.source+/(\/\/[^\/?#]*)?/.source+/([^?#]*)?/.source+/(\?([^#]*))?/.source+/(#((#|[^#])*))?/.source+/$/.source),$a=/[\ud800-\udbff][\udc00-\udfff]|[^!-~]/g,ab=new RegExp(/(%([^0-9a-fA-F%]|[0-9a-fA-F]([^0-9a-fA-F%])?)?)*/.source+/%($|[^0-9a-fA-F]|[0-9a-fA-F]($|[^0-9a-fA-F]))/.source,"g"),bb=/%([a-f]|[0-9a-fA-F][a-f])/g,cb=/^(https?|ftp|file|chrome-extension):$/i,I=function(e){e=String(e),e=e.replace($a,function(s){try{return encodeURIComponent(s)}catch{return encodeURIComponent(s.replace(/^[^%]+$/g,"�"))}}).replace(ab,function(s){return s.replace(/%/g,"%25")}).replace(bb,function(s){return s.toUpperCase()}),e=e.match(Za)||[];var n=B(),o=function(s){return s.replace(/\\/g,"%5C").replace(/\^/g,"%5E").replace(/`/g,"%60").replace(/\{/g,"%7B").replace(/\|/g,"%7C").replace(/\}/g,"%7D")},i=!!(e[1]||"").match(cb);return n.A=o((e[1]||"")+(e[2]||"")+(e[3]||(e[2]&&i?"/":""))),i=function(s){return o(s.replace(/\?/g,"%3F").replace(/#/g,"%23"))},n.query=e[5]?[i(e[5])]:[],n.g=e[7]?[i(e[7])]:[],n},db=function(e){return e.A+(0<e.query.length?"?"+e.query.join("&"):"")+(0<e.g.length?"#"+e.g.join("&"):"")},eb=function(e,n){var o=[];if(e){for(var i in e)if(C(e,i)&&e[i]!=null){var s=n?n(e[i]):e[i];o.push(encodeURIComponent(i)+"="+encodeURIComponent(s))}}return o},fb=function(e,n,o,i){return e=I(e),e.query.push.apply(e.query,eb(n,i)),e.g.push.apply(e.g,eb(o,i)),db(e)},gb=new RegExp(/\/?\??#?/.source+"("+/[\/?#]/i.source+"|"+/[\uD800-\uDBFF]/i.source+"|"+/%[c-f][0-9a-f](%[89ab][0-9a-f]){0,2}(%[89ab]?)?/i.source+"|"+/%[0-9a-f]?/i.source+")$","i"),hb=function(e,n){var o=I(n);n=o.A,o.query.length&&(n+="?"+o.query.join("")),o.g.length&&(n+="#"+o.g.join(""));var i="";2e3<n.length&&(i=n,n=n.substr(0,2e3),n=n.replace(gb,""),i=i.substr(n.length));var s=e.createElement("div");if(e=e.createElement("a"),o=I(n),n=o.A,o.query.length&&(n+="?"+o.query.join("")),o.g.length&&(n+="#"+o.g.join("")),n=new v(n,Ca),xa(e,"HTMLAnchorElement"),n=n instanceof v?n:Fa(n),e.href=Da(n),s.appendChild(e),n=s.innerHTML,o=new t(za,"Assignment to self."),va(Ba(o),"must provide justification"),ta(!/^[\s\xa0]*$/.test(Ba(o)),"must provide non-empty justification"),ya===void 0&&(ya=qa("gapi#html")),n=(o=ya)?o.createHTML(n):n,n=new w(n,null,Ga),s.tagName&&Ja[s.tagName.toUpperCase()])throw Error("goog.dom.safe.setInnerHtml cannot be used to set content of "+s.tagName+".");if(Ka())for(;s.lastChild;)s.removeChild(s.lastChild);return s.innerHTML=Ha(n),n=String(s.firstChild.href),s.parentNode&&s.parentNode.removeChild(s),o=I(n+i),i=o.A,o.query.length&&(i+="?"+o.query.join("")),o.g.length&&(i+="#"+o.g.join("")),i},ib=/^https?:\/\/[^\/%\\?#\s]+\/[^\s]*$/i,jb=function(e,n,o,i){x[o+"EventListener"]?x[o+"EventListener"](e,n,!1):x[i+"tachEvent"]&&x[i+"tachEvent"]("on"+e,n)},kb=function(){var e=z.readyState;return e==="complete"||e==="interactive"&&navigator.userAgent.indexOf("MSIE")==-1},nb=function(e){var n=lb;if(!kb())try{n()}catch{}mb(e)},mb=function(e){if(kb())e();else{var n=!1,o=function(){if(!n)return n=!0,e.apply(this,arguments)};x.addEventListener?(x.addEventListener("load",o,!1),x.addEventListener("DOMContentLoaded",o,!1)):x.attachEvent&&(x.attachEvent("onreadystatechange",function(){kb()&&o.apply(this,arguments)}),x.attachEvent("onload",o))}},ob=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},pb={button:!0,div:!0,span:!0},K;K=A(x,"___jsl",B()),A(K,"I",0),A(K,"hel",10);var qb=function(e){return K.dpo?K.h:H(e,"jsh",K.h)},rb=function(e){var n=A(K,"sws",[]);n.push.apply(n,e)},sb=function(e){return A(K,"watt",B())[e]},tb=function(e){var n=A(K,"PQ",[]);K.PQ=[];var o=n.length;if(o===0)e();else for(var i=0,s=function(){++i===o&&e()},r=0;r<o;r++)n[r](s)},ub=function(e){return A(A(K,"H",B()),e,B())},vb=A(K,"perf",B()),wb=A(vb,"g",B()),xb=A(vb,"i",B());A(vb,"r",[]),B(),B();var yb=function(e,n,o){var i=vb.r;typeof i=="function"?i(e,n,o):i.push([e,n,o])},L=function(e,n,o){wb[e]=!n&&wb[e]||o||new Date().getTime(),yb(e)},Ab=function(e,n,o){n&&0<n.length&&(n=zb(n),o&&0<o.length&&(n+="___"+zb(o)),28<n.length&&(n=n.substr(0,28)+(n.length-28)),o=n,n=A(xb,"_p",B()),A(n,o,B())[e]=new Date().getTime(),yb(e,"_p",o))},zb=function(e){return e.join("__").replace(/\./g,"_").replace(/\-/g,"_").replace(/,/g,"_")},Bb=B(),N=[],O=function(e){throw Error("Bad hint"+(e?": "+e:""))};N.push(["jsl",function(e){for(var n in e)if(C(e,n)){var o=e[n];typeof o=="object"?K[n]=A(K,n,[]).concat(o):A(K,n,o)}(n=e.u)&&(e=A(K,"us",[]),e.push(n),(n=/^https:(.*)$/.exec(n))&&e.push("http:"+n[1]))}]);var Cb=/^(\/[a-zA-Z0-9_\-]+)+$/,Db=[/\/amp\//,/\/amp$/,/^\/amp$/],Eb=/^[a-zA-Z0-9\-_\.,!]+$/,Fb=/^gapi\.loaded_[0-9]+$/,Gb=/^[a-zA-Z0-9,._-]+$/,Kb=function(e,n,o,i){var s=e.split(";"),r=s.shift(),l=Bb[r],p=null;return l?p=l(s,n,o,i):O("no hint processor for: "+r),p||O("failed to generate load url"),n=p,o=n.match(Hb),(i=n.match(Ib))&&i.length===1&&Jb.test(n)&&o&&o.length===1||O("failed sanity: "+e),p},Nb=function(e,n,o,i){e=Lb(e),Fb.test(o)||O("invalid_callback"),n=Mb(n),i=i&&i.length?Mb(i):null;var s=function(r){return encodeURIComponent(r).replace(/%2C/g,",")};return[encodeURIComponent(e.pathPrefix).replace(/%2C/g,",").replace(/%2F/g,"/"),"/k=",s(e.version),"/m=",s(n),i?"/exm="+s(i):"","/rt=j/sv=1/d=1/ed=1",e.S?"/am="+s(e.S):"",e.Z?"/rs="+s(e.Z):"",e.aa?"/t="+s(e.aa):"","/cb=",s(o)].join("")},Lb=function(e){e.charAt(0)!=="/"&&O("relative path");for(var n=e.substring(1).split("/"),o=[];n.length;){if(e=n.shift(),!e.length||e.indexOf(".")==0)O("empty/relative directory");else if(0<e.indexOf("=")){n.unshift(e);break}o.push(e)}e={};for(var i=0,s=n.length;i<s;++i){var r=n[i].split("="),l=decodeURIComponent(r[0]),p=decodeURIComponent(r[1]);r.length==2&&l&&p&&(e[l]=e[l]||p)}for(n="/"+o.join("/"),Cb.test(n)||O("invalid_prefix"),o=0,i=Db.length;o<i;++o)Db[o].test(n)&&O("invalid_prefix");return o=Ob(e,"k",!0),i=Ob(e,"am"),s=Ob(e,"rs"),e=Ob(e,"t"),{pathPrefix:n,version:o,S:i,Z:s,aa:e}},Mb=function(e){for(var n=[],o=0,i=e.length;o<i;++o){var s=e[o].replace(/\./g,"_").replace(/-/g,"_");Gb.test(s)&&n.push(s)}return n.join(",")},Ob=function(e,n,o){if(e=e[n],!e&&o&&O("missing: "+n),e){if(Eb.test(e))return e;O("invalid: "+n)}return null},Jb=/^https?:\/\/[a-z0-9_.-]+\.google(rs)?\.com(:\d+)?\/[a-zA-Z0-9_.,!=\-\/]+$/,Ib=/\/cb=/g,Hb=/\/\//g,Pb=function(){var e=qb(La.href);if(!e)throw Error("Bad hint");return e};Bb.m=function(e,n,o,i){return(e=e[0])||O("missing_hint"),"https://apis.google.com"+Nb(e,n,o,i)};var Qb=decodeURI("%73cript"),Rb=/^[-+_0-9\/A-Za-z]+={0,2}$/,Sb=function(e,n){for(var o=[],i=0;i<e.length;++i){var s=e[i];s&&0>Oa.call(n,s)&&o.push(s)}return o},Tb=function(){var e=K.nonce;return e!==void 0?e&&e===String(e)&&e.match(Rb)?e:K.nonce=null:z.querySelector&&(e=z.querySelector("script[nonce]"))?(e=e.nonce||e.getAttribute("nonce")||"",e&&e===String(e)&&e.match(Rb)?K.nonce=e:K.nonce=null):null},Wb=function(e){if(z.readyState!="loading")Ub(e);else{var n=Tb(),o="";n!==null&&(o=' nonce="'+n+'"'),e="<"+Qb+' src="'+encodeURI(e)+'"'+o+"></"+Qb+">",z.write(Vb?Vb.createHTML(e):e)}},Ub=function(e){var n=z.createElement(Qb);n.setAttribute("src",Vb?Vb.createScriptURL(e):e),e=Tb(),e!==null&&n.setAttribute("nonce",e),n.async="true",(e=z.getElementsByTagName(Qb)[0])?e.parentNode.insertBefore(n,e):(z.head||z.body||z.documentElement).appendChild(n)},Xb=function(e,n){var o=n&&n._c;if(o)for(var i=0;i<N.length;i++){var s=N[i][0],r=N[i][1];r&&C(o,s)&&r(o[s],e,n)}},Zb=function(e,n,o){Yb(function(){var i=n===qb(La.href)?A(F,"_",B()):B();i=A(ub(n),"_",i),e(i)},o)},ac=function(e,n){var o=n||{};typeof n=="function"&&(o={},o.callback=n),Xb(e,o),n=e?e.split(":"):[];var i=o.h||Pb(),s=A(K,"ah",B());if(s["::"]&&n.length){e=[];for(var r=null;r=n.shift();){var l=r.split(".");l=s[r]||s[l[1]&&"ns:"+l[0]||""]||i;var p=e.length&&e[e.length-1]||null,c=p;p&&p.hint==l||(c={hint:l,V:[]},e.push(c)),c.V.push(r)}var g=e.length;if(1<g){var y=o.callback;y&&(o.callback=function(){--g==0&&y()})}for(;n=e.shift();)$b(n.V,o,n.hint)}else $b(n||[],o,i)},$b=function(e,n,o){e=Pa(e)||[];var i=n.callback,s=n.config,r=n.timeout,l=n.ontimeout,p=n.onerror,c=void 0;typeof p=="function"&&(c=p);var g=null,y=!1;if(r&&!l||!r&&l)throw"Timeout requires both the timeout parameter and ontimeout parameter to be set";p=A(ub(o),"r",[]).sort();var M=A(ub(o),"L",[]).sort(),h=[].concat(p),Te=function(Xe,Ke){if(y)return 0;x.clearTimeout(g),M.push.apply(M,Pe);var We=((F||{}).config||{}).update;if(We?We(s):s&&A(K,"cu",[]).push(s),Ke){Ab("me0",Xe,h);try{Zb(Ke,o,c)}finally{Ab("me1",Xe,h)}}return 1};0<r&&(g=x.setTimeout(function(){y=!0,l()},r));var Pe=Sb(e,M);if(Pe.length){Pe=Sb(e,p);var Fe=A(K,"CP",[]),$=Fe.length;if(Fe[$]=function(Xe){if(!Xe)return 0;Ab("ml1",Pe,h);var Ke=function(d){Fe[$]=null,Te(Pe,Xe)&&tb(function(){i&&i(),d()})},We=function(){var d=Fe[$+1];d&&d()};0<$&&Fe[$-1]?Fe[$]=function(){Ke(We)}:Ke(We)},Pe.length){var Ne="loaded_"+K.I++;F[Ne]=function(Xe){Fe[$](Xe),F[Ne]=null},e=Kb(o,Pe,"gapi."+Ne,p),p.push.apply(p,Pe),Ab("ml0",Pe,h),n.sync||x.___gapisync?Wb(e):Ub(e)}else Fe[$](Ma)}else Te(Pe)&&i&&i()},Vb=qa("gapi#gapi"),Yb=function(e,n){if(K.hee&&0<K.hel)try{return e()}catch(o){n&&n(o),K.hel--,ac("debug_error",function(){try{window.___jsl.hefn(o)}catch{throw o}})}else try{return e()}catch(o){throw n&&n(o),o}};F.load=function(e,n){return Yb(function(){return ac(e,n)})};var bc=function(e){var n=window.___jsl=window.___jsl||{};return n[e]=n[e]||[],n[e]},cc=function(e){var n=window.___jsl=window.___jsl||{};return n.cfg=!e&&n.cfg||{},n.cfg},dc=function(e){return typeof e=="object"&&/\[native code\]/.test(e.push)},P=function(e,n,o){if(n&&typeof n=="object")for(var i in n)!Object.prototype.hasOwnProperty.call(n,i)||o&&i==="___goc"&&typeof n[i]>"u"||(e[i]&&n[i]&&typeof e[i]=="object"&&typeof n[i]=="object"&&!dc(e[i])&&!dc(n[i])?P(e[i],n[i]):n[i]&&typeof n[i]=="object"?(e[i]=dc(n[i])?[]:{},P(e[i],n[i])):e[i]=n[i])},ec=function(e){if(e&&!/^\s+$/.test(e)){for(;e.charCodeAt(e.length-1)==0;)e=e.substring(0,e.length-1);try{var n=window.JSON.parse(e)}catch{}if(typeof n=="object")return n;try{n=new Function("return ("+e+`
)`)()}catch{}if(typeof n=="object")return n;try{n=new Function("return ({"+e+`
})`)()}catch{}return typeof n=="object"?n:{}}},fc=function(e,n){var o={___goc:void 0};e.length&&e[e.length-1]&&Object.hasOwnProperty.call(e[e.length-1],"___goc")&&typeof e[e.length-1].___goc>"u"&&(o=e.pop()),P(o,n),e.push(o)},gc=function(e){cc(!0);var n=window.___gcfg,o=bc("cu"),i=window.___gu;n&&n!==i&&(fc(o,n),window.___gu=n),n=bc("cu");var s=document.scripts||document.getElementsByTagName("script")||[];i=[];var r=[];r.push.apply(r,bc("us"));for(var l=0;l<s.length;++l)for(var p=s[l],c=0;c<r.length;++c)p.src&&p.src.indexOf(r[c])==0&&i.push(p);for(i.length==0&&0<s.length&&s[s.length-1].src&&i.push(s[s.length-1]),s=0;s<i.length;++s)i[s].getAttribute("gapi_processed")||(i[s].setAttribute("gapi_processed",!0),(r=i[s])?(l=r.nodeType,r=l==3||l==4?r.nodeValue:r.textContent||r.innerText||r.innerHTML||""):r=void 0,(r=ec(r))&&n.push(r));for(e&&fc(o,e),i=bc("cd"),e=0,n=i.length;e<n;++e)P(cc(),i[e],!0);for(i=bc("ci"),e=0,n=i.length;e<n;++e)P(cc(),i[e],!0);for(e=0,n=o.length;e<n;++e)P(cc(),o[e],!0)},Q=function(e){var n=cc();if(!e)return n;e=e.split("/");for(var o=0,i=e.length;n&&typeof n=="object"&&o<i;++o)n=n[e[o]];return o===e.length&&n!==void 0?n:void 0},hc=function(e,n){var o;if(typeof e=="string"){var i=o={};e=e.split("/");for(var s=0,r=e.length;s<r-1;++s){var l={};i=i[e[s]]=l}i[e[s]]=n}else o=e;gc(o)},ic=function(){var e=window.__GOOGLEAPIS;e&&(e.googleapis&&!e["googleapis.config"]&&(e["googleapis.config"]=e.googleapis),A(K,"ci",[]).push(e),window.__GOOGLEAPIS=void 0)},jc={callback:1,clientid:1,cookiepolicy:1,openidrealm:-1,includegrantedscopes:-1,requestvisibleactions:1,scope:1},kc=!1,lc=B(),mc=function(){if(!kc){for(var e=document.getElementsByTagName("meta"),n=0;n<e.length;++n){var o=e[n].name.toLowerCase();if(o.lastIndexOf("google-signin-",0)==0){o=o.substring(14);var i=e[n].content;jc[o]&&i&&(lc[o]=i)}}if(window.self!==window.top){e=document.location.toString();for(var s in jc)0<jc[s]&&(n=H(e,s,""))&&(lc[s]=n)}kc=!0}return s=B(),D(lc,s),s},nc=function(e){return!!(e.clientid&&e.scope&&e.callback)},oc=window.console,pc=function(e){oc&&oc.log&&oc.log(e)},qc=function(){return!!K.oa},rc=function(){},R=A(K,"rw",B()),sc=function(e){for(var n in R)e(R[n])},tc=function(e,n){(e=R[e])&&e.state<n&&(e.state=n)},vc=/^https?:\/\/(?:\w|[\-\.])+\.google\.(?:\w|[\-:\.])+(?:\/[^\?#]*)?\/u\/(\d)\//,wc=/^https?:\/\/(?:\w|[\-\.])+\.google\.(?:\w|[\-:\.])+(?:\/[^\?#]*)?\/b\/(\d{10,21})\//,xc=function(e){var n=Q("googleapis.config/sessionIndex");if(typeof n=="string"&&254<n.length&&(n=null),n==null&&(n=window.__X_GOOG_AUTHUSER),typeof n=="string"&&254<n.length&&(n=null),n==null){var o=window.google;o&&(n=o.authuser)}return typeof n=="string"&&254<n.length&&(n=null),n==null&&(e=e||window.location.href,n=H(e,"authuser")||null,n==null&&(n=(n=e.match(vc))?n[1]:null)),n==null?null:(n=String(n),254<n.length&&(n=null),n)},yc=function(e){var n=Q("googleapis.config/sessionDelegate");return typeof n=="string"&&21<n.length&&(n=null),n==null&&(n=(e=(e||window.location.href).match(wc))?e[1]:null),n==null?null:(n=String(n),21<n.length&&(n=null),n)},zc,S,T=void 0,U=function(e){try{return m.JSON.parse.call(m.JSON,e)}catch{return!1}},V=function(e){return Object.prototype.toString.call(e)},Ac=V(0),Bc=V(new Date(0)),Cc=V(!0),Dc=V(""),Ec=V({}),Fc=V([]),W=function(e,n){if(n){for(var o=0,i=n.length;o<i;++o)if(e===n[o])throw new TypeError("Converting circular structure to JSON")}if(i=typeof e,i!=="undefined"){o=Array.prototype.slice.call(n||[],0),o[o.length]=e,n=[];var s=V(e);if(e!=null&&typeof e.toJSON=="function"&&(Object.prototype.hasOwnProperty.call(e,"toJSON")||(s!==Fc||e.constructor!==Array&&e.constructor!==Object)&&(s!==Ec||e.constructor!==Array&&e.constructor!==Object)&&s!==Dc&&s!==Ac&&s!==Cc&&s!==Bc))return W(e.toJSON.call(e),o);if(e==null)n[n.length]="null";else if(s===Ac)e=Number(e),isNaN(e)||isNaN(e-e)?e="null":e===-0&&0>1/e&&(e="-0"),n[n.length]=String(e);else if(s===Cc)n[n.length]=String(!!Number(e));else{if(s===Bc)return W(e.toISOString.call(e),o);if(s===Fc&&V(e.length)===Ac){n[n.length]="[";var r=0;for(i=Number(e.length)>>0;r<i;++r)r&&(n[n.length]=","),n[n.length]=W(e[r],o)||"null";n[n.length]="]"}else if(s==Dc&&V(e.length)===Ac){for(n[n.length]='"',r=0,o=Number(e.length)>>0;r<o;++r)i=String.prototype.charAt.call(e,r),s=String.prototype.charCodeAt.call(e,r),n[n.length]=i==="\b"?"\\b":i==="\f"?"\\f":i===`
`?"\\n":i==="\r"?"\\r":i==="	"?"\\t":i==="\\"||i==='"'?"\\"+i:31>=s?"\\u"+(s+65536).toString(16).substr(1):32<=s&&65535>=s?i:"�";n[n.length]='"'}else if(i==="object"){n[n.length]="{",i=0;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s=W(e[r],o),s!==void 0&&(i++&&(n[n.length]=","),n[n.length]=W(r),n[n.length]=":",n[n.length]=s));n[n.length]="}"}else return}return n.join("")}},Gc=/[\0-\x07\x0b\x0e-\x1f]/,Hc=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*[\0-\x1f]/,Ic=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*\\[^\\\/"bfnrtu]/,Jc=/^([^"]*"([^\\"]|\\.)*")*[^"]*"([^"\\]|\\.)*\\u([0-9a-fA-F]{0,3}[^0-9a-fA-F])/,Kc=/"([^\0-\x1f\\"]|\\[\\\/"bfnrt]|\\u[0-9a-fA-F]{4})*"/g,Lc=/-?(0|[1-9][0-9]*)(\.[0-9]+)?([eE][-+]?[0-9]+)?/g,Mc=/[ \t\n\r]+/g,Nc=/[^"]:/,Oc=/""/g,Pc=/true|false|null/g,Qc=/00/,Rc=/[\{]([^0\}]|0[^:])/,Sc=/(^|\[)[,:]|[,:](\]|\}|[,:]|$)/,Tc=/[^\[,:][\[\{]/,Uc=/^(\{|\}|\[|\]|,|:|0)+/,Vc=/\u2028/g,Wc=/\u2029/g,Xc=function(a){if(a=String(a),Gc.test(a)||Hc.test(a)||Ic.test(a)||Jc.test(a))return!1;var b=a.replace(Kc,'""');if(b=b.replace(Lc,"0"),b=b.replace(Mc,""),Nc.test(b)||(b=b.replace(Oc,"0"),b=b.replace(Pc,"0"),Qc.test(b)||Rc.test(b)||Sc.test(b)||Tc.test(b)||!b||(b=b.replace(Uc,""))))return!1;a=a.replace(Vc,"\\u2028").replace(Wc,"\\u2029"),b=void 0;try{b=T?[U(a)]:eval(`(function (var_args) {
  return Array.prototype.slice.call(arguments, 0);
})(
`+a+`
)`)}catch(e){return!1}return b&&b.length===1?b[0]:!1},Yc=function(){var e=((m.document||{}).scripts||[]).length;if((zc===void 0||T===void 0||S!==e)&&S!==-1){zc=T=!1,S=-1;try{try{T=!!m.JSON&&m.JSON.stringify.call(m.JSON,{a:[3,!0,new Date(0)],c:function(){}})==='{"a":[3,true,"1970-01-01T00:00:00.000Z"]}'&&U("true")===!0&&U('[{"a":3}]')[0].a===3}catch{}zc=T&&!U("[00]")&&!U('"\x07"')&&!U('"\\0"')&&!U('"\\v"')}finally{S=e}}},Zc=function(e){return S===-1?!1:(Yc(),(zc?U:Xc)(e))},$c=function(e){if(S!==-1)return Yc(),T?m.JSON.stringify.call(m.JSON,e):W(e)},ad=!Date.prototype.toISOString||typeof Date.prototype.toISOString!="function"||new Date(0).toISOString()!=="1970-01-01T00:00:00.000Z",bd=function(){var e=Date.prototype.getUTCFullYear.call(this);return[0>e?"-"+String(1e6-e).substr(1):9999>=e?String(1e4+e).substr(1):"+"+String(1e6+e).substr(1),"-",String(101+Date.prototype.getUTCMonth.call(this)).substr(1),"-",String(100+Date.prototype.getUTCDate.call(this)).substr(1),"T",String(100+Date.prototype.getUTCHours.call(this)).substr(1),":",String(100+Date.prototype.getUTCMinutes.call(this)).substr(1),":",String(100+Date.prototype.getUTCSeconds.call(this)).substr(1),".",String(1e3+Date.prototype.getUTCMilliseconds.call(this)).substr(1),"Z"].join("")};Date.prototype.toISOString=ad?bd:Date.prototype.toISOString;var cd=function(){this.j=-1},dd=function(){this.j=64,this.b=[],this.G=[],this.da=[],this.C=[],this.C[0]=128;for(var e=1;e<this.j;++e)this.C[e]=0;this.D=this.o=0,this.reset()};oa(dd,cd),dd.prototype.reset=function(){this.b[0]=1732584193,this.b[1]=4023233417,this.b[2]=2562383102,this.b[3]=271733878,this.b[4]=3285377520,this.D=this.o=0};var ed=function(e,n,o){o||(o=0);var i=e.da;if(typeof n=="string")for(var s=0;16>s;s++)i[s]=n.charCodeAt(o)<<24|n.charCodeAt(o+1)<<16|n.charCodeAt(o+2)<<8|n.charCodeAt(o+3),o+=4;else for(s=0;16>s;s++)i[s]=n[o]<<24|n[o+1]<<16|n[o+2]<<8|n[o+3],o+=4;for(s=16;80>s;s++){var r=i[s-3]^i[s-8]^i[s-14]^i[s-16];i[s]=(r<<1|r>>>31)&4294967295}n=e.b[0],o=e.b[1];var l=e.b[2],p=e.b[3],c=e.b[4];for(s=0;80>s;s++){if(40>s)if(20>s){r=p^o&(l^p);var g=1518500249}else r=o^l^p,g=1859775393;else 60>s?(r=o&l|p&(o|l),g=2400959708):(r=o^l^p,g=3395469782);r=(n<<5|n>>>27)+r+c+g+i[s]&4294967295,c=p,p=l,l=(o<<30|o>>>2)&4294967295,o=n,n=r}e.b[0]=e.b[0]+n&4294967295,e.b[1]=e.b[1]+o&4294967295,e.b[2]=e.b[2]+l&4294967295,e.b[3]=e.b[3]+p&4294967295,e.b[4]=e.b[4]+c&4294967295};dd.prototype.update=function(e,n){if(e!=null){n===void 0&&(n=e.length);for(var o=n-this.j,i=0,s=this.G,r=this.o;i<n;){if(r==0)for(;i<=o;)ed(this,e,i),i+=this.j;if(typeof e=="string"){for(;i<n;)if(s[r]=e.charCodeAt(i),++r,++i,r==this.j){ed(this,s),r=0;break}}else for(;i<n;)if(s[r]=e[i],++r,++i,r==this.j){ed(this,s),r=0;break}}this.o=r,this.D+=n}},dd.prototype.digest=function(){var e=[],n=8*this.D;56>this.o?this.update(this.C,56-this.o):this.update(this.C,this.j-(this.o-56));for(var o=this.j-1;56<=o;o--)this.G[o]=n&255,n/=256;for(ed(this,this.G),o=n=0;5>o;o++)for(var i=24;0<=i;i-=8)e[n]=this.b[o]>>i&255,++n;return e};var fd=function(){this.O=new dd};fd.prototype.reset=function(){this.O.reset()};var gd=x.crypto,hd=!1,id=0,jd=0,kd=1,ld=0,md="",nd=function(e){e=e||x.event;var n=e.screenX+e.clientX<<16;n+=e.screenY+e.clientY,n*=new Date().getTime()%1e6,kd=kd*n%ld,0<id&&++jd==id&&jb("mousemove",nd,"remove","de")},od=function(e){var n=new fd;e=unescape(encodeURIComponent(e));for(var o=[],i=0,s=e.length;i<s;++i)o.push(e.charCodeAt(i));for(n.O.update(o),n=n.O.digest(),e="",o=0;o<n.length;o++)e+="0123456789ABCDEF".charAt(Math.floor(n[o]/16))+"0123456789ABCDEF".charAt(n[o]%16);return e};hd=!!gd&&typeof gd.getRandomValues=="function",hd||(ld=1e6*(screen.width*screen.width+screen.height),md=od(z.cookie+"|"+z.location+"|"+new Date().getTime()+"|"+Math.random()),id=Q("random/maxObserveMousemove")||0,id!=0&&jb("mousemove",nd,"add","at"));var pd=function(){var e=kd;return e+=parseInt(md.substr(0,20),16),md=od(md),e/(ld+Math.pow(16,20))},qd=function(){var e=new x.Uint32Array(1);return gd.getRandomValues(e),+("0."+e[0])},rd=function(){var e=K.onl;if(!e){e=B(),K.onl=e;var n=B();e.e=function(o){var i=n[o];i&&(delete n[o],i())},e.a=function(o,i){n[o]=i},e.r=function(o){delete n[o]}}return e},sd=function(e,n){return n=n.onload,typeof n=="function"?(rd().a(e,n),n):null},td=function(e){return E(/^\w+$/.test(e),"Unsupported id - "+e),rd(),'onload="window.___jsl.onl.e(&#34;'+e+'&#34;)"'},ud=function(e){rd().r(e)},vd={allowtransparency:"true",frameborder:"0",hspace:"0",marginheight:"0",marginwidth:"0",scrolling:"no",style:"",tabindex:"0",vspace:"0",width:"100%"},wd={allowtransparency:!0,onload:!0},xd=0,yd=function(e){E(!e||ib.test(e),"Illegal url for new iframe - "+e)},zd=function(e,n,o,i,s){yd(o.src);var r,l=sd(i,o),p=l?td(i):"";try{document.all&&(r=e.createElement('<iframe frameborder="'+Wa(String(o.frameborder))+'" scrolling="'+Wa(String(o.scrolling))+'" '+p+' name="'+Wa(String(o.name))+'"/>'))}catch{}finally{r||(r=e.createElement("iframe"),l&&(r.onload=function(){r.onload=null,l.call(this)},ud(i)))}r.setAttribute("ng-non-bindable","");for(var c in o)e=o[c],c==="style"&&typeof e=="object"?D(e,r.style):wd[c]||r.setAttribute(c,String(e));return(c=s&&s.beforeNode||null)||s&&s.dontclear||ob(n),n.insertBefore(r,c),r=c?c.previousSibling:n.lastChild,o.allowtransparency&&(r.allowTransparency=!0),r},Ad=/^:[\w]+$/,Bd=/:([a-zA-Z_]+):/g,Cd=function(){var e=xc()||"0",n=yc(),o=xc(void 0)||e,i=yc(void 0),s="";o&&(s+="u/"+encodeURIComponent(String(o))+"/"),i&&(s+="b/"+encodeURIComponent(String(i))+"/"),o=s||null,(s=(i=Q("isLoggedIn")===!1)?"_/im/":"")&&(o="");var r=Q("iframes/:socialhost:"),l=Q("iframes/:im_socialhost:");return{socialhost:r,ctx_socialhost:i?l:r,session_index:e,session_delegate:n,session_prefix:o,im_prefix:s}},Dd=function(e,n){return Cd()[n]||""},Ed=function(e){return function(n,o){return e?Cd()[o]||e[o]||"":Cd()[o]||""}},Fd=function(e){var n;return e.match(/^https?%3A/i)&&(n=decodeURIComponent(e)),hb(document,n||e)},Gd=function(e){e=e||"canonical";for(var n=document.getElementsByTagName("link"),o=0,i=n.length;o<i;o++){var s=n[o],r=s.getAttribute("rel");if(r&&r.toLowerCase()==e&&(s=s.getAttribute("href"))&&(s=Fd(s))&&s.match(/^https?:\/\/[\w\-_\.]+/i)!=null)return s}return window.location.href},Hd={se:"0"},Id={post:!0},Jd={style:"position:absolute;top:-10000px;width:450px;margin:0px;border-style:none"},Kd="onPlusOne _ready _close _open _resizeMe _renderstart oncircled drefresh erefresh".split(" "),Ld=A(K,"WI",B()),Md=function(e,n,o){var i,s={},r=i=e;e=="plus"&&n.action&&(i=e+"_"+n.action,r=e+"/"+n.action),(i=Q("iframes/"+i+"/url"))||(i=":im_socialhost:/:session_prefix::im_prefix:_/widget/render/"+r+"?usegapi=1");for(var l in Hd)s[l]=l+"/"+(n[l]||Hd[l])+"/";if(s=hb(z,i.replace(Bd,Ed(s))),l="iframes/"+e+"/params/",r={},D(n,r),(i=Q("lang")||Q("gwidget/lang"))&&(r.hl=i),Id[e]||(r.origin=window.location.origin||window.location.protocol+"//"+window.location.host),r.exp=Q(l+"exp"),l=Q(l+"location"))for(i=0;i<l.length;i++){var p=l[i];r[p]=x.location[p]}switch(e){case"plus":case"follow":l=r.href,i=n.action?void 0:"publisher",l=(l=typeof l=="string"?l:void 0)?Fd(l):Gd(i),r.url=l,delete r.href;break;case"plusone":l=(l=n.href)?Fd(l):Gd(),r.url=l,l=n.db,i=Q(),l==null&&i&&(l=i.db,l==null&&(l=i.gwidget&&i.gwidget.db)),r.db=l||void 0,l=n.ecp,i=Q(),l==null&&i&&(l=i.ecp,l==null&&(l=i.gwidget&&i.gwidget.ecp)),r.ecp=l||void 0,delete r.href;break;case"signin":r.url=Gd()}K.ILI&&(r.iloader="1"),delete r["data-onload"],delete r.rd;for(var c in Hd)r[c]&&delete r[c];r.gsrc=Q("iframes/:source:"),c=Q("inline/css"),typeof c<"u"&&0<o&&c>=o&&(r.ic="1"),c=/^#|^fr-/,o={};for(var g in r)C(r,g)&&c.test(g)&&(o[g.replace(c,"")]=r[g],delete r[g]);g=Q("iframes/"+e+"/params/si")=="q"?r:o,c=mc();for(var y in c)!C(c,y)||C(r,y)||C(o,y)||(g[y]=c[y]);y=[].concat(Kd),(g=Q("iframes/"+e+"/methods"))&&typeof g=="object"&&Na.test(g.push)&&(y=y.concat(g));for(var M in n)C(n,M)&&/^on/.test(M)&&(e!="plus"||M!="onconnect")&&(y.push(M),delete r[M]);return delete r.callback,o._methods=y.join(","),fb(s,r,o)},Nd=["style","data-gapiscan"],Pd=function(e){for(var n=B(),o=e.nodeName.toLowerCase().indexOf("g:")!=0,i=0,s=e.attributes.length;i<s;i++){var r=e.attributes[i],l=r.name,p=r.value;0<=Oa.call(Nd,l)||o&&l.indexOf("data-")!=0||p==="null"||"specified"in r&&!r.specified||(o&&(l=l.substr(5)),n[l.toLowerCase()]=p)}return e=e.style,(o=Od(e&&e.height))&&(n.height=String(o)),(e=Od(e&&e.width))&&(n.width=String(e)),n},Od=function(e){var n=void 0;return typeof e=="number"?n=e:typeof e=="string"&&(n=parseInt(e,10)),n},Rd=function(){var e=K.drw;sc(function(n){if(e!==n.id&&n.state!=4&&n.type!="share"){var o=n.id,i=n.type,s=n.url;n=n.userParams;var r=z.getElementById(o);if(r){var l=Md(i,n,0);l?(r=r.parentNode,s.replace(/#.*/,"").replace(/(\?|&)ic=1/,"")!==l.replace(/#.*/,"").replace(/(\?|&)ic=1/,"")&&(n.dontclear=!0,n.rd=!0,n.ri=!0,n.type=i,Qd(r,n),(i=R[r.lastChild.id])&&(i.oid=o),tc(o,4))):delete R[o]}else delete R[o]}})},Sd,Td,X,Ud,Vd,Wd=/(?:^|\s)g-((\S)*)(?:$|\s)/,Xd={plusone:!0,autocomplete:!0,profile:!0,signin:!0,signin2:!0};Sd=A(K,"SW",B()),Td=A(K,"SA",B()),X=A(K,"SM",B()),Ud=A(K,"FW",[]),Vd=null;var Zd=function(e,n){Yd(void 0,!1,e,n)},Yd=function(e,n,o,i){L("ps0",!0),o=(typeof o=="string"?document.getElementById(o):o)||z;var s=z.documentMode;if(o.querySelectorAll&&(!s||8<s)){s=i?[i]:Xa(Sd).concat(Xa(Td)).concat(Xa(X));for(var r=[],l=0;l<s.length;l++){var p=s[l];r.push(".g-"+p,"g\\:"+p)}s=o.querySelectorAll(r.join(","))}else s=o.getElementsByTagName("*");for(o=B(),r=0;r<s.length;r++){l=s[r];var c=l;p=i;var g=c.nodeName.toLowerCase(),y=void 0;if(c.getAttribute("data-gapiscan"))p=null;else{var M=g.indexOf("g:");M==0?y=g.substr(2):(M=(M=String(c.className||c.getAttribute("class")))&&Wd.exec(M))&&(y=M[1]),p=!y||!(Sd[y]||Td[y]||X[y])||p&&y!==p?null:y}p&&(Xd[p]||l.nodeName.toLowerCase().indexOf("g:")==0||Xa(Pd(l)).length!=0)&&(l.setAttribute("data-gapiscan",!0),A(o,p,[]).push(l))}if(n)for(var h in o)for(n=o[h],i=0;i<n.length;i++)n[i].setAttribute("data-onload",!0);for(var Te in o)Ud.push(Te);if(L("ps1",!0),(h=Ud.join(":"))||e)try{F.load(h,e)}catch(Fe){pc(Fe);return}if($d(Vd||{}))for(var Pe in o){for(e=o[Pe],Te=0,n=e.length;Te<n;Te++)e[Te].removeAttribute("data-gapiscan");ae(Pe)}else{i=[];for(Pe in o)for(e=o[Pe],Te=0,n=e.length;Te<n;Te++)s=e[Te],be(Pe,s,Pd(s),i,n);ce(h,i)}},de=function(e){var n=A(F,e,{});n.go||(n.go=function(o){return Zd(o,e)},n.render=function(o,i){return i=i||{},i.type=e,Qd(o,i)})},ee=function(e){Sd[e]=!0},fe=function(e){Td[e]=!0},ge=function(e){X[e]=!0},ae=function(e,n){var o=sb(e);n&&o?(o(n),(o=n.iframeNode)&&o.setAttribute("data-gapiattached",!0)):F.load(e,function(){var i=sb(e),s=n&&n.iframeNode,r=n&&n.userParams;s&&i?(i(n),s.setAttribute("data-gapiattached",!0)):(i=F[e].go,e=="signin2"?i(s,r):i(s&&s.parentNode,r))})},$d=function(){return!1},ce=function(){},be=function(e,n,o,i,s,r,l){switch(he(n,e,r)){case 0:e=X[e]?e+"_annotation":e,i={},i.iframeNode=n,i.userParams=o,ae(e,i);break;case 1:if(n.parentNode){for(var p in o)if((r=C(o,p))&&(r=o[p],r=!!r&&typeof r=="object"&&(!r.toString||r.toString===Object.prototype.toString||r.toString===Array.prototype.toString)),r)try{o[p]=$c(o[p])}catch{delete o[p]}if(r=!0,o.dontclear&&(r=!1),delete o.dontclear,rc(),p=Md(e,o,s),s=l||{},s.allowPost=1,s.attributes=Jd,s.dontclear=!r,l={},l.userParams=o,l.url=p,l.type=e,o.rd)var c=n;else c=document.createElement("div"),n.setAttribute("data-gapistub",!0),c.style.cssText="position:absolute;width:450px;left:-10000px;",n.parentNode.insertBefore(c,n);l.siteElement=c,c.id||(n=c,A(Ld,e,0),r="___"+e+"_"+Ld[e]++,n.id=r),n=B(),n[">type"]=e,D(o,n),r=p,o=c,p=s||{},n=p.attributes||{},E(!(p.allowPost||p.forcePost)||!n.onload,"onload is not supported by post iframe (allowPost or forcePost)"),s=n=r,Ad.test(n)&&(s=Q("iframes/"+s.substring(1)+"/url"),E(!!s,"Unknown iframe url config for - "+n)),r=hb(z,s.replace(Bd,Dd)),n=o.ownerDocument||z,c=0;do s=p.id||["I",xd++,"_",new Date().getTime()].join("");while(n.getElementById(s)&&5>++c);E(5>c,"Error creating iframe id"),c={};var g={};n.documentMode&&9>n.documentMode&&(c.hostiemode=n.documentMode),D(p.queryParams||{},c),D(p.fragmentParams||{},g);var y=p.pfname,M=B();Q("iframes/dropLegacyIdParam")||(M.id=s),M._gfid=s,M.parent=n.location.protocol+"//"+n.location.host;var h=H(n.location.href,"parent");if(y=y||"",!y&&h&&(h=H(n.location.href,"_gfid","")||H(n.location.href,"id",""),y=H(n.location.href,"pfname",""),y=h?y+"/"+h:""),y||(h=Zc(H(n.location.href,"jcp","")))&&typeof h=="object"&&(y=(y=h.id)?h.pfname+"/"+y:""),M.pfname=y,p.connectWithJsonParam&&(h={},h.jcp=$c(M),M=h),h=H(r,"rpctoken")||c.rpctoken||g.rpctoken,h||(h=p.rpctoken||String(Math.round(1e8*(hd?qd():pd()))),M.rpctoken=h),p.rpctoken=h,D(M,p.connectWithQueryParams?c:g),h=n.location.href,M=B(),(y=H(h,"_bsh",K.bsh))&&(M._bsh=y),(h=qb(h))&&(M.jsh=h),p.hintInFragment?D(M,g):D(M,c),r=fb(r,c,g,p.paramsSerializer),g=B(),D(vd,g),D(p.attributes,g),g.name=g.id=s,g.src=r,p.eurl=r,c=p||{},M=!!c.allowPost,c.forcePost||M&&2e3<r.length){if(c=I(r),g.src="",p.dropDataPostorigin||(g["data-postorigin"]=r),r=zd(n,o,g,s),navigator.userAgent.indexOf("WebKit")!=-1){var Te=r.contentWindow.document;Te.open(),g=Te.createElement("div"),M={},h=s+"_inner",M.name=h,M.src="",M.style="display:none",zd(n,g,M,h,p)}for(g=(p=c.query[0])?p.split("&"):[],p=[],M=0;M<g.length;M++)h=g[M].split("=",2),p.push([decodeURIComponent(h[0]),decodeURIComponent(h[1])]);for(c.query=[],g=db(c),E(ib.test(g),"Invalid URL: "+g),c=n.createElement("form"),c.method="POST",c.target=s,c.style.display="none",s=g instanceof v?g:Fa(g),xa(c,"HTMLFormElement").action=Da(s),s=0;s<p.length;s++)g=n.createElement("input"),g.type="hidden",g.name=p[s][0],g.value=p[s][1],c.appendChild(g);o.appendChild(c),c.submit(),c.parentNode.removeChild(c),Te&&Te.close(),Te=r}else Te=zd(n,o,g,s,p);l.iframeNode=Te,l.id=Te.getAttribute("id"),Te=l.id,o=B(),o.id=Te,o.userParams=l.userParams,o.url=l.url,o.type=l.type,o.state=1,R[Te]=o,Te=l}else Te=null;Te&&((l=Te.id)&&i.push(l),ae(e,Te))}},he=function(e,n,o){if(e&&e.nodeType===1&&n){if(o)return 1;if(X[n]){if(pb[e.nodeName.toLowerCase()])return(e=e.innerHTML)&&e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")?0:1}else{if(Td[n])return 0;if(Sd[n])return 1}}return null},Qd=function(e,n){var o=n.type;delete n.type;var i=(typeof e=="string"?document.getElementById(e):e)||void 0;if(i){e={};for(var s in n)C(n,s)&&(e[s.toLowerCase()]=n[s]);e.rd=1,(n=!!e.ri)&&delete e.ri,s=[],be(o,i,e,s,0,n,void 0),ce(o,s)}else pc("gapi."+o+".render: missing element "+typeof e=="string"?e:"")};A(F,"platform",{}).go=Zd,$d=function(e){for(var n=["_c","jsl","h"],o=0;o<n.length&&e;o++)e=e[n[o]];return n=qb(La.href),!e||e.indexOf("n;")!=0&&n.indexOf("n;")!=0&&e!==n},ce=function(e,n){ie(e,n)};var lb=function(e){Yd(e,!0)},je=function(e,n){n=n||[];for(var o=0;o<n.length;++o)e(n[o]);for(e=0;e<n.length;e++)de(n[e])};N.push(["platform",function(e,n,o){if(Vd=o,n&&Ud.push(n),je(ee,e),je(fe,o._c.annotation),je(ge,o._c.bimodal),ic(),gc(),Q("parsetags")!="explicit"){if(rb(e),nc(mc())&&!Q("disableRealtimeCallback")&&rc(),o&&(e=o.callback)){var i=Ya(e);delete o.callback}nb(function(){lb(i)})}}]),F._pl=!0;var ke=function(e){if(e=(e=R[e])?e.oid:void 0,e){var n=z.getElementById(e);n&&n.parentNode.removeChild(n),delete R[e],ke(e)}},le=/^\{h:'/,me=/^!_/,ne="",ie=function(e,n){function o(){jb("message",i,"remove","de")}function i(r){var l=r.data,p=r.origin;if(oe(l,n)){var c=s;s=!1,c&&L("rqe"),pe(e,function(){c&&L("rqd"),o();for(var g=A(K,"RPMQ",[]),y=0;y<g.length;y++)g[y]({data:l,origin:p})})}}if(n.length!==0){ne=H(La.href,"pfname","");var s=!0;jb("message",i,"add","at"),ac(e,o)}},oe=function(e,n){if(e=String(e),le.test(e))return!0;var o=!1;if(me.test(e)&&(o=!0,e=e.substr(2)),!/^\{/.test(e))return!1;var i=Zc(e);if(!i)return!1;if(e=i.f,i.s&&e&&Oa.call(n,e)!=-1){if((i.s==="_renderstart"||i.s===ne+"/"+e+"::_renderstart")&&(i=i.a&&i.a[o?0:1],n=z.getElementById(e),tc(e,2),i&&n&&i.width&&i.height)){e:{if(o=n.parentNode,e=i||{},qc()){var s=n.id;if(s){if(i=(i=R[s])?i.state:void 0,i===1||i===4)break e;ke(s)}}(i=o.nextSibling)&&i.getAttribute&&i.getAttribute("data-gapistub")&&(o.parentNode.removeChild(i),o.style.cssText=""),i=e.width;var r=e.height,l=o.style;l.textIndent="0",l.margin="0",l.padding="0",l.background="transparent",l.borderStyle="none",l.cssFloat="none",l.styleFloat="none",l.lineHeight="normal",l.fontSize="1px",l.verticalAlign="baseline",o=o.style,o.display="inline-block",l=n.style,l.position="static",l.left="0",l.top="0",l.visibility="visible",i&&(o.width=l.width=i+"px"),r&&(o.height=l.height=r+"px"),e.verticalAlign&&(o.verticalAlign=e.verticalAlign),s&&tc(s,3)}n["data-csi-wdt"]=new Date().getTime()}return!0}return!1},pe=function(e,n){ac(e,n)},qe=function(e,n){this.L=e,e=n||{},this.fa=Number(e.maxAge)||0,this.U=e.domain,this.X=e.path,this.ga=!!e.secure};qe.prototype.read=function(){for(var e=this.L+"=",n=document.cookie.split(/;\s*/),o=0;o<n.length;++o){var i=n[o];if(i.indexOf(e)==0)return i.substr(e.length)}},qe.prototype.write=function(e,n){if(!re.test(this.L))throw"Invalid cookie name";if(!se.test(e))throw"Invalid cookie value";if(e=this.L+"="+e,this.U&&(e+=";domain="+this.U),this.X&&(e+=";path="+this.X),n=typeof n=="number"?n:this.fa,0<=n){var o=new Date;o.setSeconds(o.getSeconds()+n),e+=";expires="+o.toUTCString()}return this.ga&&(e+=";secure"),document.cookie=e,!0},qe.prototype.clear=function(){this.write("",0)};var se=/^[-+/_=.:|%&a-zA-Z0-9@]*$/,re=/^[A-Z_][A-Z0-9_]{0,63}$/;qe.iterate=function(e){for(var n=document.cookie.split(/;\s*/),o=0;o<n.length;++o){var i=n[o].split("="),s=i.shift();e(s,i.join("="))}};var te=function(e){this.B=e};te.prototype.read=function(){if(Y.hasOwnProperty(this.B))return Y[this.B]},te.prototype.write=function(e){return Y[this.B]=e,!0},te.prototype.clear=function(){delete Y[this.B]};var Y={};te.iterate=function(e){for(var n in Y)Y.hasOwnProperty(n)&&e(n,Y[n])};var ue=window.location.protocol==="https:",ve=ue||window.location.protocol==="http:"?qe:te,we=function(e){var n=e.substr(1),o="",i=window.location.hostname;if(n!==""){if(o=parseInt(n,10),isNaN(o)||(n=i.split("."),n.length<o-1))return null;n.length==o-1&&(i="."+i)}else i="";return{i:e.charAt(0)=="S",domain:i,l:o}},xe=function(){var e,n=null;return ve.iterate(function(o,i){o.indexOf("G_AUTHUSER_")===0&&(o=we(o.substring(11)),!e||o.i&&!e.i||o.i==e.i&&o.l>e.l)&&(e=o,n=i)}),{ea:e,F:n}},ye=function(e){if(e.indexOf("GCSC")!==0)return null;var n={W:!1};if(e=e.substr(4),!e)return n;var o=e.charAt(0);e=e.substr(1);var i=e.lastIndexOf("_");if(i==-1)return n;var s=we(e.substr(i+1));return s==null||(e=e.substring(0,i),e.charAt(0)!=="_")?n:(i=o==="E"&&s.i,!i&&(o!=="U"||s.i)||i&&!ue?n:{W:!0,i,ja:e.substr(1),domain:s.domain,l:s.l})},ze=function(e){return e?(e=e.split("="),e[1]?e[1].split("|"):[]):[]},Ae=function(e){return e=e.split(":"),{clientId:e[0].split("=")[1],ia:ze(e[1]),la:ze(e[2]),ka:ze(e[3])}},Be=function(){var e=xe(),n=e.ea;if(e=e.F,e!==null){var o;if(ve.iterate(function(r,l){(r=ye(r))&&r.W&&r.i==n.i&&r.l==n.l&&(o=l)}),o){var i=Ae(o),s=i&&i.ia[Number(e)];if(i=i&&i.clientId,s)return{F:e,ha:s,clientId:i}}}return null},Z=function(){this.T=Ce};Z.prototype.$=function(){this.K||(this.v=0,this.K=!0,this.Y())},Z.prototype.Y=function(){this.K&&(this.T()?this.v=this.R:this.v=Math.min(2*(this.v||this.R),120),window.setTimeout(na(this.Y,this),1e3*this.v))},Z.prototype.v=0,Z.prototype.R=2,Z.prototype.T=null,Z.prototype.K=!1;var Ee=null;qc=function(){return K.oa=!0},rc=function(){K.oa=!0;var e=Be();(e=e&&e.F)&&hc("googleapis.config/sessionIndex",e),Ee||(Ee=A(K,"ss",new Z)),e=Ee,e.$&&e.$()};var Ce=function(){var e=Be(),n=e&&e.ha||null,o=e&&e.clientId;return ac("auth",{callback:function(){var i=x.gapi.auth,s={client_id:o,session_state:n};i.checkSessionState(s,function(r){var l=s.session_state,p=Q("isLoggedIn");r=Q("debug/forceIm")?!1:l&&r||!l&&!r,(p=p!=r)&&(hc("isLoggedIn",r),rc(),Rd(),r||((r=i.signOut)?r():(r=i.setToken)&&r(null))),r=mc();var c=Q("savedUserState");l=i._guss(r.cookiepolicy),c=c!=l&&typeof c<"u",hc("savedUserState",l),(p||c)&&nc(r)&&!Q("disableRealtimeCallback")&&i._pimf(r,!0)})}}),!0};L("bs0",!0,window.gapi._bs),L("bs1",!0),delete window.gapi._bs}).call(void 0);gapi.load("",{callback:window.gapi_onload,_c:{jsl:{ci:{deviceType:"desktop","oauth-flow":{authUrl:"https://accounts.google.com/o/oauth2/auth",proxyUrl:"https://accounts.google.com/o/oauth2/postmessageRelay",disableOpt:!0,idpIframeUrl:"https://accounts.google.com/o/oauth2/iframe",usegapi:!1},debug:{reportExceptionRate:.05,forceIm:!1,rethrowException:!1,host:"https://apis.google.com"},enableMultilogin:!0,"googleapis.config":{auth:{useFirstPartyAuthV2:!0}},isPlusUser:!1,inline:{css:1},disableRealtimeCallback:!1,drive_share:{skipInitCommand:!0},csi:{rate:.01},client:{cors:!1},isLoggedIn:!0,signInDeprecation:{rate:0},include_granted_scopes:!0,llang:"pt",iframes:{youtube:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/youtube?usegapi=1",methods:["scroll","openwindow"]},ytsubscribe:{url:"https://www.youtube.com/subscribe_embed?usegapi=1"},plus_circle:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/plus/circle?usegapi=1"},plus_share:{params:{url:""},url:":socialhost:/:session_prefix::se:_/+1/sharebutton?plusShare=true&usegapi=1"},rbr_s:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/render/recobarsimplescroller"},":source:":"3p",playemm:{url:"https://play.google.com/work/embedded/search?usegapi=1&usegapi=1"},savetoandroidpay:{url:"https://pay.google.com/gp/v/widget/save"},blogger:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/blogger?usegapi=1",methods:["scroll","openwindow"]},evwidget:{params:{url:""},url:":socialhost:/:session_prefix:_/events/widget?usegapi=1"},partnersbadge:{url:"https://www.gstatic.com/partners/badge/templates/badge.html?usegapi=1"},dataconnector:{url:"https://dataconnector.corp.google.com/:session_prefix:ui/widgetview?usegapi=1"},surveyoptin:{url:"https://www.google.com/shopping/customerreviews/optin?usegapi=1"},":socialhost:":"https://apis.google.com",shortlists:{url:""},hangout:{url:"https://talkgadget.google.com/:session_prefix:talkgadget/_/widget"},plus_followers:{params:{url:""},url:":socialhost:/_/im/_/widget/render/plus/followers?usegapi=1"},post:{params:{url:""},url:":socialhost:/:session_prefix::im_prefix:_/widget/render/post?usegapi=1"},":gplus_url:":"https://plus.google.com",signin:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/signin?usegapi=1",methods:["onauth"]},rbr_i:{params:{url:""},url:":socialhost:/:session_prefix::se:_/widget/render/recobarinvitation"},share:{url:":socialhost:/:session_prefix::im_prefix:_/widget/render/share?usegapi=1"},plusone:{params:{count:"",size:"",url:""},url:":socialhost:/:session_prefix::se:_/+1/fastbutton?usegapi=1"},comments:{params:{location:["search","hash"]},url:":socialhost:/:session_prefix:_/widget/render/comments?usegapi=1",methods:["scroll","openwindow"]},":im_socialhost:":"https://plus.googleapis.com",backdrop:{url:"https://clients3.google.com/cast/chromecast/home/widget/backdrop?usegapi=1"},visibility:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/visibility?usegapi=1"},autocomplete:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/autocomplete"},additnow:{url:"https://apis.google.com/marketplace/button?usegapi=1",methods:["launchurl"]},":signuphost:":"https://plus.google.com",ratingbadge:{url:"https://www.google.com/shopping/customerreviews/badge?usegapi=1"},appcirclepicker:{url:":socialhost:/:session_prefix:_/widget/render/appcirclepicker"},follow:{url:":socialhost:/:session_prefix:_/widget/render/follow?usegapi=1"},community:{url:":ctx_socialhost:/:session_prefix::im_prefix:_/widget/render/community?usegapi=1"},sharetoclassroom:{url:"https://classroom.google.com/sharewidget?usegapi=1"},ytshare:{params:{url:""},url:":socialhost:/:session_prefix:_/widget/render/ytshare?usegapi=1"},plus:{url:":socialhost:/:session_prefix:_/widget/render/badge?usegapi=1"},family_creation:{params:{url:""},url:"https://families.google.com/webcreation?usegapi=1&usegapi=1"},commentcount:{url:":socialhost:/:session_prefix:_/widget/render/commentcount?usegapi=1"},configurator:{url:":socialhost:/:session_prefix:_/plusbuttonconfigurator?usegapi=1"},zoomableimage:{url:"https://ssl.gstatic.com/microscope/embed/"},appfinder:{url:"https://workspace.google.com/:session_prefix:marketplace/appfinder?usegapi=1"},savetowallet:{url:"https://pay.google.com/gp/v/widget/save"},person:{url:":socialhost:/:session_prefix:_/widget/render/person?usegapi=1"},savetodrive:{url:"https://drive.google.com/savetodrivebutton?usegapi=1",methods:["save"]},page:{url:":socialhost:/:session_prefix:_/widget/render/page?usegapi=1"},card:{url:":socialhost:/:session_prefix:_/hovercard/card"}}},h:"m;/_/scs/apps-static/_/js/k=oz.gapi.pt_BR.l4Bv_WkVC6g.O/am=wQE/d=1/ct=zgms/rs=AGLTcCOuH5S2uqmF6E8zOW7n3yiqiwhzNQ/m=__features__",u:"https://apis.google.com/js/platform.js",hee:!0,fp:"821a251b140e4add32f87f4a7a08f044a59aa0e9",dpo:!1},platform:["additnow","backdrop","blogger","comments","commentcount","community","donation","family_creation","follow","hangout","health","page","partnersbadge","person","playemm","playreview","plus","plusone","post","ratingbadge","savetoandroidpay","savetodrive","savetowallet","sharetoclassroom","shortlists","signin2","surveyoptin","visibility","youtube","ytsubscribe","zoomableimage"],fp:"821a251b140e4add32f87f4a7a08f044a59aa0e9",annotation:["interactivepost","recobar","signin2","autocomplete","profile"],bimodal:["signin","share"]}});const SCOPES="https://www.googleapis.com/auth/drive.file",DEFAULT_CLIENT_ID="349142714775-v6pkei8amce6jjq4fbpu07vrcvk4k1vl.apps.googleusercontent.com";function initializeGoogleDriveAPI(e=DEFAULT_CLIENT_ID){gapi.load("client:auth2",()=>{gapi.client.init({clientId:e,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:SCOPES})})}function signInToGoogle(){return gapi.auth2.getAuthInstance().signIn()}let folderId=null;async function getOrCreateFolder(){var l,p;if(folderId)return folderId;const e=(l=gapi.auth.getToken())==null?void 0:l.access_token;if(!e)throw new Error("User is not authenticated");const i=(p=(await(await fetch("https://www.googleapis.com/drive/v3/files?q=name=%27LatheGcodeVisualiser%27+and+mimeType=%27application/vnd.google-apps.folder%27",{method:"GET",headers:new Headers({Authorization:`Bearer ${e}`})})).json()).files)==null?void 0:p[0];return i?(folderId=i.id,folderId):(folderId=(await(await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:new Headers({Authorization:`Bearer ${e}`,"Content-Type":"application/json"}),body:JSON.stringify({name:"LatheGcodeVisualiser",mimeType:"application/vnd.google-apps.folder"})})).json()).id,folderId)}async function saveFileToGoogleDrive(e,n){var p;const o=new Blob([n],{type:"application/json"}),i={name:e,mimeType:"application/json",parents:[await getOrCreateFolder()]},s=new FormData;s.append("metadata",new Blob([JSON.stringify(i)],{type:"application/json"})),s.append("file",o);const r=(p=gapi.auth.getToken())==null?void 0:p.access_token;if(!r)throw new Error("User is not authenticated");return(await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:new Headers({Authorization:`Bearer ${r}`}),body:s})).json()}async function setItemAndSyncToGoogleDrive(e,n){if(localStorage.setItem(e,JSON.stringify(n)),e.startsWith("taskCollections_")||e.startsWith("savedProjects_"))try{await saveFileToGoogleDrive(e,JSON.stringify(n)),console.log(`Successfully synced ${e} to Google Drive.`)}catch(o){console.error(`Failed to sync ${e} to Google Drive:`,o)}}const availableTasks=document.getElementById("availableTasks"),tasksToExecute=document.getElementById("tasksToExecute"),deleteTasks=document.getElementById("deleteTasks"),addNewTask=document.getElementById("addNewTaskButton"),newTaskModal=document.getElementById("newTaskModal"),closeTaskModal=document.getElementById("closeNewTaskModal"),newTaskType=document.getElementById("newTaskType"),gcodeTaskContainer=document.getElementById("gcodeTaskContainer"),newTaskGcode=document.getElementById("newTaskGcode"),emulationOuterContainer=document.getElementById("emulationOuterContainer"),saveNewTaskButton=document.getElementById("saveNewTaskButton"),newTaskGcodeRepeatable=document.getElementById("newTaskGcodeRepeatable"),newTaskName=document.getElementById("newTaskName"),taskTextTitle=document.getElementById("taskTextTitle"),newTaskDescription=document.getElementById("newTaskDescription");let sender$1;const connectButton=document.getElementById("connectButton"),plannerContainer=document.getElementById("plannerContainer");let feedRate=null;const saveAvailableTaskCollectionButton=document.getElementById("saveAvailableTaskCollection"),saveAvailableTaskCollectionButtonModal=document.getElementById("saveAvailableTaskCollectionButtonModal"),loadTaskCollectionButton=document.getElementById("loadTaskCollection"),availableTaskCollections=document.getElementById("availableTaskCollections"),collectionToSaveTo=document.getElementById("collectionToSaveTo"),newCollectionNameContainer=document.getElementById("newCollectionNameContainer"),newCollectionName=document.getElementById("newCollectionName"),deleteTaskCollectionButton=document.getElementById("deleteTaskCollection"),saveCollectionModal=document.getElementById("saveCollectionModal"),saveCollectionModalToSaveTo=document.getElementById("saveCollectionModalToSaveTo"),saveCollectionModalCloseButton=document.getElementById("saveCollectionModalClose"),newCollectionNameModal=document.getElementById("newCollectionNameModal"),newCollectionNameContainerModal=document.getElementById("newCollectionNameContainerModal"),importAvailableTasksButton=document.getElementById("importAvailableTasks"),exportAvailableTasksButton=document.getElementById("exportAvailableTasks"),saveJobModal=document.getElementById("saveJobModal"),saveJobModalCloseButton=document.getElementById("saveJobModalClose"),executeJobButton=document.getElementById("executeJobButton"),saveJobButton=document.getElementById("saveJobButton"),newJobButton=document.getElementById("newJobButton"),saveJobNameInput=document.getElementById("saveJobNameInput"),saveJobNameSelect=document.getElementById("saveJobNameSelect"),newJobNameContainer=document.getElementById("newJobNameContainer"),saveProjectNameSelect=document.getElementById("saveProjectNameSelect"),saveProjectNameInput=document.getElementById("saveProjectNameInput"),newProjectNameContainer=document.getElementById("newProjectNameContainer"),saveJobGroupNameInput=document.getElementById("saveJobGroupNameInput"),saveJobGroupNameSelect=document.getElementById("saveJobGroupNameSelect"),newJobGroupNameContainer=document.getElementById("newJobGroupNameContainer"),saveJobSaveButton=document.getElementById("saveJobSaveButton"),jobLoadSelect=document.getElementById("jobLoadSelect"),projectLoadSelect=document.getElementById("projectLoadSelect"),groupLoadSelect=document.getElementById("groupLoadSelect"),loadJobButton=document.getElementById("loadJobButton"),deleteJobButton=document.getElementById("deleteJobButton"),importJobButton=document.getElementById("importJobButton"),exportJobButton=document.getElementById("exportJobButton"),exportJobModal=document.getElementById("exportJobModal"),exportJobModalCloseButton=document.getElementById("exportJobModalClose"),exportJobSaveButton=document.getElementById("exportJobSaveButton"),exportJobProjectNameSelect=document.getElementById("exportJobProjectNameSelect"),exportJobGroupNameSelect=document.getElementById("exportJobGroupNameSelect"),exportJobNameSelect=document.getElementById("exportJobNameSelect"),jobQueue=[],manualTaskModal=document.getElementById("manualTaskModal"),cncTaskModal=document.getElementById("cncTaskModal"),cancelManualTaskButton=document.getElementById("cancelManualTask"),completeManualTaskButton=document.getElementById("completeManualTask"),manualTaskInstructions=document.getElementById("manualTaskInstructions"),cncTaskGcode=document.getElementById("cncTaskGcode"),cancelCncTaskButton=document.getElementById("cancelCncTask"),executeGcodeButton=document.getElementById("executeGcode"),completeCncTaskButton=document.getElementById("completeCncTask"),manualTaskName=document.getElementById("manualTaskName"),cncTaskName=document.getElementById("cncTaskName"),cncTaskSenderProgressLabel=document.getElementById("cncTaskSenderProgressLabel"),cncTaskSenderProgress=document.getElementById("cncTaskSenderProgress"),jobCancelledModal=document.getElementById("jobCancelledModal"),jobCancelledCloseButton=document.getElementById("jobCancelledCloseButton"),completeTaskModal=document.getElementById("completeTaskModal"),completeTaskCloseButton=document.getElementById("completeTaskCloseButton"),notConnectedModal=document.getElementById("notConnectedModal"),notConnectedCloseButton=document.getElementById("notConnectedCloseButton"),currentGcodeLineContainer=document.getElementById("currentGcodeLineContainer"),currentGcodeLine=document.getElementById("currentGcodeLine"),currentFeedrateContainer=document.getElementById("currentFeedrateContainer"),currentFeedrate=document.getElementById("currentFeedrate"),emulationInnerContainer=document.getElementById("emulationInnerContainer"),emulationNewTasksList=document.getElementById("emulationNewTasks"),emulatedButtonListDelete=document.getElementById("emulatedButtonListDelete"),emulationTaskModal=document.getElementById("emulationTaskModal");document.addEventListener("DOMContentLoaded",()=>{sender$1=Sender.getInstance(),sender$1.addStatusChangeListener(()=>l(),SenderClient.PLANNER),sender$1.addCurrentCommandListener(r),plannerContainer.addEventListener("containerVisible",()=>{tasksToExecute.innerHTML="",s(),h(),M(),Ke(),n(),i();const d=o();y(d),Te()}),saveCollectionModalToSaveTo.addEventListener("change",()=>{saveCollectionModalToSaveTo.value==="new"?newCollectionNameContainerModal.style.display="block":newCollectionNameContainerModal.style.display="none"}),collectionToSaveTo.addEventListener("change",()=>{collectionToSaveTo.value==="new"?newCollectionNameContainer.style.display="block":newCollectionNameContainer.style.display="none"}),saveJobNameSelect.addEventListener("change",()=>{saveJobNameSelect.value==="new"?newJobNameContainer.style.display="block":newJobNameContainer.style.display="none"}),saveJobGroupNameSelect.addEventListener("change",()=>{saveJobGroupNameSelect.value==="new"?newJobGroupNameContainer.style.display="block":newJobGroupNameContainer.style.display="none"}),saveProjectNameSelect.addEventListener("change",()=>{saveProjectNameSelect.value==="new"?saveProjectNameInput.style.display="block":saveProjectNameInput.style.display="none"}),saveCollectionModalCloseButton.onclick=function(){saveCollectionModal.style.display="none"},saveAvailableTaskCollectionButton.onclick=function(){saveCollectionModal.style.display="block"},saveAvailableTaskCollectionButtonModal.onclick=async function(){let d="";if(saveCollectionModalToSaveTo.value==="new"){if(d=newCollectionNameModal.value,d===null||d===""){alert("Please enter a name for the collection");return}}else d=saveCollectionModalToSaveTo.value;const j=localStorage.getItem("selectedTaskCollection");let u;if(j){const f=localStorage.getItem(`taskCollection_${j}`);f&&(u=JSON.parse(f),d!==j&&(u.name=d,await setItemAndSyncToGoogleDrive(`taskCollection_${d}`,JSON.stringify(u))))}const k=document.createElement("option");k.value=d,k.textContent=d,availableTaskCollections.appendChild(k),saveCollectionModal.style.display="none",alert(`Collection ${d} saved`),s()},loadTaskCollectionButton.onclick=function(){const d=availableTaskCollections.value;localStorage.setItem("selectedTaskCollection",d),h()},deleteTaskCollectionButton.onclick=function(){const d=availableTaskCollections.value;if(d==="default"){alert("You cannot delete the default collection");return}confirm(`Are you sure you want to delete the collection ${d}?`)&&(localStorage.removeItem(`taskCollection_${d}`),s(),h())},importAvailableTasksButton.onclick=function(){const d=document.createElement("input");d.type="file",d.accept=".json",d.multiple=!0,d.onchange=async function(j){const u=j.target.files;if(u)for(let k=0;k<u.length;k++){const f=u[k],_=new FileReader;_.onload=function(J){var Oe;const Se=(Oe=J.target)==null?void 0:Oe.result;Se&&(JSON.parse(Se).forEach(Ge=>{const He=Ge.name;localStorage.getItem(`taskCollection_${He}`)?window.confirm(`Task collection ${He} already exists. Do you want to override it?`)&&localStorage.setItem(`taskCollection_${He}`,JSON.stringify(Ge)):localStorage.setItem(`taskCollection_${He}`,JSON.stringify(Ge))}),s())},_.readAsText(f)}},d.click()},exportAvailableTasksButton.onclick=function(){const d=Object.keys(localStorage).filter(Se=>Se.includes("taskCollection_")),j=[];d.forEach(Se=>{const Oe=localStorage.getItem(Se);Oe&&j.push(JSON.parse(Oe))});const u=new Blob([JSON.stringify(j,null,2)],{type:"application/json"}),k=URL.createObjectURL(u),f=document.createElement("a");f.href=k;const J=new Date().toISOString().split("T")[0];f.download=`availableTasks_${J}.json`,f.click(),URL.revokeObjectURL(k)},emulationInnerContainer.addEventListener("click",function(d){const j=d.target;if(j.tagName==="BUTTON"){const u=j.id;e(u)}});function e(d){const j=document.getElementById(d),u=j==null?void 0:j.cloneNode(!0);u.classList.add("emulated-button-list"),u.removeAttribute("id");const k="emulated-"+Date.now();u.setAttribute("data-emulated-id",k),emulationNewTasksList==null||emulationNewTasksList.appendChild(u)}function n(){if(groupLoadSelect.innerHTML="",!projectLoadSelect||!projectLoadSelect.value)return;const d=localStorage.getItem(`savedProject_${projectLoadSelect.value}`);if(!d)return;const j=JSON.parse(d);j.groups.forEach(k=>{const f=document.createElement("option");f.value=k.name,f.textContent=k.name,groupLoadSelect.appendChild(f)});const u=localStorage.getItem("selectedGroup");u&&j.groups.some(f=>f.name===u)&&(groupLoadSelect.value=u)}function o(){const d=projectLoadSelect.value,j=groupLoadSelect.value,u=jobLoadSelect.value;if(!d||!j||!u)return null;const k=localStorage.getItem(`savedProject_${d}`);if(!k)return null;const _=JSON.parse(k).groups.find(Se=>Se.name===j);if(!_)return null;const J=_.jobs.find(Se=>Se.name===u);return J?(J.groupName||(J.groupName=j),J):null}function i(){if(jobLoadSelect.innerHTML="",!projectLoadSelect||!projectLoadSelect.value)return;const d=localStorage.getItem(`savedProject_${projectLoadSelect.value}`);if(!d)return;const j=JSON.parse(d),u=groupLoadSelect.value,k=j.groups.find(f=>f.name===u);k&&k.jobs.forEach(f=>{const _=document.createElement("option");_.value=f.name,_.textContent=f.name,jobLoadSelect.appendChild(_)})}function s(){availableTaskCollections.innerHTML="",collectionToSaveTo.innerHTML="",saveCollectionModalToSaveTo.innerHTML="";const d=document.createElement("option");d.value="default",d.textContent="default",availableTaskCollections.appendChild(d),collectionToSaveTo.appendChild(d.cloneNode(!0)),saveCollectionModalToSaveTo.appendChild(d.cloneNode(!0)),Object.keys(localStorage).filter(f=>f.includes("taskCollection_")).sort().forEach(f=>{if(f==="taskCollection_default")return;const _=f.replace("taskCollection_",""),J=document.createElement("option");J.value=_,J.textContent=_,availableTaskCollections.appendChild(J),collectionToSaveTo.appendChild(J.cloneNode(!0)),saveCollectionModalToSaveTo.appendChild(J.cloneNode(!0))});const u=localStorage.getItem("selectedTaskCollection");u&&(availableTaskCollections.value=u);const k=document.createElement("option");k.value="new",k.textContent="--new collection--",collectionToSaveTo.appendChild(k.cloneNode(!0)),saveCollectionModalToSaveTo.appendChild(k.cloneNode(!0))}notConnectedCloseButton.onclick=function(){notConnectedModal.style.display="none"};function r(d){if(!sender$1)return;const u=sender$1.getStatus().condition==="run";if(u){if(u){const k=d.match(/F(\d+)/);k&&(feedRate=parseInt(k[1],10),currentFeedrate.innerText=feedRate.toString()),currentGcodeLine.innerText=d,currentFeedrateContainer.style.display="block",currentGcodeLineContainer.style.display="block"}}}function l(){var u;if(!sender$1)return;const d=sender$1.getStatus();if(d.isConnected===!1){connectButton.innerText="Connect",connectButton.disabled=!1,connectButton.style.backgroundColor="";return}else connectButton.innerText="Connected",connectButton.disabled=!0,connectButton.style.backgroundColor="green";const j=d.condition==="run";j?j&&(executeGcodeButton.disabled=!0,executeGcodeButton.classList.add("disabled-button"),executeGcodeButton.classList.remove("interaction-ready-button"),completeCncTaskButton.classList.remove("interaction-ready-button"),cncTaskSenderProgressLabel.innerText="Task in progress",completeCncTaskButton.style.display="none"):(completeCncTaskButton.style.display="block",completeCncTaskButton.disabled=!1,completeCncTaskButton.classList.add("interaction-ready-button"),cncTaskSenderProgressLabel.innerText="Task completed",((u=executeGcodeButton.attributes.getNamedItem("data-repeatable"))==null?void 0:u.value)==="true"?(executeGcodeButton.disabled=!1,executeGcodeButton.classList.remove("disabled-button"),executeGcodeButton.classList.add("interaction-ready-button"),executeGcodeButton.textContent="Execute Again?"):executeGcodeButton.disabled=!0),cncTaskSenderProgress.value=d.progress,cncTaskSenderProgress.style.display="block",cncTaskSenderProgressLabel.style.display="block"}dragula$1([emulationNewTasksList,emulatedButtonListDelete],{copy:!1,accepts:(d,j)=>j===emulatedButtonListDelete||j===emulationNewTasksList,revertOnSpill:!0,removeOnSpill:!1}).on("drop",(d,j)=>{if(j===emulatedButtonListDelete){d.remove();const u=d.getAttribute("data-emulated-id"),k=emulationNewTasksList.querySelector(`[data-emulated-id="${u}"]`);k&&k.remove()}});const c=dragula$1([availableTasks,tasksToExecute,deleteTasks],{copy:(d,j)=>j===availableTasks,accepts:(d,j)=>j===tasksToExecute||j===deleteTasks,revertOnSpill:!0,removeOnSpill:!1});c.on("dragend",()=>{Te(),M(),g("currentJob")});function g(d,j="",u=""){const k=tasksToExecute.querySelectorAll(".task-to-execute"),f={name:"",projectName:"",groupName:"",tasks:[]};if(k.forEach(_=>{const J=_.getAttribute("data-task-id"),Se=_.getAttribute("data-collection-name");f.tasks.push({id:J,collectionName:Se})}),f.name=d,f.groupName=j,d==="currentJob")localStorage.setItem(d,JSON.stringify(f));else if(u&&j){let _=localStorage.getItem(`savedProject_${u}`),J;_?J=JSON.parse(_):J={name:u,groups:[]};let Se=J.groups.find(Me=>Me.name===j);Se||(Se={name:j,jobs:[]},J.groups.push(Se));const Oe=Se.jobs.findIndex(Me=>Me.name===d);Oe!==-1?Se.jobs[Oe]={name:d,projectName:u,groupName:j,tasks:f.tasks}:Se.jobs.push({name:d,projectName:u,groupName:j,tasks:f.tasks}),setItemAndSyncToGoogleDrive(`savedProject_${u}`,JSON.stringify(J))}}function y(d){let j=d.tasks;const u=[];j=j.filter(k=>localStorage.getItem(`taskCollection_${k.collectionName}`)?!0:(u.push(k),!1)),localStorage.setItem("currentJob",JSON.stringify(j)),tasksToExecute.innerHTML="",j.forEach(k=>{const f=localStorage.getItem(`taskCollection_${k.collectionName}`);if(f){const J=JSON.parse(f).tasks.find(Se=>Se.id===k.id);if(J){const Se=document.createElement("div");Se.classList.add(`task-${J.type}`),Se.classList.add("task-to-execute"),Se.setAttribute("data-task-id",J.id),Se.setAttribute("data-task-name",J.name),Se.setAttribute("data-collection-name",k.collectionName),Se.textContent=J.name,tasksToExecute.appendChild(Se)}}}),u.length>0&&alert(`The following tasks were removed because their collection does not exist: ${u.map(k=>k.id).join(", ")}`),localStorage.setItem("loadedJob",JSON.stringify({name:d.name,groupName:d.groupName}))}c.on("drop",(d,j,u)=>{const k=d.getAttribute("data-task-id"),f=d.getAttribute("data-task-order");if(j===tasksToExecute)d.classList.remove("available-task"),d.classList.add("task-to-execute"),M();else if(j===deleteTasks){d.remove();let _=null;if(u===tasksToExecute)_=tasksToExecute.querySelector(`[data-task-order="${f}"]`);else if(u===availableTasks&&(_=availableTasks.querySelector(`[data-task-id="${k}"]`),_)){const J=_.getAttribute("data-collection-name"),Se=localStorage.getItem(`taskCollection_${J}`);if(Se){const Oe=JSON.parse(Se);Oe.tasks=Oe.tasks.filter(Me=>Me.id!==k),localStorage.setItem(`taskCollection_${J}`,JSON.stringify(Oe))}}_&&_.remove()}});function M(){tasksToExecute.querySelectorAll(".task-to-execute").forEach(j=>{if(j.querySelector("i")){let u=j.querySelector("i");u&&(u.remove(),u=document.createElement("i"),j.classList.contains("task-manual")?(u.className="fas fa-users-cog icon-tooltip",u.setAttribute("data-tooltip","Manual Task")):j.classList.contains("task-gcode")?(u.className="fas fa-code icon-tooltip",u.setAttribute("data-tooltip","Gcode Task")):j.classList.contains("task-emulation")&&(u.className="far fa-keyboard icon-tooltip",u.setAttribute("data-tooltip","Emulation Task")),j.appendChild(u))}else{const u=document.createElement("i");j.classList.contains("task-manual")?(u.className="fas fa-users-cog icon-tooltip",u.setAttribute("data-tooltip","Manual Task")):j.classList.contains("task-gcode")?(u.className="fas fa-code icon-tooltip",u.setAttribute("data-tooltip","Gcode Task")):j.classList.contains("task-emulation")&&(u.className="far fa-keyboard icon-tooltip",u.setAttribute("data-tooltip","Emulation Task")),j.appendChild(u)}})}function h(){availableTasks.innerHTML="";let d=localStorage.getItem("selectedTaskCollection");(d===null||d==="")&&(d=availableTaskCollections.value,localStorage.setItem("selectedTaskCollection",d));const j=localStorage.getItem(`taskCollection_${d}`);j&&JSON.parse(j).tasks.forEach(k=>{k.id,k.name,k.type,k.description,k.gcode&&k.gcode,k.buttonKeys&&k.buttonKeys;const f=document.createElement("div");f.classList.add(`task-${k.type}`),f.classList.add("available-task"),f.setAttribute("data-task-type",k.type),f.setAttribute("data-task-id",k.id.toString()),f.setAttribute("data-task-name",k.name),f.setAttribute("data-collection-name",d||""),f.textContent=k.name;const _=document.createElement("i");_.classList.add("fas","fa-info-circle","fa-fw","show-info","icon-tooltip"),_.setAttribute("data-tooltip","Click for more info..."),f.appendChild(_),availableTasks.appendChild(f)})}function Te(){const d=document.getElementById("tasksToExecute");d&&d.querySelectorAll("div").forEach((u,k)=>{const f=u.getAttribute("data-task-name");u.setAttribute("data-task-order",(k+1).toString()),u.textContent=`Task ${k+1}: ${f}`})}newTaskType.addEventListener("change",()=>{newTaskType.value==="manual"?(newTaskGcode.disabled=!0,newTaskGcode.placeholder="Disabled for manual tasks",newTaskGcode.value="",gcodeTaskContainer.style.display="none",emulationOuterContainer.style.display="none"):newTaskType.value==="emulation"?(newTaskGcode.disabled=!0,newTaskGcode.placeholder="Disabled for emulation tasks",newTaskGcode.value="",gcodeTaskContainer.style.display="none",emulationOuterContainer.style.display="block"):(emulationOuterContainer.style.display="none",gcodeTaskContainer.style.display="block",newTaskGcode.placeholder="Enter gcode here...",newTaskGcode.disabled=!1)}),addNewTask.addEventListener("click",()=>{newTaskModal.style.display="block",taskTextTitle.textContent="Add a new task",newTaskName.value="",newTaskDescription.value="",newTaskGcode.value="",newCollectionName.value="",newTaskModal.removeAttribute("data-task-id"),collectionToSaveTo.value=""}),saveNewTaskButton.addEventListener("click",()=>{if(collectionToSaveTo.value===""){alert("Please select a collection.");return}if(collectionToSaveTo.value==="new"&&newCollectionName.value===""){alert("Please enter a collection name");return}if(newTaskName.value===""||newTaskName.value===null){alert("Please enter a task name");return}const d=newTaskName.value,j=document.createElement("div");j.classList.add(`task-${newTaskType.value}`),j.classList.add("available-task");let u;const k=newTaskModal.getAttribute("data-task-id");k?u=k:u=nanoid(),j.setAttribute("data-task-id",u.toString()),j.setAttribute("data-task-name",d),j.textContent=d;const f=document.createElement("i");f.classList.add("fas","fa-info-circle","fa-fw","show-info","icon-tooltip"),f.setAttribute("data-tooltip","Click for more info..."),j.appendChild(f);const _=availableTasks.querySelector(`[data-task-id="${u}"]`);_&&_.remove(),availableTasks.appendChild(j),newTaskModal.style.display="none";let J="";newTaskType.value==="emulation"&&(emulationNewTasksList.querySelectorAll(".emulated-button-list").forEach(Me=>{const Ge=Me.getAttribute("data-button-key");J+=Ge+","}),J.length>0&&(J=J.slice(0,-1)));const Se={id:u,name:d,type:newTaskType.value,description:newTaskDescription.value};if(newTaskType.value==="gcode"&&(Se.gcode=newTaskGcode.value,Se.isRepeatable=newTaskGcodeRepeatable.checked),newTaskType.value==="emulation"&&(Se.buttonKeys=J),collectionToSaveTo.value==="new"){const Oe=newCollectionName.value,Me={name:Oe,tasks:[]};Me.tasks.push(Se),localStorage.setItem(`taskCollection_${Oe}`,JSON.stringify(Me));const Ge=document.createElement("option");Ge.value=Oe,Ge.textContent=Oe,availableTaskCollections.appendChild(Ge),s()}else{const Oe=collectionToSaveTo.value,Me=localStorage.getItem(`taskCollection_${Oe}`);if(Me){const Ge=JSON.parse(Me);Ge.tasks.find(Je=>Je.id===u)&&(Ge.tasks=Ge.tasks.filter(Je=>Je.id!==u)),Ge.tasks.push(Se),localStorage.setItem(`taskCollection_${Oe}`,JSON.stringify(Ge))}else{const Ge={name:Oe,tasks:[]};Ge.tasks.push(Se),localStorage.setItem(`taskCollection_${Oe}`,JSON.stringify(Ge))}}h()}),availableTasks.addEventListener("click",d=>{const j=d.target;if(j.matches(".show-info")){const k=j.parentNode.getAttribute("data-task-id");let f=null;const _=localStorage.getItem("selectedTaskCollection"),J=localStorage.getItem(`taskCollection_${_}`);if(J){const Oe=JSON.parse(J).tasks.find(Me=>Me.id===k);Oe&&(f=Oe)}f&&(newTaskModal.style.display="block",newTaskName.value=f.name,newTaskType.value=f.type,newTaskDescription.value=f.description,newTaskGcode.value=f.gcode||"",newTaskGcodeRepeatable.checked=f.isRepeatable||!1,collectionToSaveTo.value=_||"default",taskTextTitle.textContent="Edit Task",f.type==="emulation"?(emulationOuterContainer.style.display="block",gcodeTaskContainer.style.display="none",emulationNewTasksList.innerHTML="",(f.buttonKeys??"").split(",").forEach(Oe=>{const Me=document.createElement("button");Me.classList.add("emulated-button-list"),Me.classList.add("material-symbols-outlined"),Me.setAttribute("data-button-key",Oe),Me.textContent=KeyEmulation.getButtonName(Oe),Me.textContent.length===1&&Me.classList.add("standard-font"),emulationNewTasksList.appendChild(Me)})):f.type==="gcode"?(emulationOuterContainer.style.display="none",gcodeTaskContainer.style.display="block",newTaskGcode.disabled=!1,newTaskGcode.placeholder="Enter gcode here..."):(emulationOuterContainer.style.display="none",gcodeTaskContainer.style.display="none"),k&&newTaskModal.setAttribute("data-task-id",k.toString()))}}),closeTaskModal.onclick=function(){newTaskModal.style.display="none"},completeTaskCloseButton.onclick=function(){completeTaskModal.style.display="none"};function Pe(){if(jobQueue.length===0){completeTaskModal.style.display="block";return}const d=jobQueue.shift();if(d&&d.type==="manual")manualTaskName.textContent=`Task ${d.order}: ${d.name}`,manualTaskInstructions.value=d.description,manualTaskModal.style.display="block",jobQueue.length===0?completeManualTaskButton.innerText="Complete Job":completeManualTaskButton.innerText="Next Task -->";else if(d&&d.type==="gcode"){executeGcodeButton.disabled=!1,executeGcodeButton.classList.remove("disabled-button"),executeGcodeButton.classList.add("interaction-ready-button"),executeGcodeButton.textContent="Execute Gcode",d.isRepeatable?executeGcodeButton.setAttribute("data-repeatable","true"):executeGcodeButton.removeAttribute("data-repeatable"),cncTaskName.textContent=`Task ${d.order}: ${d.name}`,cncTaskGcode.value=d.gcode??"",cncTaskModal.style.display="block",jobQueue.length===0?completeCncTaskButton.innerText="Complete Job":completeCncTaskButton.innerText="Next Task -->";const j=cncTaskModal.querySelector(".task-modal-content");j&&(j.style.backgroundColor=""),completeCncTaskButton.disabled=!0,completeCncTaskButton.style.display="none",cncTaskSenderProgress.style.display="none",cncTaskSenderProgressLabel.style.display="none"}else d&&d.type==="emulation"&&(emulationTaskModal.style.display="block")}cancelManualTaskButton.onclick=function(){manualTaskModal.style.display="none",jobQueue.length=0,jobCancelledModal.style.display="block"},cancelCncTaskButton.onclick=function(){cncTaskModal.style.display="none",jobQueue.length=0,jobCancelledModal.style.display="block",sender$1==null||sender$1.stop()},completeManualTaskButton.onclick=function(){completeManualTaskButton.innerText="Next Task -->",manualTaskModal.style.display="none",Pe()},completeCncTaskButton.onclick=function(){completeCncTaskButton.innerText="Next Task -->",cncTaskModal.style.display="none",Pe()},executeGcodeButton.onclick=function(){sender$1&&sender$1.start(cncTaskGcode.value,SenderClient.PLANNER)},jobCancelledCloseButton.onclick=function(){jobCancelledModal.style.display="none"},executeJobButton.onclick=function(){if(!(sender$1!=null&&sender$1.isConnected())){notConnectedModal.style.display="block";return}tasksToExecute.querySelectorAll(".task-to-execute").forEach(j=>{const u=j.getAttribute("data-task-id"),k=j.getAttribute("data-task-order"),f=j.getAttribute("data-collection-name"),_=localStorage.getItem(`taskCollection_${f}`);let J=null;if(_){const Oe=JSON.parse(_).tasks.find(Me=>Me.id===u);Oe&&(J=Oe)}J&&(J.order=parseInt(k||"0"),jobQueue.push(J))}),Pe()},saveJobButton.onclick=function(){saveJobModal.style.display="block",saveProjectNameSelect.innerHTML="",saveJobGroupNameSelect.innerHTML="",saveJobNameSelect.innerHTML="",saveProjectNameInput.value="",saveJobGroupNameInput.value="",saveJobNameInput.value="";const d=Object.keys(localStorage).filter(f=>f.startsWith("savedProject_")).sort();if(d.length>0){if(d.forEach(f=>{const _=f.replace("savedProject_",""),J=document.createElement("option");J.value=_,J.textContent=_,saveProjectNameSelect.appendChild(J)}),saveProjectNameSelect.selectedIndex>=0){const f=saveProjectNameSelect.value;Fe(f)}}else newProjectNameContainer.style.display="block",newJobGroupNameContainer.style.display="block",newJobNameContainer.style.display="block";const j=document.createElement("option");j.value="new",j.textContent="--new project--",saveProjectNameSelect.appendChild(j);const u=document.createElement("option");u.value="new",u.textContent="--new group--",saveJobGroupNameSelect.appendChild(u);const k=document.createElement("option");k.value="new",k.textContent="--new job--",saveJobNameSelect.appendChild(k)};function Fe(d){saveJobGroupNameSelect.innerHTML="",saveJobNameSelect.innerHTML="";const j=localStorage.getItem(`savedProject_${d}`);if(j){const u=JSON.parse(j);u.groups.forEach(k=>{const f=document.createElement("option");f.value=k.name,f.textContent=k.name,saveJobGroupNameSelect.appendChild(f)}),u.groups.length>0&&u.groups[0].jobs.forEach(k=>{const f=document.createElement("option");f.value=k.name,f.textContent=k.name,saveJobNameSelect.appendChild(f)})}}saveProjectNameSelect.addEventListener("change",()=>{saveProjectNameSelect.value==="new"?(newProjectNameContainer.style.display="block",newJobGroupNameContainer.style.display="block",newJobNameContainer.style.display="block",saveJobGroupNameSelect.innerHTML="",saveJobNameSelect.innerHTML="",saveJobGroupNameInput.value="",saveJobNameInput.value=""):(newProjectNameContainer.style.display="none",newJobGroupNameContainer.style.display="none",newJobNameContainer.style.display="none",Fe(saveProjectNameSelect.value),$(saveProjectNameSelect.value,saveJobGroupNameSelect.value));const d=document.createElement("option");d.value="new",d.textContent="--new group--",saveJobGroupNameSelect.appendChild(d);const j=document.createElement("option");j.value="new",j.textContent="--new job--",saveJobNameSelect.appendChild(j)}),saveJobGroupNameSelect.addEventListener("change",()=>{if(saveJobGroupNameSelect.value==="new"){newJobGroupNameContainer.style.display="block",saveJobNameSelect.innerHTML="",newJobNameContainer.style.display="block";const d=document.createElement("option");d.value="new",d.textContent="--new job--",saveJobNameSelect.appendChild(d)}else{newJobGroupNameContainer.style.display="none";const d=saveProjectNameSelect.value,j=saveJobGroupNameSelect.value;d!=="new"&&$(d,j)}});function $(d,j){saveJobNameSelect.innerHTML="";const u=localStorage.getItem(`savedProject_${d}`);if(u){const f=JSON.parse(u).groups.find(_=>_.name===j);f&&f.jobs.forEach(_=>{const J=document.createElement("option");J.value=_.name,J.textContent=_.name,saveJobNameSelect.appendChild(J)})}}saveJobSaveButton.onclick=function(){let d=saveProjectNameSelect.value==="new"?saveProjectNameInput.value:saveProjectNameSelect.value,j=saveJobGroupNameSelect.value==="new"?saveJobGroupNameInput.value:saveJobGroupNameSelect.value,u=saveJobNameSelect.value==="new"?saveJobNameInput.value:saveJobNameSelect.value;if(d===""||d===null){alert("Please enter a name for the project");return}if(j===""||j===null){alert("Please enter a name for the group");return}if(u===""||u===null){alert("Please enter a name for the job");return}let k=!1;const f=localStorage.getItem(`savedProject_${d}`);if(f){const J=JSON.parse(f).groups.find(Se=>Se.name===j);J&&(k=J.jobs.some(Se=>Se.name===u))}k&&!confirm("A job with this name already exists in this group. Do you want to overwrite it?")||(g(u,j,d),localStorage.setItem("loadedJob",JSON.stringify({name:u,groupName:j,projectName:d})),localStorage.setItem("selectedProject",d),localStorage.setItem("selectedGroup",j),saveJobModal.style.display="none",newProjectNameContainer.style.display="none",newJobGroupNameContainer.style.display="none",newJobNameContainer.style.display="none",saveProjectNameInput.value="",saveJobGroupNameInput.value="",saveJobNameInput.value="",Ke(),n(),i(),alert(`${u} saved`))},newJobButton.onclick=function(){localStorage.setItem("loadedJob",""),localStorage.setItem("currentJob",""),tasksToExecute.innerHTML=""},saveJobModalCloseButton.onclick=function(){saveJobModal.style.display="none"},exportJobModalCloseButton.onclick=function(){exportJobModal.style.display="none"},groupLoadSelect.addEventListener("change",()=>{const d=groupLoadSelect.value;localStorage.setItem("selectedGroup",d),i()}),loadJobButton.onclick=function(){tasksToExecute.innerHTML="";const d=projectLoadSelect.value,j=groupLoadSelect.value,u=jobLoadSelect.value;if(!d||!j||!u){alert("Please select a project, group, and job to load");return}const k=localStorage.getItem(`savedProject_${d}`);if(!k)return;const _=JSON.parse(k).groups.find(Se=>Se.name===j);if(!_)return;const J=_.jobs.find(Se=>Se.name===u);J&&(y(J),localStorage.setItem("selectedProject",d),localStorage.setItem("selectedGroup",j),localStorage.setItem("loadedJob",JSON.stringify({name:u,groupName:j,projectName:d})),Te(),M())},deleteJobButton.onclick=function(){const d=projectLoadSelect.value,j=groupLoadSelect.value,u=jobLoadSelect.value;if(!d||!j||!u){alert("Please select a project, group, and job to delete");return}const k=localStorage.getItem(`savedProject_${d}`);if(!k)return;const f=JSON.parse(k),_=f.groups.findIndex(Se=>Se.name===j);if(_===-1)return;const J=f.groups[_];J.jobs=J.jobs.filter(Se=>Se.name!==u),J.jobs.length===0&&f.groups.splice(_,1),f.groups.length===0?(localStorage.removeItem(`savedProject_${d}`),Ke()):localStorage.setItem(`savedProject_${d}`,JSON.stringify(f)),n(),i(),tasksToExecute.innerHTML=""},importJobButton.onclick=function(){const d=document.createElement("input");d.type="file",d.accept=".json",d.multiple=!0,d.onchange=function(j){const u=j.target.files;if(u){tasksToExecute.innerHTML="";const k=Array.from(u).map(f=>new Promise((_,J)=>{const Se=new FileReader;Se.onload=function(Oe){var Ge;const Me=(Ge=Oe.target)==null?void 0:Ge.result;if(Me)try{const He=JSON.parse(Me);let Je,Qe,rt;He.projectName?(Je=He,Qe=Je.projectName,rt=Je.groupName):(Je=He,Qe="Imported",rt=Je.groupName||"Legacy",Je.projectName=Qe);let st=localStorage.getItem(`savedProject_${Qe}`),et;st?et=JSON.parse(st):et={name:Qe,groups:[]};let nt=et.groups.find(it=>it.name===rt);nt||(nt={name:rt,jobs:[]},et.groups.push(nt));const lt=nt.jobs.findIndex(it=>it.name===Je.name);if(lt!==-1){if(!confirm(`A job with name "${Je.name}" already exists in project "${Qe}", group "${rt}". Do you want to overwrite it?`)){_({job:Je,projectName:Qe});return}nt.jobs[lt]=Je}else nt.jobs.push(Je);setItemAndSyncToGoogleDrive(`savedProject_${Qe}`,JSON.stringify(et)),localStorage.setItem("selectedProject",Qe),localStorage.setItem("selectedGroup",rt),localStorage.setItem("loadedJob",JSON.stringify({name:Je.name,groupName:rt,projectName:Qe})),_({job:Je,projectName:Qe})}catch{J(new Error("Invalid JSON format"))}else J(new Error("No contents"))},Se.readAsText(f)}));Promise.all(k).then(f=>{if(f.length>0){const[_]=f;h(),Ke(),projectLoadSelect&&_&&(projectLoadSelect.value=_.projectName),n(),i(),_&&_.job&&(y(_.job),M(),Te())}}).catch(f=>{console.error("Error importing job:",f),alert("Error importing job: "+f.message)})}},d.click()},exportJobButton.onclick=function(){exportJobGroupNameSelect.innerHTML="",exportJobNameSelect.innerHTML="",exportJobProjectNameSelect.innerHTML="";const d=Object.keys(localStorage).filter(f=>f.startsWith("savedProject_")).sort();if(d.length>0)d.forEach(f=>{const _=f.replace("savedProject_",""),J=document.createElement("option");J.value=_,J.textContent=_,exportJobProjectNameSelect.appendChild(J)});else{alert("No projects found. Please create a project first.");return}const j=localStorage.getItem("selectedProject"),u=localStorage.getItem("selectedGroup"),k=localStorage.getItem("loadedJob");if(j&&(exportJobProjectNameSelect.value=j),u){const f=localStorage.getItem(`savedProject_${j}`);f&&JSON.parse(f).groups.forEach(J=>{const Se=document.createElement("option");Se.value=J.name,Se.textContent=J.name,exportJobGroupNameSelect.appendChild(Se)}),exportJobGroupNameSelect.value=u}if(k){const f=JSON.parse(k),_=document.createElement("option");_.value=f.name,_.textContent=f.name,exportJobNameSelect.appendChild(_),exportJobNameSelect.value=f.name}exportJobModal.style.display="block"},exportJobProjectNameSelect.addEventListener("change",()=>{const d=exportJobProjectNameSelect.value;localStorage.setItem("selectedProject",d),exportJobGroupNameSelect.innerHTML="",exportJobNameSelect.innerHTML="",Ne()}),exportJobGroupNameSelect.addEventListener("change",()=>{Xe()});function Ne(){const d=exportJobProjectNameSelect.value,j=localStorage.getItem(`savedProject_${d}`);if(j){const u=JSON.parse(j);exportJobGroupNameSelect.innerHTML="",u.groups.forEach(k=>{const f=document.createElement("option");f.value=k.name,f.textContent=k.name,exportJobGroupNameSelect.appendChild(f)})}}function Xe(){const d=exportJobGroupNameSelect.value,j=exportJobProjectNameSelect.value,u=localStorage.getItem(`savedProject_${j}`),k=u?JSON.parse(u).groups.find(f=>f.name===d):null;k&&(exportJobNameSelect.innerHTML="",k.jobs.forEach(f=>{const _=document.createElement("option");_.value=f.name,_.textContent=f.name,exportJobNameSelect.appendChild(_)}))}exportJobSaveButton.onclick=function(){const d=exportJobProjectNameSelect.value,j=exportJobGroupNameSelect.value,u=exportJobNameSelect.value,k=localStorage.getItem(`savedProject_${d}`);if(!k)return;const _=JSON.parse(k).groups.find(Se=>Se.name===j);if(!_)return;const J=_.jobs.find(Se=>Se.name===u);if(J&&J){const Se=J.tasks,Oe={name:J.name,projectName:d,groupName:j,tasks:[]};Se.forEach(Je=>{const Qe=localStorage.getItem(`taskCollection_${Je.collectionName}`);if(Qe){const st=JSON.parse(Qe).tasks.find(et=>et.id===Je.id);st&&Oe.tasks.push({id:st.id,collectionName:Je.collectionName})}});const Me=new Blob([JSON.stringify(Oe,null,2)],{type:"application/json"}),Ge=URL.createObjectURL(Me),He=document.createElement("a");He.href=Ge,He.download=`${Oe.name}.json`,He.click(),URL.revokeObjectURL(Ge),exportJobModal.style.display="none"}};function Ke(){if(!projectLoadSelect)return;projectLoadSelect.innerHTML="";const d=Object.keys(localStorage).filter(u=>u.startsWith("savedProject_")).sort();d.forEach(u=>{const k=u.replace("savedProject_",""),f=document.createElement("option");f.value=k,f.textContent=k,projectLoadSelect.appendChild(f)});const j=localStorage.getItem("selectedProject");j&&d.includes(`savedProject_${j}`)&&(projectLoadSelect.value=j)}projectLoadSelect&&projectLoadSelect.addEventListener("change",()=>{const d=projectLoadSelect.value;localStorage.setItem("selectedProject",d),n(),i()}),initializeGoogleDriveAPI();const We=document.getElementById("googleSignInButton");We&&We.addEventListener("click",()=>{signInToGoogle().then(()=>{alert("Signed in to Google Drive")}).catch(d=>{console.error("Error signing in to Google Drive:",d)})})});const Ye=class Ye{static createThreadSpec(n,o,i,s){return{name:n,nominalDiameter:o,pitch:i,isCoarse:s,getInternalMinorDiameter(){return Number((this.nominalDiameter-1.082532*this.pitch).toFixed(3))},getMajorDiameter(){return this.nominalDiameter},getThreadDepth(r){return Number(r==="External"?(this.pitch*.61343).toFixed(3):(this.pitch*.54127).toFixed(3))},getMinorDiameter(r){return r==="External"?this.nominalDiameter-2*this.getThreadDepth(r):this.getInternalMinorDiameter()}}}static generateThreadingGcode(n,o,i,s,r){const l=n.getMajorDiameter(),p=n.getMinorDiameter(o);let c,g;return o==="External"?(c=l/2,g=p/2):(c=p/2-.1,g=l/2),c=Math.round(c*1e3)/1e3,g=Math.round(g*1e3)/1e3,`G33 Z${i==="Right"?s:-s} X${-g} P${n.pitch} H${r} R${-c}`}static getThreadSpecByName(n){for(const o of this.threadTypes){const i=o.threads.find(s=>s.name===n);if(i)return i}}static getThreadGroups(){return this.threadTypes.map(n=>n.name)}static getThreadsForGroup(n){const o=this.threadTypes.find(i=>i.name===n);return o?o.threads:[]}};De(Ye,"threadTypes",[{name:"Metric",threads:[Ye.createThreadSpec("M3 x 0.35 (Fine)",3,.35,!1),Ye.createThreadSpec("M3 x 0.5 (Coarse)",3,.5,!0),Ye.createThreadSpec("M4 x 0.5 (Fine)",4,.5,!1),Ye.createThreadSpec("M4 x 0.7 (Coarse)",4,.7,!0),Ye.createThreadSpec("M5 x 0.5 (Fine)",5,.5,!1),Ye.createThreadSpec("M5 x 0.8 (Coarse)",5,.8,!0),Ye.createThreadSpec("M6 x 0.75 (Fine)",6,.75,!1),Ye.createThreadSpec("M6 x 1.0 (Coarse)",6,1,!0),Ye.createThreadSpec("M8 x 1.0 (Fine)",8,1,!1),Ye.createThreadSpec("M8 x 1.25 (Coarse)",8,1.25,!0),Ye.createThreadSpec("M10 x 1.0 (Fine)",10,1,!1),Ye.createThreadSpec("M10 x 1.5 (Coarse)",10,1.5,!0),Ye.createThreadSpec("M11 x 1.0 (Fine)",11,1,!1),Ye.createThreadSpec("M11 x 1.5 (Coarse)",11,1.5,!0),Ye.createThreadSpec("M12 x 1.25 (Fine)",12,1.25,!1),Ye.createThreadSpec("M12 x 1.75 (Coarse)",12,1.75,!0)]}]);let Threading=Ye,sender,minimumVersion="H4V12FJ";const quickTaskConfig={quickTaskFacing:{openButton:document.getElementById("quickTaskFacingButton"),modal:document.getElementById("quickTaskFacingModal"),closeButton:document.getElementById("quickTaskFacingCloseButton"),executeButton:document.getElementById("quickTaskFacingExecuteButton"),stopButton:document.getElementById("quickTaskFacingStopButton"),progressBar:document.getElementById("quickTaskFacingProgressBar"),taskFunction:facingTask},quickTaskGrooving:{openButton:document.getElementById("quickTaskGroovingButton"),modal:document.getElementById("quickTaskGroovingModal"),closeButton:document.getElementById("quickTaskGroovingCloseButton"),executeButton:document.getElementById("quickTaskGroovingExecuteButton"),stopButton:document.getElementById("quickTaskGroovingStopButton"),progressBar:document.getElementById("quickTaskGroovingProgressBar"),taskFunction:groovingTask},quickTaskProfiling:{openButton:document.getElementById("quickTaskProfilingButton"),modal:document.getElementById("quickTaskProfilingModal"),closeButton:document.getElementById("quickTaskProfilingCloseButton"),executeButton:document.getElementById("quickTaskProfilingExecuteButton"),stopButton:document.getElementById("quickTaskProfilingStopButton"),progressBar:document.getElementById("quickTaskProfilingProgressBar"),taskFunction:profilingTask},quickTaskDrilling:{openButton:document.getElementById("quickTaskDrillingButton"),modal:document.getElementById("quickTaskDrillingModal"),closeButton:document.getElementById("quickTaskDrillingCloseButton"),executeButton:document.getElementById("quickTaskDrillingExecuteButton"),stopButton:document.getElementById("quickTaskDrillingStopButton"),progressBar:document.getElementById("quickTaskDrillingProgressBar"),taskFunction:drillingTask},quickTaskCone:{openButton:document.getElementById("quickTaskConeButton"),modal:document.getElementById("quickTaskConeModal"),closeButton:document.getElementById("quickTaskConeCloseButton"),executeButton:document.getElementById("quickTaskConeExecuteButton"),stopButton:document.getElementById("quickTaskConeStopButton"),progressBar:document.getElementById("quickTaskConeProgressBar"),taskFunction:coneTask},quickTaskBoring:{openButton:document.getElementById("quickTaskBoringButton"),modal:document.getElementById("quickTaskBoringModal"),closeButton:document.getElementById("quickTaskBoringCloseButton"),executeButton:document.getElementById("quickTaskBoringExecuteButton"),stopButton:document.getElementById("quickTaskBoringStopButton"),progressBar:document.getElementById("quickTaskBoringProgressBar"),taskFunction:boringTask},quickTaskThreading:{openButton:document.getElementById("quickTaskThreadingButton"),modal:document.getElementById("quickTaskThreadingModal"),closeButton:document.getElementById("quickTaskThreadingCloseButton"),executeButton:document.getElementById("quickTaskThreadingExecuteButton"),stopButton:document.getElementById("quickTaskThreadingStopButton"),progressBar:document.getElementById("quickTaskThreadingProgressBar"),taskFunction:threadingTask},quickTaskToolOffsets:{openButton:document.getElementById("quickTaskToolOffsetsButton"),modal:document.getElementById("quickTaskToolOffsetsModal"),closeButton:document.getElementById("quickTaskToolOffsetsCloseButton"),executeButton:document.getElementById("quickTaskToolOffsetsExecuteButton"),stopButton:document.getElementById("quickTaskToolOffsetsStopButton"),progressBar:document.getElementById("quickTaskToolOffsetsProgressBar"),taskFunction:toolOffsetsTask}},quickTaskFacingTravelFeedRate=document.getElementById("quickTaskFacingTravelFeedRate"),quickTaskFacingEndDiameter=document.getElementById("quickTaskFacingEndDiameter"),quickTaskFacingFeedrate=document.getElementById("quickTaskFacingFeedrate"),quickTaskFacingCopyToClipboardButton=document.getElementById("quickTaskFacingCopyToClipboardButton"),quickTaskFacingUsePecking=document.getElementById("quickTaskFacingUsePecking"),quickTaskFacingPeckingDepth=document.getElementById("quickTaskFacingPeckingDepth"),quickTaskFacingPeckingDepthContainer=document.getElementById("quickTaskFacingPeckingDepthContainer"),quickTaskFacingPeckingRetractionRate=document.getElementById("quickTaskFacingPeckingRetractionRate"),quickTaskFacingCurrentPosition=document.getElementById("quickTaskFacingCurrentPosition"),quickTaskFacingRefreshPositionButton=document.getElementById("quickTaskFacingRefreshPositionButton"),quickTaskFacingXStartPosition=document.getElementById("quickTaskFacingXStartPosition"),quickTaskFacingZStartPosition=document.getElementById("quickTaskFacingZStartPosition"),quickTaskProfilingFinalDiameter=document.getElementById("quickTaskProfilingFinalDiameter"),quickTaskProfilingDepth=document.getElementById("quickTaskProfilingDepth"),quickTaskProfilingFeedRate=document.getElementById("quickTaskProfilingFeedRate"),quickTaskProfilingRetractFeedRate=document.getElementById("quickTaskProfilingRetractFeedRate"),quickTaskProfilingDepthPerPass=document.getElementById("quickTaskProfilingDepthPerPass"),quickTaskProfilingFinishingDepth=document.getElementById("quickTaskProfilingFinishingDepth"),quickTaskProfilingPasses=document.getElementById("quickTaskProfilingPasses"),quickTaskProfilingType=document.getElementById("quickTaskProfilingType"),quickTaskProfilingFinalDiameterContainer=document.getElementById("quickTaskProfilingFinalDiameterContainer"),quickTaskProfilingDepthContainer=document.getElementById("quickTaskProfilingDepthContainer"),quickTaskProfilingCopyToClipboardButton=document.getElementById("quickTaskProfilingCopyToClipboardButton"),quickTaskProfilingRefreshPositionButton=document.getElementById("quickTaskProfilingRefreshPositionButton"),quickTaskProfilingCurrentPosition=document.getElementById("quickTaskProfilingCurrentPosition"),quickTaskProfilingXStartPosition=document.getElementById("quickTaskProfilingXStartPosition"),quickTaskProfilingZStartPosition=document.getElementById("quickTaskProfilingZStartPosition"),quickTaskDrillingDepth=document.getElementById("quickTaskDrillingDepth"),quickTaskDrillingFeedRate=document.getElementById("quickTaskDrillingFeedRate"),quickTaskDrillingRetractFeedRate=document.getElementById("quickTaskDrillingRetractFeedRate"),quickTaskDrillingPeckCheckbox=document.getElementById("quickTaskDrillingPeckCheckbox"),quickTaskDrillingPeckingDepthContainer=document.getElementById("quickTaskDrillingPeckingDepthContainer"),quickTaskDrillingPeckingDepth=document.getElementById("quickTaskDrillingPeckingDepth"),quickTaskDrillingCopyToClipboardButton=document.getElementById("quickTaskDrillingCopyToClipboardButton"),quickTaskDrillingCurrentPosition=document.getElementById("quickTaskDrillingCurrentPosition"),quickTaskDrillingRefreshPositionButton=document.getElementById("quickTaskDrillingRefreshPositionButton"),quickTaskDrillingZStartPosition=document.getElementById("quickTaskDrillingZStartPosition"),quickTaskThreadingType=document.getElementById("quickTaskThreadingType"),quickTaskThreadingSize=document.getElementById("quickTaskThreadingSize"),quickTaskThreadingDirection=document.getElementById("quickTaskThreadingDirection"),quickTaskThreadingExternalOrInternal=document.getElementById("quickTaskThreadingExternalOrInternal"),quickTaskThreadingLength=document.getElementById("quickTaskThreadingLength"),quickTaskThreadingPasses=document.getElementById("quickTaskThreadingPasses"),quickTaskThreadingCopyToClipboardButton=document.getElementById("quickTaskThreadingCopyToClipboardButton"),quickTaskBoringDepth=document.getElementById("quickTaskBoringDepth"),quickTaskBoringDepthOfCut=document.getElementById("quickTaskBoringDepthOfCut"),quickTaskBoringFeedRate=document.getElementById("quickTaskBoringFeedRate"),quickTaskBoringRetractFeedRate=document.getElementById("quickTaskBoringRetractFeedRate"),quickTaskBoringType=document.getElementById("quickTaskBoringType"),quickTaskBoringFinalDiameterContainer=document.getElementById("quickTaskBoringFinalDiameterContainer"),quickTaskBoringDepthOfCutContainer=document.getElementById("quickTaskBoringDepthOfCutContainer"),quickTaskBoringFinalDiameter=document.getElementById("quickTaskBoringFinalDiameter"),quickTaskBoringDepthPerPass=document.getElementById("quickTaskBoringDepthPerPass"),quickTaskBoringFinishingDepth=document.getElementById("quickTaskBoringFinishingDepth"),quickTaskBoringPasses=document.getElementById("quickTaskBoringPasses"),quickTaskBoringCopyToClipboardButton=document.getElementById("quickTaskBoringCopyToClipboardButton"),quickTaskBoringRefreshPositionButton=document.getElementById("quickTaskBoringRefreshPositionButton"),quickTaskBoringCurrentPosition=document.getElementById("quickTaskBoringCurrentPosition"),quickTaskBoringXStartPosition=document.getElementById("quickTaskBoringXStartPosition"),quickTaskBoringZStartPosition=document.getElementById("quickTaskBoringZStartPosition"),quickTaskToolOffsetsProbeDiameter=document.getElementById("quickTaskToolOffsetsProbeDiameter"),quickTaskToolOffsetsToolNumber=document.getElementById("quickTaskToolOffsetsToolNumber"),quickTaskToolOffsetsToolType=document.getElementById("quickTaskToolOffsetsToolType"),quickTaskToolOffsetsOffsetX=document.getElementById("quickTaskToolOffsetsOffsetX"),quickTaskToolOffsetsOffsetZ=document.getElementById("quickTaskToolOffsetsOffsetZ");document.addEventListener("DOMContentLoaded",()=>{let e;sender=Sender.getInstance(),sender.addStatusChangeListener(()=>j(),SenderClient.QUICKTASKS);const n=document.getElementById("connectButton"),o=u=>u.replace("toolOffsets:","").replace("ok","").split("|").map(_=>{const J=_.match(/T(\d+)/),Se=J?parseInt(J[1]):0,Oe=_.match(/Z=(-?\d+\.?\d*)/),Me=_.match(/X=(-?\d+\.?\d*)/),Ge=_.match(/W=(-?\d+\.?\d*)/),He=_.match(/U=(-?\d+\.?\d*)/);return{tool:Se,z:Oe?parseFloat(Oe[1]):0,x:Me?parseFloat(Me[1]):0,w:Ge?parseFloat(Ge[1]):0,u:He?parseFloat(He[1]):0}}).filter(_=>!isNaN(_.tool));Object.keys(quickTaskConfig).forEach(u=>{const k=quickTaskConfig[u];quickTaskConfig[u].openButton.addEventListener("click",async()=>{if(!(sender!=null&&sender.isConnected()))alert("Please connect to the machine first");else{if(e=k,u==="quickTaskCone"||u==="quickTaskGrooving"?alert("Not Yet Implemented, coming soon!"):k.modal.style.display="block",u==="quickTaskProfiling"){const _=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),J=_==null?void 0:_.x,Se=_==null?void 0:_.z;quickTaskProfilingCurrentPosition.value=`X: ${J.toFixed(3)} Z: ${Se.toFixed(3)}`,quickTaskProfilingXStartPosition.value=J.toFixed(3),quickTaskProfilingZStartPosition.value=Se.toFixed(3)}if(u==="quickTaskFacing"){const _=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),J=_==null?void 0:_.x,Se=_==null?void 0:_.z;quickTaskFacingCurrentPosition.value=`X: ${J.toFixed(3)} Z: ${Se.toFixed(3)}`,quickTaskFacingXStartPosition.value=J.toFixed(3),quickTaskFacingZStartPosition.value=Se.toFixed(3)}if(u==="quickTaskBoring"){const _=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),J=_==null?void 0:_.x,Se=_==null?void 0:_.z;quickTaskBoringCurrentPosition.value=`X: ${J.toFixed(3)} Z: ${Se.toFixed(3)}`,quickTaskBoringXStartPosition.value=J.toFixed(3),quickTaskBoringZStartPosition.value=Se.toFixed(3)}if(u==="quickTaskDrilling"){const _=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),J=_==null?void 0:_.x,Se=_==null?void 0:_.z;quickTaskDrillingCurrentPosition.value=`X: ${J.toFixed(3)} Z: ${Se.toFixed(3)}`,quickTaskDrillingZStartPosition.value=Se.toFixed(3)}if(u==="quickTaskToolOffsets"){const _=await sender.getToolOffsets(SenderClient.GCODE),J=o(_);if(quickTaskToolOffsetsToolNumber.innerHTML="",J.length>0){for(let Se=1;Se<=J.length-1;Se++){const Oe=document.createElement("option");Oe.value=`T${Se}`,Oe.textContent=`T${Se}`,quickTaskToolOffsetsToolNumber.appendChild(Oe)}quickTaskToolOffsetsToolNumber.value="T1"}}}}),k.executeButton.addEventListener("click",()=>{k.taskFunction()}),k.stopButton.addEventListener("click",()=>{sender==null||sender.stop()}),k.closeButton.addEventListener("click",()=>{k.modal.style.display="none"})});const i=()=>{(quickTaskProfilingDepth.value||quickTaskBoringFinalDiameter)&&quickTaskProfilingFeedRate.value&&quickTaskProfilingRetractFeedRate.value&&quickTaskProfilingPasses.value&&quickTaskProfilingDepthPerPass.value&&quickTaskProfilingFinishingDepth.value?(e.executeButton.disabled=!1,e.executeButton.classList.remove("disabled-button"),e.executeButton.classList.add("interaction-ready-button"),quickTaskProfilingCopyToClipboardButton.disabled=!1,quickTaskProfilingCopyToClipboardButton.classList.remove("disabled-button"),quickTaskProfilingCopyToClipboardButton.classList.add("interaction-ready-button")):(e.executeButton.disabled=!0,e.executeButton.classList.add("disabled-button"),e.executeButton.classList.remove("interaction-ready-button"),quickTaskProfilingCopyToClipboardButton.disabled=!0,quickTaskProfilingCopyToClipboardButton.classList.add("disabled-button"),quickTaskProfilingCopyToClipboardButton.classList.remove("interaction-ready-button"))};quickTaskProfilingRefreshPositionButton.addEventListener("click",async()=>{const u=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),k=u==null?void 0:u.x,f=u==null?void 0:u.z;quickTaskProfilingCurrentPosition.value=`X: ${k.toFixed(3)} Z: ${f.toFixed(3)}`,quickTaskProfilingXStartPosition.value=k.toFixed(3),quickTaskProfilingZStartPosition.value=f.toFixed(3)}),quickTaskProfilingType.addEventListener("change",()=>{quickTaskProfilingType.value==="Absolute"?(quickTaskProfilingDepthContainer.style.display="none",quickTaskProfilingFinalDiameterContainer.style.display="block"):(quickTaskProfilingDepthContainer.style.display="block",quickTaskProfilingFinalDiameterContainer.style.display="none"),updateProfilingPassesFromDepthPerPass(),updateProfilingDepthPerPassFromPasses(),i()}),quickTaskProfilingFinalDiameter.addEventListener("input",()=>{updateProfilingPassesFromDepthPerPass(),updateProfilingDepthPerPassFromPasses(),i()}),quickTaskProfilingDepth.addEventListener("input",()=>{updateProfilingPassesFromDepthPerPass(),updateProfilingDepthPerPassFromPasses(),i()}),quickTaskProfilingPasses.addEventListener("input",()=>{updateProfilingDepthPerPassFromPasses(),i()}),quickTaskProfilingDepthPerPass.addEventListener("input",()=>{updateProfilingPassesFromDepthPerPass(),i()}),quickTaskProfilingFinishingDepth.addEventListener("input",()=>{updateProfilingPassesFromDepthPerPass(),updateProfilingDepthPerPassFromPasses(),i()}),quickTaskProfilingCopyToClipboardButton.addEventListener("click",()=>profilingTask(!0));const s=()=>{quickTaskFacingEndDiameter.value&&Number(quickTaskFacingFeedrate.value)>0?(e.executeButton.disabled=!1,e.executeButton.classList.remove("disabled-button"),e.executeButton.classList.add("interaction-ready-button"),quickTaskFacingCopyToClipboardButton.disabled=!1,quickTaskFacingCopyToClipboardButton.classList.remove("disabled-button"),quickTaskFacingCopyToClipboardButton.classList.add("interaction-ready-button")):(e.executeButton.disabled=!0,e.executeButton.classList.add("disabled-button"),e.executeButton.classList.remove("interaction-ready-button"),quickTaskFacingCopyToClipboardButton.disabled=!0,quickTaskFacingCopyToClipboardButton.classList.add("disabled-button"),quickTaskFacingCopyToClipboardButton.classList.remove("interaction-ready-button"))};quickTaskFacingRefreshPositionButton.addEventListener("click",async()=>{const u=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),k=u==null?void 0:u.x,f=u==null?void 0:u.z;quickTaskFacingCurrentPosition.value=`X: ${k.toFixed(3)} Z: ${f.toFixed(3)}`}),quickTaskFacingEndDiameter.addEventListener("input",s),quickTaskFacingFeedrate.addEventListener("input",s),quickTaskFacingTravelFeedRate.addEventListener("input",s),quickTaskFacingCopyToClipboardButton.addEventListener("click",()=>facingTask(!0)),quickTaskFacingPeckingDepth.addEventListener("input",s),quickTaskFacingPeckingRetractionRate.addEventListener("input",s),quickTaskFacingUsePecking.addEventListener("change",()=>{quickTaskFacingUsePecking.checked?quickTaskFacingPeckingDepthContainer.style.display="block":quickTaskFacingPeckingDepthContainer.style.display="none"});const r=localStorage.getItem("facingFeedrate");r!==null&&(quickTaskFacingFeedrate.value=r);const l=localStorage.getItem("facingEndDiameter");l!==null&&(quickTaskFacingEndDiameter.value=l);const p=localStorage.getItem("facingTravelFeedRate");p!==null&&(quickTaskFacingTravelFeedRate.value=p);const c=localStorage.getItem("facingPeckingDepth");c!==null&&(quickTaskFacingPeckingDepth.value=c);const g=localStorage.getItem("facingPeckingRetractionRate");g!==null&&(quickTaskFacingPeckingRetractionRate.value=g);const y=localStorage.getItem("facingUsePecking");y!==null&&(quickTaskFacingUsePecking.checked=y==="true",quickTaskFacingPeckingDepthContainer.style.display=quickTaskFacingUsePecking.checked?"block":"none");const M=()=>{const u=quickTaskBoringType.value,k=quickTaskBoringDepth.value&&quickTaskBoringFeedRate.value&&quickTaskBoringRetractFeedRate.value&&quickTaskBoringPasses.value&&quickTaskBoringFinishingDepth.value;let f=!1;u==="Absolute"?f=!!quickTaskBoringFinalDiameter.value:f=!!quickTaskBoringDepthOfCut.value,k&&f?(e.executeButton.disabled=!1,e.executeButton.classList.remove("disabled-button"),e.executeButton.classList.add("interaction-ready-button"),quickTaskBoringCopyToClipboardButton.disabled=!1,quickTaskBoringCopyToClipboardButton.classList.remove("disabled-button"),quickTaskBoringCopyToClipboardButton.classList.add("interaction-ready-button")):(e.executeButton.disabled=!0,e.executeButton.classList.add("disabled-button"),e.executeButton.classList.remove("interaction-ready-button"),quickTaskBoringCopyToClipboardButton.disabled=!0,quickTaskBoringCopyToClipboardButton.classList.add("disabled-button"),quickTaskBoringCopyToClipboardButton.classList.remove("interaction-ready-button"))};quickTaskBoringRefreshPositionButton.addEventListener("click",async()=>{const u=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),k=u==null?void 0:u.x,f=u==null?void 0:u.z;quickTaskBoringCurrentPosition.value=`X: ${k.toFixed(3)} Z: ${f.toFixed(3)}`,quickTaskBoringXStartPosition.value=k.toFixed(3),quickTaskBoringZStartPosition.value=f.toFixed(3)}),quickTaskBoringDepth.addEventListener("input",M),quickTaskBoringFeedRate.addEventListener("input",M),quickTaskBoringRetractFeedRate.addEventListener("input",M),quickTaskBoringRefreshPositionButton.addEventListener("click",async()=>{const u=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),k=u==null?void 0:u.x,f=u==null?void 0:u.z;quickTaskBoringCurrentPosition.value=`X: ${k.toFixed(3)} Z: ${f.toFixed(3)}`}),quickTaskBoringType.addEventListener("change",()=>{quickTaskBoringType.value==="Absolute"?(quickTaskBoringFinalDiameterContainer.style.display="block",quickTaskBoringDepthOfCutContainer.style.display="none"):(quickTaskBoringFinalDiameterContainer.style.display="none",quickTaskBoringDepthOfCutContainer.style.display="block"),updatePassesFromDepthPerPass(),updateDepthPerPassFromPasses(),M()}),quickTaskBoringFinalDiameter.addEventListener("input",()=>{updatePassesFromDepthPerPass(),updateDepthPerPassFromPasses(),M()}),quickTaskBoringDepthOfCut.addEventListener("input",()=>{updatePassesFromDepthPerPass(),updateDepthPerPassFromPasses(),M()}),quickTaskBoringPasses.addEventListener("input",()=>{updateDepthPerPassFromPasses(),M()}),quickTaskBoringDepthPerPass.addEventListener("input",()=>{updatePassesFromDepthPerPass(),M()}),quickTaskBoringFinishingDepth.addEventListener("input",()=>{updatePassesFromDepthPerPass(),updateDepthPerPassFromPasses(),M()}),quickTaskBoringCopyToClipboardButton.addEventListener("click",()=>boringTask(!0)),quickTaskDrillingPeckCheckbox.addEventListener("change",()=>{quickTaskDrillingPeckCheckbox.checked?quickTaskDrillingPeckingDepthContainer.style.display="block":quickTaskDrillingPeckingDepthContainer.style.display="none"});const h=()=>{quickTaskDrillingDepth.value&&quickTaskDrillingFeedRate.value&&quickTaskDrillingRetractFeedRate.value?(e.executeButton.disabled=!1,e.executeButton.classList.remove("disabled-button"),e.executeButton.classList.add("interaction-ready-button"),quickTaskDrillingCopyToClipboardButton.disabled=!1,quickTaskDrillingCopyToClipboardButton.classList.remove("disabled-button"),quickTaskDrillingCopyToClipboardButton.classList.add("interaction-ready-button")):(e.executeButton.disabled=!0,e.executeButton.classList.add("disabled-button"),e.executeButton.classList.remove("interaction-ready-button"),quickTaskDrillingCopyToClipboardButton.disabled=!0,quickTaskDrillingCopyToClipboardButton.classList.add("disabled-button"),quickTaskDrillingCopyToClipboardButton.classList.remove("interaction-ready-button"))};quickTaskDrillingRefreshPositionButton.addEventListener("click",async()=>{const u=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),k=u==null?void 0:u.x,f=u==null?void 0:u.z;quickTaskDrillingCurrentPosition.value=`X: ${k.toFixed(3)} Z: ${f.toFixed(3)}`,quickTaskDrillingZStartPosition.value=f.toFixed(3)}),quickTaskDrillingDepth.addEventListener("input",h),quickTaskDrillingFeedRate.addEventListener("input",h),quickTaskDrillingRetractFeedRate.addEventListener("input",h),quickTaskDrillingCopyToClipboardButton.addEventListener("click",()=>drillingTask(!0)),quickTaskThreadingSize.addEventListener("change",()=>{const u=Threading.getThreadSpecByName(quickTaskThreadingSize.value),k=quickTaskThreadingExternalOrInternal.value,f=u.getThreadDepth(k),_=Math.ceil(f/.1)+1;quickTaskThreadingPasses.value=_.toString()});const Te=()=>{const u=quickTaskThreadingType.value,k=Threading.getThreadsForGroup(u);quickTaskThreadingSize.innerHTML='<option value="">Select Thread Size</option>',k.length>0?(k.sort((f,_)=>f.nominalDiameter!==_.nominalDiameter?f.nominalDiameter-_.nominalDiameter:f.pitch-_.pitch).forEach(f=>{const _=document.createElement("option");_.value=f.name,_.textContent=f.name,quickTaskThreadingSize.appendChild(_)}),quickTaskThreadingSize.disabled=!1):quickTaskThreadingSize.disabled=!0},Pe=()=>{quickTaskThreadingSize.value&&quickTaskThreadingLength.value&&quickTaskThreadingPasses.value?(e.executeButton.disabled=!1,e.executeButton.classList.remove("disabled-button"),e.executeButton.classList.add("interaction-ready-button"),quickTaskThreadingCopyToClipboardButton.disabled=!1,quickTaskThreadingCopyToClipboardButton.classList.remove("disabled-button"),quickTaskThreadingCopyToClipboardButton.classList.add("interaction-ready-button")):(quickTaskThreadingCopyToClipboardButton.disabled=!0,quickTaskThreadingCopyToClipboardButton.classList.add("disabled-button"),quickTaskThreadingCopyToClipboardButton.classList.remove("interaction-ready-button"),e.executeButton.disabled=!0,e.executeButton.classList.add("disabled-button"),e.executeButton.classList.remove("interaction-ready-button"))};quickTaskThreadingSize.addEventListener("change",Pe),quickTaskThreadingLength.addEventListener("input",Pe),quickTaskThreadingPasses.addEventListener("input",Pe),quickTaskThreadingType.addEventListener("change",Te),quickTaskThreadingCopyToClipboardButton.addEventListener("click",()=>threadingTask(!0)),Te();const Fe=localStorage.getItem("probeDiameter");Fe!==null&&(quickTaskToolOffsetsProbeDiameter.value=Fe);const $=localStorage.getItem("drillingRetractFeedRate");$!==null&&(quickTaskDrillingRetractFeedRate.value=$);const Ne=localStorage.getItem("boringRetractFeedrate");Ne!==null&&(quickTaskBoringRetractFeedRate.value=Ne);const Xe=localStorage.getItem("profilingRetractFeedrate");Xe!==null&&(quickTaskProfilingRetractFeedRate.value=Xe);const Ke=localStorage.getItem("drillingFeedRate");Ke!==null&&(quickTaskDrillingFeedRate.value=Ke);const We=localStorage.getItem("boringFeedRate");We!==null&&(quickTaskBoringFeedRate.value=We);const d=localStorage.getItem("profilingFeedRate");d!==null&&(quickTaskProfilingFeedRate.value=d);function j(){if(!sender)return;const u=sender.getStatus();if(u.isConnected===!1){n.innerText="Connect",n.disabled=!1,n.style.backgroundColor="";return}else n.innerText="Connected",n.disabled=!0,n.style.backgroundColor="green";const k=u.condition==="run";if(!k)e.executeButton.style.display="flex",e.stopButton.style.display="none",e.progressBar.value=0,e.progressBar.parentElement.style.display="none";else if(k){e.executeButton.style.display="none",e.stopButton.style.display="inline-block",e.progressBar.parentElement.style.display="block";const f=u.progress;e.progressBar.value=f}}});async function profilingTask(e=!1){const n=parseFloat(quickTaskProfilingXStartPosition.value),o=parseFloat(quickTaskProfilingZStartPosition.value);if(isNaN(n)||isNaN(o)){alert("Please enter a valid starting position");return}const i=Number(parseFloat(document.getElementById("quickTaskProfilingLength").value).toFixed(3)),s=parseInt(quickTaskProfilingPasses.value,10),r=Number(parseFloat(quickTaskProfilingFeedRate.value).toFixed(3)),l=Number(parseFloat(quickTaskProfilingRetractFeedRate.value).toFixed(3)),p=quickTaskProfilingType.value;localStorage.setItem("profilingRetractFeedrate",l.toString()),localStorage.setItem("profilingFeedRate",r.toString());const c=[];c.push("G90"),c.push(`G0 X${n} Z${o} F${l} ; move to start position`),c.push("G91");let g=0,y=0;p==="Absolute"?(g=-Number(parseFloat(quickTaskProfilingFinalDiameter.value).toFixed(3))/2,y=Math.abs(g-n),y=Number(y.toFixed(3))):y=Number(parseFloat(quickTaskProfilingDepth.value).toFixed(3));let M=Number(parseFloat(quickTaskProfilingFinishingDepth.value).toFixed(3));M>y&&(M=y);const h=Number((y-M).toFixed(3));let Te=0;s>1?(M>0?Te=h/(s-1):Te=h/s,Te=Number(Te.toFixed(3))):s===1&&(Te=h);let Pe=0,Fe=0;s>1&&M>0?Fe=s-1:Fe=s;for(let Ne=0;Ne<Fe;Ne++){let Xe=Te;c.push(`G1 X${Xe} F${r} ; roughing cut ${Ne+1}`),c.push(`G1 Z${i} F${r} ; cut`),c.push(`G1 X-0.2 F${l} ; retract`),c.push(`G1 Z-${i} F${l} ; retract`),c.push(`G1 X0.2 F${l} ; travel`),Pe+=Xe,Pe=Number(Pe.toFixed(3))}let $=0;if(p==="Absolute"){const Ne=Number((n+Pe).toFixed(3));$=Number(Math.abs(g-Ne).toFixed(3))}else $=M;if($>.001&&(c.push(`G1 X${$} F${r} ; finishing cut`),c.push(`G1 Z${i} F${r} ; cut`),c.push(`G1 X-0.2 F${l} ; retract`),c.push(`G1 Z-${i} F${l} ; retract`)),c.push("G90"),c.push(`G0 X${n} Z${o} F${l} ; move to final position`),c.push("G91"),e){navigator.clipboard.writeText(c.join(`
`)).then(()=>{alert("G-code copied to clipboard")}).catch(()=>{alert("Failed to copy G-code to clipboard")});return}sender==null||sender.sendCommands(c,SenderClient.QUICKTASKS)}async function updateProfilingPassesFromDepthPerPass(){const e=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),n=e==null?void 0:e.x;let o=0,i;if(quickTaskProfilingType.value==="Absolute"){const c=-Number(parseFloat(quickTaskProfilingFinalDiameter.value).toFixed(3))/2;i=Math.abs(c-n),i=Number(i.toFixed(3))}else i=Number(parseFloat(quickTaskProfilingDepth.value).toFixed(3));o=Number(parseFloat(quickTaskProfilingDepthPerPass.value).toFixed(3));let s=Number(parseFloat(quickTaskProfilingFinishingDepth.value).toFixed(3));s>i&&(s=i,quickTaskProfilingFinishingDepth.value=s.toFixed(3));const r=Number((i-s).toFixed(3));let l=1;o>0&&(l=Math.ceil(r/o)+1),quickTaskProfilingPasses.value=l.toString()}async function updateProfilingDepthPerPassFromPasses(){const e=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),n=e==null?void 0:e.x;let o;if(quickTaskProfilingType.value==="Absolute"){const c=-Number(parseFloat(quickTaskProfilingFinalDiameter.value).toFixed(3))/2;o=Math.abs(c-n),o=Number(o.toFixed(3))}else o=Number(parseFloat(quickTaskProfilingDepth.value).toFixed(3));const i=parseInt(quickTaskProfilingPasses.value,10);let s=Number(parseFloat(quickTaskProfilingFinishingDepth.value).toFixed(3));s>o&&(s=o,quickTaskProfilingFinishingDepth.value=s.toFixed(3));const r=Number((o-s).toFixed(3));let l=0;i>1?(s>0?l=r/(i-1):l=r/i,l=Number(l.toFixed(3))):l=o,quickTaskProfilingDepthPerPass.value=l.toFixed(3)}async function facingTask(e=!1){let n=[];const o=Number(parseFloat(quickTaskFacingXStartPosition.value).toFixed(3)),i=Math.abs(o)*2,s=Number(parseFloat(quickTaskFacingEndDiameter.value).toFixed(3)),r=Number(parseFloat(quickTaskFacingFeedrate.value).toFixed(3)),l=Number(parseFloat(quickTaskFacingTravelFeedRate.value).toFixed(3)),p=quickTaskFacingUsePecking.checked,c=Number(parseFloat(quickTaskFacingPeckingDepth.value).toFixed(3)),g=Number(parseFloat(quickTaskFacingPeckingRetractionRate.value).toFixed(3));localStorage.setItem("facingFeedrate",r.toString()),localStorage.setItem("facingPeckingDepth",c.toString()),localStorage.setItem("facingEndDiameter",s.toString()),localStorage.setItem("facingTravelFeedRate",l.toString()),localStorage.setItem("facingPeckingRetractionRate",g.toString()),localStorage.setItem("facingUsePecking",p.toString()),n.push("G90"),n.push(`G0 X${o} F${l} ; move to start position`),n.push("G91");const y=i/2,M=s/2,h=Math.abs(y-M);if(p){const Te=Math.ceil(h/c),Pe=h/Te;let Fe=0;for(let $=0;$<Te;$++){if(n.push(`G0 X${Pe} F${r} ; cut`),Fe+=Pe,Fe=Number(Fe.toFixed(3)),Fe>=h){n.push(`G1 X-${Fe} F${l} ; retract to start position`);break}($+1)%g===0?(n.push(`G1 X-${Fe} F${l} ; retract to start position`),n.push(`G1 X${Fe} F${l} ; travel back to cut position`)):(n.push(`G1 X-${Pe} F${l} ; retract short distance`),n.push(`G1 X${Pe} F${r} ; travel back to surface`))}}else n.push(`G1 X${h} F${r} ; cut`),n.push(`G1 X-${h} F${l} ; retract to start position`);if(e){navigator.clipboard.writeText(n.join(`
`)).then(()=>{alert("G-code copied to clipboard")}).catch(()=>{alert("Failed to copy G-code to clipboard")});return}sender==null||sender.sendCommands(n,SenderClient.QUICKTASKS)}function drillingTask(e=!1){const n=parseFloat(quickTaskDrillingDepth.value),o=parseFloat(quickTaskDrillingFeedRate.value),i=quickTaskDrillingPeckCheckbox.checked;let s=parseFloat(quickTaskDrillingPeckingDepth.value);const r=parseFloat(quickTaskDrillingRetractFeedRate.value),l=50,p=3,c=3;let g=!1,y=0;const M=parseFloat(quickTaskDrillingZStartPosition.value);if(isNaN(M)){alert("Please enter a valid starting Z position");return}localStorage.setItem("drillingRetractFeedRate",r.toString()),localStorage.setItem("drillingFeedRate",o.toString());let h=[];if(h.push("G90"),h.push(`G0 X0 Z${M} F${r} ; move to start position`),h.push("G91"),i){let Te=!1,Pe=0;for(;!Te;){if(h.push(`G1 Z${s} F${o}`),y++,Pe+=s,y===p?(h.push(`G1 Z-${Pe+c} F${r}`),g=!0,y=0):h.push(`G1 Z-${Pe} F${r}`),Pe>=n){Te=!0;break}else Pe+s>n&&(s=n-Pe);g?(h.push(`G1 Z${Pe+c-.2} F${r}`),h.push(`G1 Z${.2} F${l}`),g=!1):(h.push(`G1 Z${Pe-.2} F${r}`),h.push(`G1 Z${.2} F${l}`))}}else h.push(`G1 Z${n} F${o}`),h.push(`G1 Z-${n} F${r}`);if(e){navigator.clipboard.writeText(h.join(`
`)).then(()=>{alert("G-code copied to clipboard")}).catch(()=>{alert("Failed to copy G-code to clipboard")});return}sender==null||sender.sendCommands(h,SenderClient.QUICKTASKS)}function groovingTask(){alert("Not Yet Implemented")}function coneTask(){alert("Not Yet Implemented")}async function boringTask(e=!1){const n=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),o=n==null?void 0:n.x,i=Number(parseFloat(quickTaskBoringDepth.value).toFixed(3)),s=Number(parseFloat(quickTaskBoringFeedRate.value).toFixed(3)),r=quickTaskBoringType.value,l=parseInt(quickTaskBoringPasses.value,10),p=Number(parseFloat(quickTaskBoringRetractFeedRate.value).toFixed(3));localStorage.setItem("boringRetractFeedrate",p.toString()),localStorage.setItem("boringFeedRate",s.toString());const c=[];c.push("G91");let g=0,y=0;r==="Absolute"?(g=-Number(parseFloat(quickTaskBoringFinalDiameter.value).toFixed(3))/2,y=Math.abs(o-g),y=Number(y.toFixed(3))):y=Number(parseFloat(quickTaskBoringDepthOfCut.value).toFixed(3));let M=Number(parseFloat(quickTaskBoringFinishingDepth.value).toFixed(3));M>y&&(M=y);const h=Number((y-M).toFixed(3));let Te=0;l>1?(M>0?Te=h/(l-1):Te=h/l,Te=Number(Te.toFixed(3))):l===1&&(Te=h);let Pe=0,Fe=0;l>1&&M>0?Fe=l-1:Fe=l;for(let Ne=0;Ne<Fe;Ne++){let Xe=Te;c.push(`G1 X-${Xe} F${s} ; roughing cut ${Ne+1}`),c.push(`G1 Z${i} F${s} ; cut`),c.push(`G0 X0.2 F${p} ; retract`),c.push(`G0 Z-${i} F${p} ; retract`),c.push(`G0 X-0.2 F${p} ; travel`),Pe+=Xe,Pe=Number(Pe.toFixed(3))}let $=0;if(r==="Absolute"){const Ne=Number((o-Pe).toFixed(3));$=Number(Math.abs(Ne-g).toFixed(3))}else $=M;if($>.001&&(c.push(`G1 X-${$} F${s} ; finishing cut`),c.push(`G1 Z${i} F${s} ; cut`),c.push(`G0 X0.2 F${p} ; retract`),c.push(`G0 Z-${i} F${p} ; retract`)),c.push("G90"),e){navigator.clipboard.writeText(c.join(`
`)).then(()=>{alert("G-code copied to clipboard")}).catch(()=>{alert("Failed to copy G-code to clipboard")});return}sender==null||sender.sendCommands(c,SenderClient.QUICKTASKS)}async function updatePassesFromDepthPerPass(){const e=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),n=e==null?void 0:e.x;let o;if(quickTaskBoringType.value==="Absolute"){const c=-Number(parseFloat(quickTaskBoringFinalDiameter.value).toFixed(3))/2;o=Math.abs(n-c),o=Number(o.toFixed(3))}else o=Number(parseFloat(quickTaskBoringDepthOfCut.value).toFixed(3));const i=Number(parseFloat(quickTaskBoringDepthPerPass.value).toFixed(3));let s=Number(parseFloat(quickTaskBoringFinishingDepth.value).toFixed(3));s>o&&(s=o,quickTaskBoringFinishingDepth.value=s.toFixed(3));const r=Number((o-s).toFixed(3));let l=1;i>0&&(l=Math.ceil(r/i)+1),quickTaskBoringPasses.value=l.toString()}async function updateDepthPerPassFromPasses(){const e=await(sender==null?void 0:sender.getPosition(SenderClient.QUICKTASKS)),n=e==null?void 0:e.x;let o;if(quickTaskBoringType.value==="Absolute"){const c=-Number(parseFloat(quickTaskBoringFinalDiameter.value).toFixed(3))/2;o=Math.abs(n-c),o=Number(o.toFixed(3))}else o=Number(parseFloat(quickTaskBoringDepthOfCut.value).toFixed(3));const i=parseInt(quickTaskBoringPasses.value,10);let s=Number(parseFloat(quickTaskBoringFinishingDepth.value).toFixed(3));s>o&&(s=o,quickTaskBoringFinishingDepth.value=s.toFixed(3));const r=Number((o-s).toFixed(3));let l=0;i>1?(s>0?l=r/(i-1):l=r/i,l=Number(l.toFixed(3))):l=o,quickTaskBoringDepthPerPass.value=l.toFixed(3)}function threadingTask(e=!1){const n=sender==null?void 0:sender.getStatus();if(!n||!n.isConnected){alert("Please connect to the machine first");return}else if(n.version!==minimumVersion){alert(`Threading is only supported on ${minimumVersion} controllers. Please see the help page for more information.`);return}else{const o=quickTaskThreadingSize.value;if(o===""){alert("Please select a thread size");return}const i=quickTaskThreadingDirection.value,s=quickTaskThreadingExternalOrInternal.value,r=parseFloat(quickTaskThreadingLength.value),l=parseInt(quickTaskThreadingPasses.value,10),p=Threading.getThreadSpecByName(o),c=Threading.generateThreadingGcode(p,s,i,r,l);if(e){navigator.clipboard.writeText(c).then(()=>{alert("G-code copied to clipboard")}).catch(()=>{alert("Failed to copy G-code to clipboard")});return}const g=[];g.push("G90"),g.push(c),sender==null||sender.sendCommands(g,SenderClient.QUICKTASKS)}}function toolOffsetsTask(){const e=sender==null?void 0:sender.getStatus();if(!e||!e.isConnected){alert("Please connect to the machine first");return}else if(e.version!==minimumVersion){alert(`Tool offsets is only supported on ${minimumVersion} controllers. Please see the help page for more information.`);return}let n=quickTaskToolOffsetsToolNumber.value;if(n===""){alert("Please enter a tool number");return}if(n[0]==="T"&&(n=n.substring(1)),parseInt(n,10)===0){alert("T0 is the primary tool and cannot be modified");return}let o="XZ";if(quickTaskToolOffsetsOffsetX.value===""&&(o=o.replace("X","")),quickTaskToolOffsetsOffsetZ.value===""&&(o=o.replace("Z","")),o===""){alert("Please enter X and/or Z values");return}localStorage.setItem("probeDiameter",quickTaskToolOffsetsProbeDiameter.value);let i=[];const s=parseFloat(quickTaskToolOffsetsProbeDiameter.value)/2;if(quickTaskToolOffsetsToolType.value.startsWith("External")){const r={x:parseFloat(quickTaskToolOffsetsOffsetX.value),z:parseFloat(quickTaskToolOffsetsOffsetZ.value),radius:s,toolType:"External"},l=calculateToolOffsets(r);o==="X"?i.push(`G10 P${n} X${l.x}`):o==="Z"?i.push(`G10 P${n} Z${l.z}`):i.push(`G10 P${n} X${l.x} Z${l.z}`)}else if(quickTaskToolOffsetsToolType.value.startsWith("Internal")){const r={x:parseFloat(quickTaskToolOffsetsOffsetX.value),z:parseFloat(quickTaskToolOffsetsOffsetZ.value),radius:s,toolType:"Internal"},l=calculateToolOffsets(r);o==="X"?i.push(`G10 P${n} X${l.x}`):o==="Z"?i.push(`G10 P${n} Z${l.z}`):i.push(`G10 P${n} X${l.x} Z${l.z}`)}else{const r={x:parseFloat(quickTaskToolOffsetsOffsetX.value),z:parseFloat(quickTaskToolOffsetsOffsetZ.value),radius:s,toolType:"Drill"},l=calculateToolOffsets(r);o==="X"?i.push(`G10 P${n} X${l.x}`):o==="Z"?i.push(`G10 P${n} Z${l.z}`):i.push(`G10 P${n} X${l.x} Z${l.z}`)}sender==null||sender.sendCommands(i,SenderClient.QUICKTASKS),alert(`Tool offsets for T${n} have been set`)}function calculateToolOffsets(e){let n;switch(e.toolType){case"Drill":n=-e.x;break;case"Internal":n=-(e.x-e.radius);break;case"External":n=-(e.x- -e.radius);break}const o=-e.z,i=s=>Math.round(s*1e3)/1e3;return{x:i(n),z:i(o)}}const cutLineColour="#DC143C",travelLineColour="#6B8E23",retractLineColour="#FFA500",currentLineColour="#242424",offSetFromScreenEdgeZ=5;class CanvasDrawer{constructor(){De(this,"currentX",0);De(this,"currentZ",0);De(this,"absX",0);De(this,"absZ",0);De(this,"previousCanvasX",0);De(this,"previousCanvasZ",0);De(this,"canvasX",0);De(this,"canvasZ",0);De(this,"ctx",null);De(this,"stockDiameterInMM",0);De(this,"isBoringOperation",!1);De(this,"hasOperationType",!1)}parseGCode(n){let o=!1;const i=[],s={z:0,x:0};let r=0,l=!1;return this.isBoringOperation=!1,this.hasOperationType=!1,n.split(`
`).forEach((c,g)=>{const y=this.determineMovementType(c);this.hasOperationType||(c.toLowerCase().includes("; op type boring")||c.toLowerCase().includes("; op type drilling")?(this.isBoringOperation=!0,this.hasOperationType=!0):(c.toLowerCase().includes("; op type turning")||c.toLowerCase().includes("; op type profiling")||c.toLowerCase().includes("; op type facing"))&&(this.isBoringOperation=!1,this.hasOperationType=!0));const M={isRelative:o,movementType:y},h=c.match(/([GXYZF])([0-9.-]+)/g);if(!l&&c.includes(";")){const Pe=c.substring(c.indexOf(";")),Fe=[/stock\s+d(?:iameter)?\s*[=:]?\s*(\d+\.?\d*)(?:mm)?/i,/stock\s+(?:diameter|dia|diam)?\s*[=:]?\s*(\d+\.?\d*)(?:mm)?/i,/diameter\s*[=:]?\s*(\d+\.?\d*)(?:mm)?/i,/dia\s*[=:]?\s*(\d+\.?\d*)(?:mm)?/i];for(const $ of Fe){const Ne=Pe.match($);if(Ne&&Ne[1]){r=parseFloat(Ne[1]),l=!0,this.stockDiameterInMM=r;break}}}h==null||h.forEach(Pe=>{const Fe=parseFloat(Pe.slice(1));switch(Pe[0]){case"G":Fe===90&&(M.isRelative=!1,o=!1),Fe===91&&(M.isRelative=!0,o=!0);break;case"X":M.x=parseFloat(Fe.toFixed(3)),o?s.x=parseFloat((s.x+Fe).toFixed(3)):(s.x=parseFloat(Fe.toFixed(3)),l||(r=Math.abs(s.x)*2,this.stockDiameterInMM=r,l=!0));break;case"Z":M.z=parseFloat(Fe.toFixed(3)),o?s.z=parseFloat((s.z+Fe).toFixed(3)):s.z=parseFloat(Fe.toFixed(3));break}});const Te={...M,lineNumber:g+1,originalLine:c,absolutePosition:{...s}};(M.z!==void 0||M.x!==void 0)&&i.push(Te)}),i}determineMovementType(n){const o=n.toLowerCase(),i=o.includes(";")?o.substring(o.indexOf(";")).trim():"";return i.includes("cut")||i.includes("rough")||i.includes("finish")||i.includes("facing")||i.includes("turn")?0:i.includes("retract")||i.includes("return")||i.includes("safe")?2:1}calculateDynamicScaleFactor(n,o){let i=0,s=0,r=n.find($=>!$.isRelative),l=r&&r.x?r.x:0,p=r&&r.z?r.z:0;const c=5;n.forEach($=>{$.x!==void 0&&($.isRelative?(l+=$.x,l<s&&(s=l)):$.x<s&&(s=$.x)),$.z!==void 0&&($.isRelative?(p+=$.z,p>i&&(i=p)):$.z>i&&(i=$.z))});const g=Math.abs(s),y=Math.abs(i),M=o.height/2-c,h=o.width-c-offSetFromScreenEdgeZ,Te=M/g,Pe=h/y;return Math.min(Te,Pe)}draw(n,o,i,s,r=!0,l=!0){if(this.ctx=n.getContext("2d"),!this.ctx)return;this.ctx.clearRect(0,0,n.width,n.height),this.currentX=0,this.currentZ=0,this.absX=0,this.absZ=0,this.previousCanvasX=n.height/2,this.previousCanvasZ=n.width-offSetFromScreenEdgeZ;let p=this.stockDiameterInMM;const c=document.createElement("canvas");c.width=n.width,c.height=n.height,this.drawStockOnCanvas(c,p,i);const g=s!==void 0?Math.min(s+1,o.length):o.length;for(let y=0;y<g;y++)o[y].isRelative?(this.currentX+=o[y].x??0,this.currentZ+=o[y].z??0):(this.currentX=o[y].x??this.absX,this.currentZ=o[y].z??this.absZ,this.absX=this.currentX,this.absZ=this.currentZ),this.canvasX=n.height/2-this.currentX*i,this.canvasZ=n.width-this.currentZ*i-offSetFromScreenEdgeZ,o[y].movementType===0&&r&&this.removeStockMaterial(c,i),this.previousCanvasX=this.canvasX,this.previousCanvasZ=this.canvasZ;this.ctx.drawImage(c,0,0),this.currentX=0,this.currentZ=0,this.absX=0,this.absZ=0,this.previousCanvasX=n.height/2,this.previousCanvasZ=n.width-offSetFromScreenEdgeZ,this.drawReferenceLines(n);for(let y=0;y<g;y++)this.drawLinesCommand(n,o[y],i,y===(s??-1),r,l)}drawStockOnCanvas(n,o,i){const s=n.getContext("2d");if(!s)return;s.lineWidth=2;let r=o*i/2;const l=0,p=n.height/2-r,c=o*i,g=n.width;s.beginPath(),s.rect(l,p,g,c),s.fillStyle="lightgrey",s.fill(),s.strokeStyle="#666666",s.stroke()}drawReferenceLines(n){const o=n.getContext("2d");o&&(o.beginPath(),o.moveTo(0,n.height/2),o.lineTo(n.width,n.height/2),o.strokeStyle="blue",o.setLineDash([5,5]),o.stroke(),o.beginPath(),o.moveTo(n.width-offSetFromScreenEdgeZ,0),o.lineTo(n.width-offSetFromScreenEdgeZ,n.height),o.strokeStyle="#888888",o.setLineDash([5,5]),o.stroke(),o.setLineDash([]))}removeStockMaterial(n,o){const i=n.getContext("2d");if(!i)return;const s=()=>{const l=2*o;if(this.isBoringOperation){const p=this.canvasZ-this.previousCanvasZ,c=this.canvasX-this.previousCanvasX,g=Math.sqrt(p*p+c*c);i.globalCompositeOperation="destination-out",i.fillStyle="black";const y=n.height/2,h=Math.abs(this.currentX)*o,Te=y-h;let Pe;if(o!==0){const $=(n.height/2-this.previousCanvasX)/-o;Pe=Math.abs($)*o}else Pe=h;const Fe=y-Pe;g<.001||Math.abs(p)<.001?(i.beginPath(),i.rect(this.canvasZ,Te,l,h),i.fill()):(i.beginPath(),i.moveTo(this.previousCanvasZ,Fe),i.lineTo(this.canvasZ,Te),i.lineTo(this.canvasZ+l,Te),i.lineTo(this.previousCanvasZ+l,Fe),i.closePath(),i.fill(),i.beginPath(),i.moveTo(this.previousCanvasZ,Fe),i.lineTo(this.canvasZ,Te),i.lineTo(this.canvasZ,y),i.lineTo(this.previousCanvasZ,y),i.closePath(),i.fill(),i.beginPath(),i.moveTo(this.canvasZ+l,Te),i.lineTo(this.previousCanvasZ+l,Fe),i.lineTo(this.previousCanvasZ+l,y),i.lineTo(this.canvasZ+l,y),i.closePath(),i.fill()),i.globalCompositeOperation="source-over"}else{const p=this.canvasZ-this.previousCanvasZ,c=this.canvasX-this.previousCanvasX,g=Math.sqrt(p*p+c*c);i.globalCompositeOperation="destination-out",i.fillStyle="black",g<.001||Math.abs(p)<.001?(i.beginPath(),i.rect(this.canvasZ,this.canvasX,l,n.height-this.canvasX),i.fill()):(i.beginPath(),i.moveTo(this.previousCanvasZ,this.previousCanvasX),i.lineTo(this.canvasZ,this.canvasX),i.lineTo(this.canvasZ+l,this.canvasX),i.lineTo(this.previousCanvasZ+l,this.previousCanvasX),i.closePath(),i.fill(),i.beginPath(),i.moveTo(this.previousCanvasZ,this.previousCanvasX),i.lineTo(this.canvasZ,this.canvasX),i.lineTo(this.canvasZ,n.height),i.lineTo(this.previousCanvasZ,n.height),i.closePath(),i.fill(),i.beginPath(),i.moveTo(this.canvasZ+l,this.canvasX),i.lineTo(this.previousCanvasZ+l,this.previousCanvasX),i.lineTo(this.previousCanvasZ+l,n.height),i.lineTo(this.canvasZ+l,n.height),i.closePath(),i.fill()),i.globalCompositeOperation="source-over"}};s(),i.save(),i.scale(1,-1),i.translate(0,-n.height),s(),i.restore()}drawLinesCommand(n,o,i,s,r,l){if(this.ctx=n.getContext("2d"),!this.ctx)return;this.ctx.lineWidth=2,o.isRelative?(this.currentX+=o.x??0,this.currentZ+=o.z??0):(this.currentX=o.x??this.absX,this.currentZ=o.z??this.absZ,this.absX=this.currentX,this.absZ=this.currentZ),this.canvasX=n.height/2-this.currentX*i,this.canvasZ=n.width-this.currentZ*i-offSetFromScreenEdgeZ;let p="";if((o.movementType==0&&r||o.movementType==1&&l||o.movementType==2&&l)&&(this.ctx.beginPath(),p=o.movementType==0?cutLineColour:o.movementType==1?travelLineColour:retractLineColour,this.ctx.moveTo(this.previousCanvasZ,this.previousCanvasX),this.ctx.lineTo(this.canvasZ,this.canvasX),s?(this.ctx.strokeStyle=p,this.ctx.setLineDash([5,5]),this.ctx.lineDashOffset=0,this.ctx.stroke(),this.ctx.strokeStyle=currentLineColour,this.ctx.setLineDash([5,5]),this.ctx.lineDashOffset=-5,this.ctx.stroke()):(this.ctx.strokeStyle=p,this.ctx.setLineDash([]),this.ctx.stroke()),s)){let c=this.canvasZ-this.previousCanvasZ,g=this.canvasX-this.previousCanvasX,y=Math.atan2(g,c);this.ctx.save(),this.ctx.translate(this.previousCanvasZ,this.previousCanvasX),this.ctx.rotate(y+Math.PI/2),this.ctx.beginPath(),this.ctx.moveTo(0,-5),this.ctx.lineTo(-5,5),this.ctx.lineTo(5,5),this.ctx.closePath(),this.ctx.fillStyle="green",this.ctx.fill(),this.ctx.restore(),this.ctx.beginPath(),this.ctx.rect(this.canvasZ-3,this.canvasX-3,6,6),this.ctx.fillStyle="red",this.ctx.fill()}this.previousCanvasX=this.canvasX,this.previousCanvasZ=this.canvasZ}}const editor=ace.edit("gcodeEditor"),gcodeResponseEditor=ace.edit("gcodeResponseEditor"),gcodeSenderEditor=ace.edit("gcodeSenderEditor");document.addEventListener("DOMContentLoaded",()=>{new GCode;const e=new CanvasDrawer;let n=[];const o=document.getElementById("gcodeCanvas"),i=document.getElementById("zoomCanvas"),s=document.getElementById("fileInput"),r=document.getElementById("simulateButton"),l=document.getElementById("showCuts"),p=document.getElementById("showNonCuts"),c=document.getElementById("showCutsZoom"),g=document.getElementById("showNonCutsZoom"),y=document.getElementById("sliderLabel"),M=document.getElementById("zoomSliderLabel"),h=document.getElementById("progressSlider"),Te=document.getElementById("zoomProgressSlider"),Pe=document.getElementById("sliderContainer"),Fe=document.getElementById("displayOptionsContainer"),$=document.getElementById("clearButton"),Ne=document.querySelector(".saveGCodeNameInput"),Xe=document.querySelector(".loadGCodeSelect"),Ke=document.querySelector(".loadGCodeButton"),We=document.querySelector(".saveGCodeButton"),d=document.querySelector(".deleteGCodeButton"),j=document.getElementById("gcodeSenderContainer"),u=document.getElementById("exampleCode"),k=document.getElementById("helpModal"),f=document.getElementById("helpButton"),_=document.getElementById("closeHelpModal"),J=document.getElementById("zoomModal"),Se=document.getElementById("zoomButton"),Oe=document.getElementById("closeZoomModal"),Me=document.getElementById("zoomCloseButton"),Ge=document.getElementById("simulationTab"),He=document.getElementById("controlTab"),Je=document.getElementById("quickTasksTab"),Qe=document.getElementById("plannerTab"),rt=document.getElementById("helpTab"),st=document.getElementById("connectionContainer"),et=document.getElementById("simulationContainer"),nt=document.getElementById("controlsContainer"),lt=document.getElementById("quickTasksContainer"),it=document.getElementById("plannerContainer"),ut=document.getElementById("helpContainer"),mt=document.querySelectorAll("#latheControls .increment-btn"),ht=document.getElementById("moveDistance");localStorage.getItem("helpModalShown")||(k.style.display="block",localStorage.setItem("helpModalShown","true")),mt.forEach(function(Ie){Ie.addEventListener("click",function(){mt.forEach(function($e){$e.classList.remove("active")}),this.classList.add("active");var _e=this.dataset.increment;ht.value=_e,localStorage.setItem("moveDistance",_e)})}),Ge.addEventListener("click",()=>{et.style.display="flex",nt.style.display="none",lt.style.display="none",it.style.display="none",st.style.display="none",ut.style.display="none"}),He.addEventListener("click",()=>{et.style.display="none",nt.style.display="flex",lt.style.display="none",it.style.display="none",st.style.display="block",ut.style.display="none"}),Je.addEventListener("click",()=>{et.style.display="none",nt.style.display="none",lt.style.display="flex",it.style.display="none",st.style.display="block",ut.style.display="none"}),Qe.addEventListener("click",()=>{et.style.display="none",nt.style.display="none",lt.style.display="none",it.style.display="flex",st.style.display="block",ut.style.display="none";const Ie=new Event("containerVisible");it.dispatchEvent(Ie)}),rt.addEventListener("click",()=>{et.style.display="none",nt.style.display="none",lt.style.display="none",it.style.display="none",st.style.display="none",ut.style.display="flex"}),i.width=window.visualViewport.width-100,i.height=window.visualViewport.height-150,window.addEventListener("resize",function(){i.width=window.visualViewport.width-100,i.height=window.visualViewport.height-150,Te.value=Te.min,pt(i)}),Se.onclick=function(){J.style.display="block",pt(i)},Oe.onclick=function(){J.style.display="none"},Me.onclick=function(){J.style.display="none"},f.onclick=function(){k.style.display="block"},_.onclick=function(){k.style.display="none"},window.onclick=function(Ie){Ie.target==k&&(k.style.display="none"),Ie.target==J&&(J.style.display="none")},We.addEventListener("click",()=>gt()),Ke.addEventListener("click",()=>ft()),d.addEventListener("click",()=>vt()),G(),editor.setTheme("ace/theme/github_dark"),editor.session.setMode("ace/mode/plain_text"),editor.setShowPrintMargin(!1),gcodeSenderEditor.setTheme("ace/theme/github_dark"),gcodeSenderEditor.session.setMode("ace/mode/plain_text"),gcodeSenderEditor.setShowPrintMargin(!1),u.addEventListener("click",()=>tt()),gcodeResponseEditor.setTheme("ace/theme/monokai"),gcodeResponseEditor.session.setMode("ace/mode/text"),gcodeResponseEditor.setReadOnly(!0),gcodeResponseEditor.setShowPrintMargin(!1),gcodeResponseEditor.getSession().on("change",()=>{setTimeout(()=>{var Ie=gcodeResponseEditor.getSession().getLength();gcodeResponseEditor.scrollToLine(Ie,!0,!0,function(){})},0)}),gcodeSenderEditor.on("focus",()=>{gcodeSenderEditor.getValue()==="Paste your gcode here or click choose file to upload"&&gcodeSenderEditor.setValue("")}),Le(),h.oninput=()=>{const Ie=Math.floor(parseInt(h.value));if(Ie<n.length){const _e=n[Ie];let $e=e.calculateDynamicScaleFactor(n,o);e.draw(o,n,$e,Ie,l.checked,p.checked),Re(_e)}},Te.oninput=()=>{const Ie=Math.floor(parseInt(Te.value));if(Ie<n.length){const _e=n[Ie];let $e=e.calculateDynamicScaleFactor(n,i);e.draw(i,n,$e,Ie,c.checked,g.checked),Ze(_e)}},$.addEventListener("click",()=>{gcodeSenderEditor.setValue(""),editor.setValue(""),Le();const Ie=o.getContext("2d");Ie&&(Ie.clearRect(0,0,o.width,o.height),s.value="",h.value="0",Te.value="0",Pe.style.display="none",Fe.style.display="none")}),s.addEventListener("change",Ie=>{if(Ie.target instanceof HTMLInputElement&&Ie.target.files&&Ie.target.files.length>0){const _e=Ie.target.files[0];_e&&ot(_e)}}),r.addEventListener("click",()=>{pt(o)});function pt(Ie){if(!Ie)return;const _e=editor.getValue();if(_e){n=e.parseGCode(_e);let $e=e.calculateDynamicScaleFactor(n,Ie);e.draw(Ie,n,$e,void 0,l.checked,p.checked),Pe.style.display="block",Fe.style.display="block",l.addEventListener("change",Ve),p.addEventListener("change",Ve),c.addEventListener("change",ct),g.addEventListener("change",ct),h.max=(n.length-1).toString(),h.value=h.min,Te.max=(n.length-1).toString(),Te.value=Te.min,j.style.display="block"}}function gt(){const Ie=Ne.value.trim();if(!Ie)return;const _e=`gCode-${Ie}`;localStorage.setItem(_e,editor.getValue()),G(_e),Ne.value=""}function ft(){const Ie=Xe.value,_e=localStorage.getItem(Ie);_e&&(editor.setValue(_e),gcodeSenderEditor.setValue(_e))}function vt(){const Ie=Xe.value;localStorage.removeItem(Ie),G()}function G(Ie){Xe.innerHTML="";let _e=!1;for(let $e=0;$e<localStorage.length;$e++){const Ue=localStorage.key($e);if(Ue&&Ue!=="latheCode"&&Ue.startsWith("gCode-")){_e=!0;const at=document.createElement("option"),kt=Ue.replace("gCode-","");at.value=Ue,at.textContent=kt,Xe.appendChild(at),Ue===Ie&&(at.selected=!0)}}if(_e){const $e=Array.from(Xe.options).sort((Ue,at)=>Ue.text.localeCompare(at.text));Xe.innerHTML="",$e.forEach(Ue=>{Xe.appendChild(Ue)})}else{const $e=document.createElement("option");$e.textContent="No items saved",$e.disabled=!0,Xe.appendChild($e)}}function Le(){const Ie=editor.getValue(),_e=gcodeSenderEditor.getValue();Ie===""&&(editor.setValue("Paste your gcode here or click choose file to upload"),editor.gotoLine(1,0),editor.on("focus",function(){editor.getValue()==="Paste your gcode here or click choose file to upload"&&editor.setValue("")})),_e===""&&(gcodeSenderEditor.setValue("Paste your gcode here or click choose file to upload"),gcodeSenderEditor.gotoLine(1,0),gcodeSenderEditor.on("focus",function(){gcodeSenderEditor.getValue()==="Paste your gcode here or click choose file to upload"&&gcodeSenderEditor.setValue("")}))}function Re(Ie){var _e,$e,Ue;(Ie==null?void 0:Ie.lineNumber)!==void 0?(editor.gotoLine(Ie.lineNumber,0,!0),y.innerHTML=`Line:${Ie.lineNumber}<br>${Ie==null?void 0:Ie.originalLine}<br>Abs: X${((_e=Ie.absolutePosition)==null?void 0:_e.x)??0} &lpar;Dia: ${((($e=Ie.absolutePosition)==null?void 0:$e.x)??0)*2}&rpar; Z${(Ue=Ie.absolutePosition)==null?void 0:Ue.z}`||""):y.innerHTML=""}function Ze(Ie){var _e,$e,Ue;(Ie==null?void 0:Ie.lineNumber)!==void 0?(editor.gotoLine(Ie.lineNumber,0,!0),M.innerHTML=`Line:${Ie.lineNumber}<br>${Ie==null?void 0:Ie.originalLine}<br>Abs: X${(_e=Ie.absolutePosition)==null?void 0:_e.x} &lpar;Dia: ${((($e=Ie.absolutePosition)==null?void 0:$e.x)??0)*2}&rpar; Z${(Ue=Ie.absolutePosition)==null?void 0:Ue.z}`||""):M.innerHTML=""}function ot(Ie){const _e=new FileReader;_e.onload=$e=>{const Ue=$e.target.result;editor.setValue(Ue),gcodeSenderEditor.setValue(Ue)},_e.readAsText(Ie)}function Ve(){c.checked=l.checked,g.checked=p.checked,h.value="0";const Ie=e.calculateDynamicScaleFactor(n,o);e.draw(o,n,Ie,void 0,l.checked,p.checked)}function ct(){l.checked=c.checked,p.checked=g.checked,Te.value="0";const Ie=e.calculateDynamicScaleFactor(n,i);e.draw(i,n,Ie,void 0,c.checked,g.checked)}function tt(){editor.setValue(exampleGcode)}});

</script>
  <style>
:root{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#202124;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}a{font-weight:500;color:#646cff;text-decoration:inherit}a:hover{color:#535bf2}h1{font-size:3.2em;line-height:1.1}table{width:100%;display:flex;flex-direction:column}thead,tr{display:flex;width:100%}th:first-child,td:first-child{flex:0 0 60px}th:last-child,td:last-child{flex:0 0 60px}th:not(:first-child):not(:last-child),td:not(:first-child):not(:last-child){flex:1}hr{width:100%;border:none;border-top:1px solid #ffffff;margin:10px 0}#app{max-width:1280px;margin:0 auto;padding:2rem;text-align:center}.logo{height:6em;padding:1.5em;will-change:filter;transition:filter .3s}.logo:hover{filter:drop-shadow(0 0 2em #646cffaa)}.logo.vanilla:hover{filter:drop-shadow(0 0 2em #3178c6aa)}.card{padding:2em}.read-the-docs{color:#888}button{border-radius:3px;padding:.6em 1.2em;font-size:1em;font-weight:500;font-family:inherit;background-color:#1a1a1a;cursor:pointer;transition:background-color .25s;border:2px solid white;color:#fff}button:hover{background-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}input[readonly]{cursor:not-allowed;background-color:#2f4f4f;border-color:#767676}.disabled-button{background-color:red;cursor:not-allowed}.interaction-ready-button{background-color:green}.interaction-ready-warn-button{background-color:red}.icon-container{width:60px;height:50px;padding:5px 10px}.icon-container svg{width:100%;height:100%}#simulationContainer{display:flex;flex-direction:column;width:800px;max-width:1280px;text-align:center}.main-container{display:flex;width:100%}#interactiveComponentsContainer,#controlsContainer,#quickTasksContainer{display:flex;flex-direction:column;width:800px;max-width:1280px;text-align:center}button.quick-tasks-innercontainer{display:flex;align-items:center;cursor:pointer;background:none;border:none;padding:0;margin:5px 0;border:1px solid #ccc;border-radius:5px;background-color:#333;flex-direction:column;justify-content:center;width:100%;box-sizing:border-box}button.quick-tasks-innercontainer:hover{background-color:#6c5ce7}button.execute{padding:0 10px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;margin:0 auto}input.quick-task-summary{width:auto;box-sizing:border-box}.tooltip-icon{display:inline-flex;margin-left:5px;cursor:help;color:#fff;font-weight:700;font-size:16px;position:relative;width:18px;height:18px;border:2px solid #ffffff;border-radius:50%;align-items:center;justify-content:center;text-align:center;vertical-align:middle}.tooltip-icon:hover:after{content:attr(data-tooltip);position:absolute;background-color:#333;color:#fff;padding:5px;border-radius:5px;white-space:nowrap;z-index:10;top:100%;left:50%;transform:translate(-50%)}.quick-tasks-subinnercontainer{display:flex;flex-direction:row}.controls-container,.connection-container{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:5px;border:1px solid #ccc}.canvas-container{display:flex;flex-direction:column;align-items:center;margin:5px;border:1px solid #ccc}.canvas-wrapper{display:flex;flex-direction:column;align-items:center}.innerContainer{margin:5px;align-items:center;width:auto}.modal-pad{padding-top:10px}.modal-pad-bottom{padding-bottom:10px}.modal-pad-bottom-flex{padding-bottom:10px;flex:1;display:flex;flex-direction:column}.emulation-modal-pad-border{padding:10px;border:2px dashed green;min-height:40px}.innerContainer.toolbar{display:flex;align-items:center;gap:5px;padding:2px}.saveGCodeNameInput,.loadGCodeSelect{flex-grow:1}#gcodeCanvas{border-bottom:1px solid #ccc;background-color:#242424}#gcodeInput{position:relative;background:transparent;width:100%;height:240px;font-family:monospace;font-size:13px;line-height:1.5;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#gcodeContainer{position:relative;width:100%}#gcodeSenderContainer{display:block}.save-group,.load-group,.import-export-group{display:flex;flex-direction:row;align-items:center;gap:10px}.toolbar input[type=text],.toolbar select{max-width:200px;width:100%;box-sizing:border-box;border:1px solid #ccc;margin:0;padding:.375rem .75rem;font-size:1rem;line-height:1.5}input[type=file]::file-selector-button{border:2px solid #6c5ce7;padding:.2em .4em;border-radius:.2em;background-color:#1a1a1a;transition:.25s}input[type=file]::-ms-browse:hover{background-color:#646cff}input[type=file]::-webkit-file-upload-button:hover{background-color:#646cff}input[type=file]::file-selector-button:hover{background-color:#646cff}.bottom-container{margin:5px}#gcodeResponseContainer{border:1px solid #ccc;width:100%;display:flex;flex-direction:column;align-items:center;margin-top:5px}.senderError{display:none;color:#fff;background-color:red;padding:10px;border-radius:5px;animation:flashError 1s infinite}@keyframes flashError{0%,to{opacity:1}50%{opacity:0}}#helpText li{margin-bottom:10px}#helpText a{color:#f95959}.help-modal{display:none;position:fixed;z-index:1;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#0006}.help-modal-content{position:relative;background-color:#242424;margin:15% auto;padding:20px;border:2px solid #6c5ce7;width:30%}.zoom-modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#242424}.zoom-modal-content{display:flex;flex-direction:column;align-items:center;margin:10px auto;padding:20px;border:1px solid #888}.close-modal{position:absolute;top:0;right:0;padding-right:10px;cursor:pointer;font-size:35px}#sliderAndButtonContainer{display:flex;justify-content:center;align-items:center;gap:10px;flex-direction:column}.text-red{color:#dc143c}.text-green{color:#6b8e23}.text-orange{color:orange}.line{display:inline-block;vertical-align:middle;width:20px;height:2px;margin-right:5px}.red-line{border-top:2px solid #DC143C}.green-line{border-top:2px solid #6B8E23}.orange-line{border-top:2px solid #FFA500}#latheControls #jogControls{display:grid;grid-template-columns:repeat(12,60px);grid-template-rows:repeat(6,60px);justify-content:center;align-items:center;place-items:center}#latheControls .jog-btn{width:50px;height:50px;border-radius:5px;cursor:pointer;background-color:#f0ad4e;display:flex;justify-content:center;align-items:center;text-align:center;line-height:50px;font-size:24px;padding:0}#latheControls .tool-btn{width:50px;height:50px;border-radius:5px;cursor:pointer;background-color:#379126;display:flex;justify-content:center;align-items:center;text-align:center;line-height:20px;font-size:12px;padding:0}#latheControls .tool-btn:hover{background-color:#6c5ce7}#latheControls .tool{background-color:#f0ad4e;border:none}#latheControls .tool-selected{background-color:#6c5ce7;border:2px solid white}#latheControls .fast{background-color:#2196f3}#latheControls .slow{background-color:#4caf50}#latheControls .jog-btn:hover{background-color:#6c5ce7}.jog-btn,.jog-labels{grid-column:var(--col);grid-row:var(--row)}.tool-label{grid-column:var(--col) / span 2;grid-row:var(--row);font-size:18px;align-self:end}.tool-select{width:100px;height:50px;border-radius:5px;cursor:pointer;background-color:#004b8b;text-align:center;font-size:20px;padding:0 16px 0 0;appearance:none;-webkit-appearance:none;-moz-appearance:none;border:none;display:flex;justify-content:center;align-items:center;border:2px solid white;grid-column:var(--col) / span 2;grid-row:var(--row);background-image:url("data:image/svg+xml;utf8,<svg fill='white' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");background-repeat:no-repeat;background-position:right -8px center;background-size:30px}.tool-select:after{content:"▼";position:absolute;right:5px;top:50%;transform:translateY(-50%);font-size:12px;pointer-events:none}.tool-select option{background-color:#202124;color:#ffffffde;text-align:center}.tool-select:focus{outline:none;box-shadow:0 0 3px #f0ad4e}.tool-edit{width:100px;height:50px;border-radius:5px;cursor:pointer;background-color:#004b8b;text-align:center;font-size:18px;appearance:none;-webkit-appearance:none;-moz-appearance:none;border:none;display:flex;justify-content:center;align-items:center;border:2px solid white;grid-column:var(--col) / span 2;grid-row:var(--row)}.tool-btn{grid-column:var(--col);grid-row:var(--row)}.tool-save-button{padding:0;border:none;background:none;cursor:pointer;display:flex;align-items:center;justify-content:center;width:100%}.tool-save-button:hover{background-color:#0000001a;border-radius:3px}.tool-cell{flex:0 0 60px;padding:4px;border-bottom:1px solid #444}.data-cell{flex:1;padding:4px;border-bottom:1px solid #444}.action-cell{flex:0 0 60px;padding:4px;border-bottom:1px solid #444}.tool-cell input{width:100%;padding:4px;text-align:center;background-color:#333;border:1px solid #444}.data-cell input{width:100%;padding:4px;text-align:right;border:1px solid #444}.menu ul{list-style-type:none;padding:0}.menu li{cursor:pointer;padding:10px;background-color:#242424;border-bottom:1px solid #6c5ce7}.menu li:hover{background-color:#6c5ce7}.content{margin-left:200px;padding:20px}#senderProgressContainer{display:flex;justify-content:center;align-items:center}#senderProgressLabel{margin-right:10px}.innerContentCentre{display:flex;justify-content:center;align-items:center;margin:10px}#gcodeSenderContainer{position:relative;width:100%}#latheControls #incrementControls{display:flex;justify-content:center;gap:10px;margin:20px 0}#latheControls .increment-btn{padding:5px 10px;border:1px solid #ccc;background-color:#3a3d3d;border-radius:5px;cursor:pointer;transition:background-color .3s}#latheControls .increment-btn:hover,#latheControls .increment-btn.active{background-color:#6c5ce7}.control-inputs input[type=text]{max-width:200px;width:100%;box-sizing:border-box;border:1px solid #ccc;margin:0;padding:.375rem .75rem}.control-inputs label{display:block;margin-right:5px}.sender-inputs input[type=text]{max-width:350px;min-width:350px;width:100%;box-sizing:border-box;border:1px solid #ccc;margin:0;padding:.375rem .75rem}.gcode-dropdown{position:absolute;max-height:200px;overflow-y:auto;border:1px solid #ccc;background:var(--background-color, #fff);z-index:1000;border-radius:4px;box-shadow:0 2px 4px #0000001a}.gcode-option{padding:8px 12px;cursor:pointer;color:inherit;background-color:#202124}.gcode-option:hover{filter:brightness(1.2)}#latheControls label{white-space:nowrap;margin-right:10px;display:inline-block;min-width:120px}#plannerContainer{display:flex;flex-direction:column;width:800px;max-width:1280px;text-align:center}.planner-container{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:5px;border:1px solid #ccc}.planner-container h1{margin:10px 0}.planner-guidance{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:10px;text-align:center}.planner-guidance span{display:block;margin:10px 0;text-align:left}#taskContainer{display:flex;justify-content:space-between;align-items:start;padding:20px}.container-wrapper{padding:10px}.container-wrapper-inner{padding:5px 0}.container-wrapper-outer{border:1px solid #ccc;border-radius:5px;margin:10px;background-color:#333}.container-wrapper-delete{min-height:50px;display:flex;justify-content:center;align-items:center;border:2px dashed red}#availableTasks{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;align-items:start;min-width:450px}#availableTasks .span-2-rows{grid-row:span 3;height:100%}#availableTasks div{box-sizing:border-box;padding:5px}#tasksToExecute{min-height:50px;padding:5px;border:2px dashed green}#tasksToExecute div{margin:5px}.task-to-execute{text-align:left}.task-to-execute i{text-align:left;margin-left:5px;cursor:help}.available-task{width:150px;-webkit-user-select:none;user-select:none}.available-task i{margin-left:5px;cursor:help}.task-manual{background-color:#4c956c}.task-gcode{background-color:#386e97}.task-emulation{background-color:#e74c3c}.emulate-noselect{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#emulationInnerContainer{display:flex;flex-direction:row;justify-content:center;align-items:center;height:100%}#emulationNewTasksMovement{display:grid;grid-template-columns:repeat(9,40px);grid-template-rows:repeat(3,40px);gap:3px;align-items:center;justify-items:center}#emulationNewTasksNumbers,#emulationNewTasksOther{display:grid;grid-template-columns:repeat(2,40px);grid-template-rows:repeat(6,40px);gap:3px;align-items:center;justify-items:center}#emulationNewTasksMode{display:grid;grid-template-columns:repeat(8,40px);grid-template-rows:repeat(1,40px);gap:3px;align-items:center;justify-items:center}#movementContainer,#modeContainer{width:100%;display:flex;justify-content:center;align-items:center;margin:5px;padding:5px}#emulateKeyUp{grid-area:1 / 2}#emulateKeyDown{grid-area:3 / 2}#emulateKeyLeft{grid-area:2 / 1}#emulateKeyRight{grid-area:2 / 3}#emulateKeyPlay{grid-area:1 / 5}#emulateKeyStop{grid-area:3 / 5}#emulateKeyStopUp{grid-area:1 / 8}#emulateKeyStopDown{grid-area:3 / 8}#emulateKeyStopLeft{grid-area:2 / 7}#emulateKeyStopRight{grid-area:2 / 9}#emulationNewTasksMode button.material-symbols-outlined{background-color:#ff0;border-radius:50%;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#000;padding:0;font-weight:700}#emulationNewTasksMode button:hover{background-color:#18a79b}#emulationNewTasksMode button:focus,#emulationNewTasksMode button:focus-visible{outline:4px auto -webkit-focus-ring-color;background-color:#18a79b}#emulationNewTasksMovement button.material-symbols-outlined{background-color:#ff0;border-radius:50%;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#000;padding:0;font-weight:700}#emulationNewTasksMovement button:hover{background-color:#18a79b}#emulationNewTasksMovement button:focus,#emulationNewTasksMovement button:focus-visible{outline:4px auto -webkit-focus-ring-color;background-color:#18a79b}#emulationNewTasksNumbers button{background-color:#ff0;border-radius:50%;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#000;padding:0;font-weight:700;font-family:monospace}#emulationNewTasksNumbers button:hover{background-color:#18a79b}#emulationNewTasksNumbers button:focus,#emulationNewTasksNumbers button:focus-visible{outline:4px auto -webkit-focus-ring-color;background-color:#18a79b}#emulationNewTasksOther button{background-color:#ff0;border-radius:50%;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#000;padding:0;font-weight:700}#emulationNewTasksOther button:hover{background-color:#18a79b}#emulationNewTasksOther button:focus,#emulationNewTasksOther button:focus-visible{outline:4px auto -webkit-focus-ring-color;background-color:#18a79b}.emulated-button-list{background-color:#ff0;border-radius:50%;border:none;width:40px;height:40px;display:flex;align-items:center;justify-content:center;color:#000;padding:0;font-weight:700!important}.standard-font{font-family:monospace!important}#emulationNewTasks{list-style-type:none;display:grid;grid-template-columns:repeat(11,1fr);grid-auto-rows:auto;gap:10px;padding:0;margin:0}#emulateKeySteps{transform:scaleX(-1)}.flexCol{display:flex;flex-direction:column;align-items:center;justify-content:center}.outerCol{padding-top:15px}.middleCol{align-self:flex-start}.task-container{margin:5px}.task-container>div,.gu-mirror{transition:opacity .4s ease-in-out}.task-container>div{padding:5px;cursor:move;cursor:grab;cursor:-moz-grab;cursor:-webkit-grab;display:flex;align-items:center;justify-content:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.gu-mirror{padding:5px;text-align:center;cursor:grabbing;cursor:-moz-grabbing;cursor:-webkit-grabbing}.task-container .ex-moved{background-color:#e74c3c}.task-container.ex-over{background-color:#ffffff4d}.planner-save-text{max-width:none!important}.planner-save-button{flex:auto}.planner-load-select{max-width:none!important}.planner-load-delete-buttons{width:50%}.planner-saving-label{text-wrap:nowrap}.no-marge{margin:0}.task-modal{z-index:9999;display:none;position:fixed;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:#0006}.task-modal-content{position:relative;background-color:#242424;margin:15% auto;padding:20px;border:2px solid #6c5ce7;max-width:600px;min-width:600px;display:flex;flex-direction:column}.full-width-textarea{width:100%;box-sizing:border-box;resize:vertical}.center-modal{text-align:center}.left-modal{text-align:left!important;display:block}.icon-tooltip{position:relative;cursor:pointer}.icon-tooltip:after{content:attr(data-tooltip);position:absolute;bottom:100%;left:50%;transform:translate(-50%);white-space:nowrap;z-index:1;background-color:#000;color:#fff;padding:5px;border-radius:4px;opacity:0;visibility:hidden;transition:opacity .2s,visibility .2s}.icon-tooltip:hover:after{opacity:1;visibility:visible}.threading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;margin:5px;width:800px;max-width:1280px;text-align:center;border:1px solid #ccc}.gu-mirror{position:fixed!important;margin:0!important;z-index:9999!important;opacity:.8}.gu-hide{display:none!important}.gu-unselectable{-webkit-user-select:none!important;-moz-user-select:none!important;-ms-user-select:none!important;user-select:none!important}.gu-transit{opacity:.2}

</style>
</head>

<body>

    <div id="mainContainer" class="main-container">
        <div class="menu">
            <ul>
                <li id="simulationTab">Simulation</li>
                <li id="controlTab">Control</li>
                <li id="quickTasksTab">Quick Tasks</li>
                <li id="plannerTab">Planner</li>
                <li id="helpTab">Help</li>
            </ul>
        </div>

        <div id="simulationContainer" class="main-container">
            <div id="simulationContent" class="controls-container">
                <div id="gcodeContainer" style="position: relative;">
                    <div id="gcodeEditor" style="height: 200px; width: 100%;"></div>
                </div>
                <div class="innerContainer">
                    <input type="file" id="fileInput" accept=".txt,.gcode">
                </div>
                <div class="innerContainer">
                    <button id="simulateButton">Simulate</button>
                    <button id="clearButton">Clear</button>
                    <button id="helpButton">How to use</button>
                </div>


                <div class="innerContainer" id="loadAndSave">


                    <hr>
                    <div class="innerContainer toolbar">
                        <input type="text" class="saveGCodeNameInput" placeholder="name of save"></input>
                        <button class="saveGCodeButton" title="Save GCode to local browser storage">Save local</button>
                    </div>
                    <div class="innerContainer toolbar">
                        <select class="loadGCodeSelect"></select>
                        <button class="loadGCodeButton" title="Load GCode from local browser storage">Load</button>
                        <button class="deleteGCodeButton" title="Delete GCode from local browser storage">Delete</button>
                    </div>
                    <hr>
                </div>
            </div>

            <div class="canvas-container">
                <canvas id="gcodeCanvas" width="785" height="600"></canvas>
                <div id="sliderContainer" class="innerContainer" style="display: none; width: 400px;">
                    <input type="range" id="progressSlider" min="0" max="100" value="0" style="width: 100%;">
                    <div id="sliderLabel" style="text-align: center;"><br>Drag to see moves</div>
                </div>
                <div id="displayOptionsContainer" class="innerContainer" style="display: none;">
                    <label>
                        <input type="checkbox" id="showStock" checked> Show Stock
                    </label>
                    <label>
                        <input type="checkbox" id="showCuts" checked> Show Cut Moves
                    </label>
                    <label>
                        <input type="checkbox" id="showNonCuts" checked>
                        Show Non-Cut Moves
                    </label>
                </div>
                <div id="sliderContainer" class="innerContainer" style="display: none; width: 400px;">
                    <input type="range" id="progressSlider" min="0" max="100" value="0" style="width: 100%;">
                    <div id="sliderLabel" style="text-align: center;"><br>Drag to see moves</div>
                </div>
                <div class="innerContainer"><button id="zoomButton" title="Zoom in">Zoom In</button></div>
            </div>

        </div>

        <div id="interactiveComponentsContainer" class="main-container">
            <div id="connectionContainer" class="connection-container" style="display: none;">
                <div class="innerContainer">
                    <button id="connectButton" title="Connect to Nano ELS H4">Connect</button>
                </div>
            </div>
            <div id="controlsContainer" class="main-container" style="display: none;">
                <div id="controlsContent" class="controls-container">

                    <div id="latheControls">
                        <div id="jogControls">

                            <span id="toolText" class="tool-label" style="--col: 1; --row: 1">Current Tool</span>

                            <!-- Tools -->
                            <select class="tool-select" style="--col: 1; --row: 2" id="toolSelector">
                                <option value="T0">T0</option>
                                <option value="T1">T1</option>
                                <option value="T2">T2</option>
                                <option value="T3">T3</option>
                                <option value="T4">T4</option>
                                <option value="T5">T5</option>
                                <option value="T6">T6</option>
                                <option value="T7">T7</option>
                                <option value="T8">T8</option>
                                <option value="T9">T9</option>
                                <option value="T10">T10</option>
                                <option value="T11">T11</option>
                                <option value="T12">T12</option>
                                <option value="T13">T13</option>
                                <option value="T14">T14</option>
                                <option value="T15">T15</option>
                                <option value="T16">T16</option>
                                <option value="T17">T17</option>
                                <option value="T18">T18</option>
                                <option value="T19">T19</option>
                                <option value="T20">T20</option>
                                <option value="T21">T21</option>
                                <option value="T22">T22</option>
                                <option value="T23">T23</option>
                                <option value="T24">T24</option>
                                <option value="T25">T25</option>
                                <option value="T26">T26</option>
                                <option value="T27">T27</option>
                                <option value="T28">T28</option>
                                <option value="T29">T29</option>
                            </select>

                            <button class="tool-edit" style="--col: 1; --row: 3;" id="editToolsButton">Edit
                                Tools</button>

                            <button class="tool-btn change-tool" style="--col: 3; --row: 2;" id="toolChange">Change
                                Tool</button>

                            <span id="jogText" class="jog-labels" style="--col: 7; --row: 1">X</span>
                            <span id="fastText" class="jog-labels" style="--col: 6; --row: 2">Fast</span>
                            <span id="slowText" class="jog-labels" style="--col: 6; --row: 3">Slow</span>
                            <button class="arrow fast jog-btn" style="--col: 7; --row: 2" id="fastForward">
                                <i class="fas fa-arrow-up"></i></button>
                            <button class="arrow fast jog-btn" style="--col: 7; --row: 6" id="fastBackward">
                                <i class="fas fa-arrow-down"></i></button>
                            <span id="jogText" class="jog-labels" style="--col: 4; --row: 4">Z</span>
                            <button class="arrow fast jog-btn" style="--col: 5; --row: 4" id="fastLeft">
                                <i class="fas fa-arrow-left"></i></button>
                            <button class="arrow fast jog-btn" style="--col: 9; --row: 4" id="fastRight">
                                <i class="fas fa-arrow-right"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 7; --row: 3" id="slowForward">
                                <i class="fas fa-arrow-up"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 7; --row: 5" id="slowBackward">
                                <i class="fas fa-arrow-down"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 6; --row: 4" id="slowLeft">
                                <i class="fas fa-arrow-left"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 8; --row: 4" id="slowRight">
                                <i class="fas fa-arrow-right"></i></button>
                            <span id="jogText" class="jog-labels" style="--col: 11; --row: 1">Y</span>
                            <button class="arrow fast jog-btn" style="--col: 11; --row: 2" id="fastUp">
                                <i class="fas fa-arrow-up"></i></button>
                            <button class="arrow fast jog-btn" style="--col: 11; --row: 6" id="fastDown">
                                <i class="fas fa-arrow-down"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 11; --row: 3" id="slowUp">
                                <i class="fas fa-arrow-up"></i></button>
                            <button class="arrow slow jog-btn" style="--col: 11; --row: 5" id="slowDown">
                                <i class="fas fa-arrow-down"></i></button>


                        </div>
                        <div id="incrementControls">
                            <button class="increment-btn" data-increment="0.01">0.01</button>
                            <button class="increment-btn" data-increment="0.1">0.1</button>
                            <button class="increment-btn active" data-increment="1">1</button>
                            <button class="increment-btn" data-increment="10">10</button>
                        </div>
                        <div id="feedrateControls" class="innerContentCentre control-inputs">
                            <label for="fastFeedrate">Fast Feedrate:</label>
                            <input type="text" id="fastFeedrate" name="fastFeedrate" value="200">
                            <label for="slowFeedrate">Slow Feedrate:</label>
                            <input type="text" id="slowFeedrate" name="slowFeedrate" value="50">
                        </div>
                        <div id="distanceControl" class="innerContentCentre control-inputs">
                            <label for="moveDistance">Move Distance (mm):</label>
                            <input type="text" id="moveDistance" name="moveDistance" value="1">
                        </div>
                    </div>

                    <div id="gcodeResponseContainer" style="display: none;">
                        <div id="gcodeResponseHeader">GCode Responses</div>
                        <div id="gcodeResponseEditor" style="height: 200px; width: 100%;"></div>
                        <div class="senderError" style="display: none;"></div>
                        <div id="senderProgressContainer">
                            <span id="senderProgressLabel" style="display: none;">Progress...</span>
                            <progress id="senderProgress" max="1" style="display: none;"></progress>
                        </div>
                    </div>
                </div>
                <div class="controls-container">
                    <div class="innerContainer control-inputs">
                        <div class="innerContentCentre control-inputs">
                            <span>Send single command</span>
                        </div>
                        <div class="innerContentCentre sender-inputs">
                            <input id="singleCommandSender" type="text" name="singleCommandSender" autocomplete="off"></input>
                            <div class="innerContentCentre control-inputs">
                                <button id="gcodeSendSingleCommandButton" title="Send GCode to CNC">Send</button>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="controls-container">
                    <div id="gcodeSenderContainer" style="position: relative;">
                        <span>Send multi line commands</span>
                        <div id="gcodeSenderEditor" style="height: 200px; width: 100%;"></div>
                    </div>
                    <div class="innerContainer">
                        <button id="gcodeSenderButton" title="Send GCode to CNC">Send</button>
                        <button id="stopButton" style="display: none;">Stop</button>
                    </div>
                </div>
            </div>
            <div id="quickTasksContainer" class="main-container" style="display: none;">
                <div id="quickTasksContent" class="controls-container">
                    <div class="innerContainer">
                        <h1>Quick Tasks</h1>
                        <button id="quickTaskFacingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- L-shape -->
                                        <path d="M5 45 L35 45 L35 5" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="50" y1="45" x2="50" y2="10" stroke="white" stroke-width="3" />

                                        <!-- Arrow head -->
                                        <path d="M42 17 L50 5 L58 17 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Facing / Parting</p>
                            </div>
                        </button>
                        <button id="quickTaskProfilingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Rotated L-shape -->
                                        <path d="M55 5 L5 5 L5 35" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="22" y1="30" x2="50" y2="30" stroke="white" stroke-width="3" />

                                        <!-- Arrow head (filled) -->
                                        <path d="M22 22 L10 30 L22 38 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Profiling</p>
                            </div>
                        </button>
                        <button id="quickTaskDrillingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Top and bottom horizontal lines -->
                                        <line x1="5" y1="18" x2="50" y2="18" stroke="white" stroke-width="2"></line>
                                        <line x1="5" y1="32" x2="50" y2="32" stroke="white" stroke-width="2"></line>
                                        
                                        <!-- Pointed tip at left -->
                                        <line x1="5" y1="18" x2="0" y2="25" stroke="white" stroke-width="2"></line>
                                        <line x1="5" y1="32" x2="0" y2="25" stroke="white" stroke-width="2"></line>
                                        
                                        <!-- Diagonal flute lines -->
                                        <line x1="10" y1="18" x2="15" y2="32" stroke="white" stroke-width="2"></line>
                                        <line x1="20" y1="18" x2="25" y2="32" stroke="white" stroke-width="2"></line>
                                        <line x1="30" y1="18" x2="35" y2="32" stroke="white" stroke-width="2"></line>
                                        <line x1="40" y1="18" x2="45" y2="32" stroke="white" stroke-width="2"></line>
                                    </svg>
                                </div>
                                <p>Drilling</p>
                            </div>
                        </button>
                        <button id="quickTaskBoringButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Correctly rotated squared U-shape (90° clockwise) -->
                                        <path d="M55 5 L5 5 L5 45 L55 45" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="22" y1="25" x2="42" y2="25" stroke="white" stroke-width="3" />

                                        <!-- Arrow head (filled) -->
                                        <path d="M22 17 L10 25 L22 33 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Boring</p>
                            </div>
                        </button>
                        <button id="quickTaskGroovingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 60">
                                        <!-- U-shape rotated correctly (facing up) -->
                                        <path d="M5 55 L5 5 L45 5 L45 55" fill="none" stroke="white" stroke-width="3" />

                                        <!-- Arrow stem -->
                                        <line x1="25" y1="45" x2="25" y2="15" stroke="white" stroke-width="3" />

                                        <!-- Arrow head (filled) -->
                                        <path d="M17 22 L25 10 L33 22 Z" fill="white" />
                                    </svg>
                                </div>
                                <p>Grooving</p>
                            </div>
                        </button>

                        <button id="quickTaskConeButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Sideways trapezoid -->
                                        <path d="M10 5 L50 15 L50 35 L10 45 Z" fill="none" stroke="white"
                                            stroke-width="3" />
                                    </svg>
                                </div>
                                <p>Cone</p>
                            </div>
                        </button>

                        <button id="quickTaskThreadingButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Background rectangle -->
                                        <!--<rect x="0" y="7.5" width="60" height="35" fill="#e0e0e0"></rect> -->

                                        <!-- Thread lines -->
                                        <line x1="6" y1="41.7" x2="18" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="15" y1="41.7" x2="27" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="24" y1="41.7" x2="36" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="33" y1="41.7" x2="45" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <line x1="42" y1="41.7" x2="54" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <!-- Corrected start of thread -->
                                        <line x1="-3" y1="41.7" x2="9" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                        <!-- Corrected end of thread -->
                                        <line x1="51" y1="41.7" x2="63" y2="8.3" stroke="white" stroke-width="5"
                                            stroke-linecap="round"></line>
                                    </svg>
                                </div>
                                <p>Threading</p>
                            </div>
                        </button>
                        <button id="quickTaskToolOffsetsButton" class="quick-tasks-innercontainer">
                            <div class="quick-tasks-subinnercontainer">
                                <div class="icon-container">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 50">
                                        <!-- Left arrow (pointing up) - thicker shaft -->
                                        <line x1="7.5" y1="45" x2="7.5" y2="10" stroke="white" stroke-width="3" />
                                        <path d="M4 13 L7.5 7.5 L11 13 Z" fill="white" />

                                        <!-- Bottom arrow (pointing right) - thicker shaft -->
                                        <line x1="6" y1="44" x2="50" y2="44" stroke="white" stroke-width="3" />
                                        <path d="M48 40.5 L53.5 44 L48 47.5 Z" fill="white" />

                                        <!-- Gear shifted up 1 unit -->
                                        <path
                                            d="M28 9 L31 9 L32.5 13 L35 14.5 L39 11.5 L40.5 14 L38 18 L39.5 20.5 L43.5 22 L43.5 25 L39.5 26.5 L38 29 L40.5 33 L39 35.5 L35 32.5 L32.5 34 L31 38 L28 38 L26.5 34 L24 32.5 L20 35.5 L18.5 33 L21 29 L19.5 26.5 L15.5 25 L15.5 22 L19.5 20.5 L21 18 L18.5 14 L20 11.5 L24 14.5 L26.5 13 L28 9 M29.5 18 A5 5 0 0 0 29.5 29 A5 5 0 0 0 29.5 18"
                                            fill="white" />
                                    </svg>
                                </div>
                                <p>Tool Offsets</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>

            <div id="plannerContainer" class="main-container" style="display: none;">
                <div id="plannerContent" class="planner-container">
                    <div class="innerContainer">
                        <h1>Planner</h1>
                        <div class="planner-guidance">
                            <span>Use this tool to create a job of tasks to execute. This can be manual, gcode, button
                                press
                                emulation or a
                                combination
                                of them.
                                When you click execute the job wizard will execute the tasks one after another. Each
                                task
                                with require confirmation to start.</span>
                        </div>
                        <div>
                            <button id="googleSignInButton" title="Sign in with Google to save jobs and collections to the cloud">Sign in with
                                Google</button>

                        </div>
                        <div>
                            <span>Sign in with google to ensure your jobs and collects are saved to the cloud, this will allow you to access them on different computers.</span>
                        </div>
                    </div>
                    <div id="taskContainer">
                        <div class="container-wrapper-outer">
                            <div class="container-wrapper">
                                <h2>Current Job</h2>
                                <span>Drag an available task to below</span>
                                <div id="tasksToExecute" class="task-container">
                                </div>
                            </div>
                            <div class="container-wrapper">
                                <button id="executeJobButton">Execute Job</button>
                            </div>
                            <hr>
                            <div class="container-wrapper">
                                <div class="innerContainer" id="loadAndSaveJob">
                                    <div class="innerContainer toolbar">
                                        <button id="saveJobButton" class="planner-save-button" title="Save Job to local browser storage">Save
                                            Job</button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <button id="newJobButton" class="planner-save-button" title="Create a new job">New
                                            Job</button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <button id="loadJobButton" class="planner-load-delete-buttons" title="Load Job from local browser storage">Load</button>
                                        <button id="deleteJobButton" class="planner-load-delete-buttons" title="Delete Job from local browser storage">Delete</button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <span class="planner-saving-label">Project:</span>
                                        <select id="projectLoadSelect" class="planner-load-select">
                                        </select>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <span class="planner-saving-label">Group:</span>
                                        <select id="groupLoadSelect" class="planner-load-select">
                                        </select>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <span class="planner-saving-label">Job:</span>
                                        <select id="jobLoadSelect" class="planner-load-select">
                                        </select>
                                    </div>
                                    <div class="container-wrapper-inner">
                                        <hr>
                                    </div>
                                    <span class="planner-saving-label">Import and export Job to JSON</span>
                                    <div class="innerContainer toolbar">
                                        <button id="importJobButton" class="planner-load-delete-buttons" title="Import Job from JSON file">Import</button>
                                        <button id="exportJobButton" class="planner-load-delete-buttons" title="Export Job to JSON">Export</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container-wrapper-outer">
                            <div class="container-wrapper">
                                <h2>Available Tasks</h2>
                                <div id="availableTasks" class="task-container">
                                </div>
                            </div>
                            <div class="container-wrapper">
                                <div class="container-wrapper-inner">
                                    <span>Drag here to delete</span>
                                </div>
                                <div id="deleteTasks" class="container-wrapper-delete">
                                </div>
                            </div>
                            <div class="container-wrapper">
                                <button id="addNewTaskButton">Add New Task</button>
                            </div>
                            <div class="container-wrapper-inner">
                                <hr class="no-marge">
                            </div>
                            <div class="container-wrapper">
                                <div class="innerContainer" id="loadAndSaveAvailableTasks">
                                    <div><span>Task Collections</span></div>
                                    <div class="innerContainer toolbar">
                                        <button id='saveAvailableTaskCollection' class="planner-save-button" title="Save Task to local browser storage">Save tasks to a collection
                                            <i class="far fa-save show-info icon-tooltip"
                                                data-tooltip="Save to local machine"></i>
                                        </button>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <select id="availableTaskCollections" class="planner-load-select">
                                            <option value="" disabled>Select your option</option>
                                        </select>
                                    </div>
                                    <div class="innerContainer toolbar">
                                        <button id="loadTaskCollection" class="planner-load-delete-buttons" title="Load selected collection">Load collection</button>
                                        <button id="deleteTaskCollection" class="planner-load-delete-buttons" title="Delete selected collection">Delete collection</button>
                                    </div>
                                    <div class="container-wrapper-inner">
                                        <hr>
                                    </div>
                                    <span class="planner-saving-label">Import and export tasks via JSON</span>
                                    <div class="innerContainer toolbar">
                                        <button id="importAvailableTasks" class="planner-load-delete-buttons" title="Import tasks from JSON file">Import</button>
                                        <button id="exportAvailableTasks" class="planner-load-delete-buttons" title="Export tasks to JSON">Export</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="helpContainer" class="main-container" style="display: none;">
                <div id="helpContent" class="controls-container">
                    <div class="innerContainer">
                        <h1>Help Page</h1>
                        <p>Some functionality offered by this tool is not present on the Nano ELS h4/h5 controller by default such as gcode threading and tool offsets. Please see my custom firmware page to download my fork of the firmware: </p>
                        <p><a href="https://github.com/Festivejelly/nanoels/blob/main/h4/h4.ino" target="_blank">Github
                                Repo</a></p>
                    </div>
                </div>
            </div>

        </div>

        <!-------------------------------- Modals------------------------------->
        <!-- Edit Tool Modal -->
        <div id="editToolsModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Edit Tools</h2>
                <div class="modal-pad-bottom-flex">
                    <div class="modal-pad-bottom-flex">
                        <table class="table-auto flex-1">
                            <thead>
                                <tr class="flex w-full">
                                    <th class="flex-none w-16 p-1 text-left border-b">
                                        Tool
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            Z Position<br>Offset
                                        </div>
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            Z Cut<br>Compensation
                                        </div>
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            X Position<br>Offset
                                        </div>
                                    </th>
                                    <th class="flex-1 p-1 text-left border-b">
                                        <div class="leading-tight">
                                            X Cut<br>Compensation
                                        </div>
                                    </th>
                                    <th class="flex-none w-16 p-1 text-left border-b">
                                        Action
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="toolOffsetTableBody">
                                <!-- Rows will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="modal-pad-bottom-flex">
                        <button id="editToolSaveAll" class="execute" title="Save Offsets for tool">
                            <div class="icon-container">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50">
                                    <!-- Outer disk shape -->
                                    <path d="M10 5 L40 5 L45 10 L45 40 L40 45 L10 45 L5 40 L5 10 Z" fill="none"
                                        stroke="white" stroke-width="2" />

                                    <!-- Inner rectangle (disk label) -->
                                    <rect x="15" y="5" width="20" height="15" fill="none" stroke="white"
                                        stroke-width="2" />

                                    <!-- Center circle (represents disk hole) -->
                                    <circle cx="25" cy="30" r="8" fill="none" stroke="white" stroke-width="2" />
                                </svg>
                            </div>
                            <Span>Save All</Span>
                        </button>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="editToolsModalCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Facing Modal-->
        <div id="quickTaskFacingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Facing / Parting</h2>
                <div class="modal-pad-bottom">
                    <span id="quickTaskFacingDescription" class="left-modal">This task will perform a facing or parting operation based off of your current position to the centreline</span>
                </div>
                <div class="modal-pad-bottom">
                    <!-- Current position -->
                    <label for="quickTaskFacingCurrentPosition">Current Position</label>
                    <input type="text" id="quickTaskFacingCurrentPosition" name="quickTaskFacingCurrentPosition" placeholder="0" readonly>
                    <button id="quickTaskFacingRefreshPositionButton" title="Refresh current position">Refresh</button>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskFacingXStartPosition">Start Position X (Radius mm)</label>
                    <input type="text" id="quickTaskFacingXStartPosition" name="quickTaskFacingXStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingZStartPosition">Start Position Z</label>
                    <input type="text" id="quickTaskFacingZStartPosition" name="quickTaskFacingZStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <hr>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskFacingFeedrate">Feed Rate (mm/m)</label>
                    <input type="text" id="quickTaskFacingFeedrate" name="quickTaskFacingFeedrate" placeholder="10" value="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskFacingTravelFeedRate">Travel/Retract Feed Rate (mm/m)</label>
                    <input type="text" id="quickTaskFacingTravelFeedRate" name="quickTaskFacingTravelFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskFacingUsePecking">Use pecking?</label>
                    <input type="checkbox" id="quickTaskFacingUsePecking" name="quickTaskFacingUsePecking" checked>
                </div>
                <div id="quickTaskFacingPeckingDepthContainer">
                    <div class="modal-pad-bottom">
                        <label for="quickTaskFacingPeckingDepth">Depth per peck (mm)</label>
                        <input type="text" id="quickTaskFacingPeckingDepth" name="quickTaskFacingPeckingDepth" placeholder="0.5" value="0.5">
                    </div>
                    <div class="modal-pad-bottom">
                        <label for="quickTaskFacingPeckingRetractionRate">Fully retract tool after this many cuts</label>
                        <input type="number" id="quickTaskFacingPeckingRetractionRate" name="quickTaskFacingPeckingRetractionRate" placeholder="3" value="3" min="1" step="1" oninput="this.value = this.value.replace(/[^0-9]/g, ''); if(this.value === '') this.value = '1';">
                    </div>
                </div>
                <div class="modal-pad-bottom">
                    <hr>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskFacingEndDiameter">End Diameter (mm)
                          <span class="tooltip-icon"
                            data-tooltip="Default is centreline which is 0">?</span>
                    </label>
                    <input type="text" id="quickTaskFacingEndDiameter" name="quickTaskFacingEndDiameter" placeholder="0" value="0">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskFacingExecuteButton" class="execute interaction-ready-button" title="Execute facing command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="white" />
                        </svg>
                    </button>
                    <button id="quickTaskFacingStopButton" class="execute interaction-ready-warn-button" title="Stop facing command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="white" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskFacingCopyToClipboardButton" class="interaction-ready-button" title="Copy command to clipboard">
                        Copy command<br>to clipboard
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskFacingLabel">Execution in progress...</span>
                    <progress id="quickTaskFacingProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskFacingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Profiling Modal-->
        <div id="quickTaskProfilingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Profiling Quick Task</h2>
                <div class="modal-pad-bottom">
                    <!-- Current position -->
                    <label for="quickTaskProfilingCurrentPosition">Current Position</label>
                    <input type="text" id="quickTaskProfilingCurrentPosition" name="quickTaskProfilingCurrentPosition" placeholder="0" readonly>
                    <button id="quickTaskProfilingRefreshPositionButton" title="Refresh current position">Refresh</button>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingXStartPosition">Start Position X (Radius mm)</label>
                    <input type="text" id="quickTaskProfilingXStartPosition" name="quickTaskProfilingXStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingZStartPosition">Start Position Z</label>
                    <input type="text" id="quickTaskProfilingZStartPosition" name="quickTaskProfilingZStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <hr>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingLength">Length to profile (mm)</label>
                    <input type="text" id="quickTaskProfilingLength" name="quickTaskProfilingLength" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingFeedRate">Cutting Feed rate</label>
                    <input type="text" id="quickTaskProfilingFeedRate" name="quickTaskProfilingFeedRate" placeholder="100">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingRetractFeedRate">Retract Feed rate</label>
                    <input type="text" id="quickTaskProfilingRetractFeedRate" name="quickTaskProfilingRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingType">Profiling Type
                        <span class="tooltip-icon"
                            data-tooltip="Absolute cuts to a specified diameter. Relative cuts to a specified depth.">?</span>
                    </label>
                    <select id="quickTaskProfilingType" name="quickTaskProfilingType">
                        <option value="Absolute" selected>Absolute</option>
                        <option value="Relative">Relative</option>
                    </select>
                </div>
                <div class="modal-pad-bottom" id="quickTaskProfilingFinalDiameterContainer">
                    <label for="quickTaskProfilingFinalDiameter">Final Diameter</label>
                    <input type="number" id="quickTaskProfilingFinalDiameter" name="quickTaskProfilingFinalDiameter" placeholder="1">
                </div>
                <div class="modal-pad-bottom" id="quickTaskProfilingDepthContainer" style="display: none;">
                    <label for="quickTaskProfilingDepth">Depth of cut (mm)</label>
                    <input type="number" id="quickTaskProfilingDepth" name="quickTaskProfilingDepth" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingPasses">Passes
                        <span class="tooltip-icon" data-tooltip="This value is calculated">?</span>
                    </label>
                    <input type="number" id="quickTaskProfilingPasses" name="quickTaskProfilingPasses" placeholder="4" value="4" min="1" step="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingDepthPerPass">Depth Per Pass (mm)
                        <span class="tooltip-icon"
                            data-tooltip="This value might get adjusted if the depth isnt devisible exactly by this value">?</span>
                    </label>
                    <input type="number" id="quickTaskProfilingDepthPerPass" name="quickTaskProfilingDepthPerPass" placeholder="0.2" value="0.2">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskProfilingFinishingDepth">Depth of finishing pass (mm)
                    </label>
                    <input type="number" id="quickTaskProfilingFinishingDepth" name="quickTaskProfilingFinishingDepth" placeholder="0.1" value="0.1">
                </div>
                <div class="modal-pad-bottom">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskProfilingExecuteButton" class="execute disabled-button" title="Execute profiling command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="white" />
                        </svg>
                    </button>
                    <button id="quickTaskProfilingStopButton" class="execute interaction-ready-warn-button" title="Stop profiling command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="white" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskProfilingCopyToClipboardButton" class="disabled-button" title="Copy command to clipboard" disabled>
                        Copy command<br>to clipboard
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskProfilingLabel">Execution in progress...</span>
                    <progress id="quickTaskProfilingProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskProfilingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Drilling Modal-->
        <div id="quickTaskDrillingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Drilling Task</h2>
                <div class="modal-pad-bottom">
                    <span id="quickTaskDrillingDescription" class="left-modal">This task will perform a drilling operation from the centreline</span>
                </div>
                <div class="modal-pad-bottom">
                    <!-- Current position -->
                    <label for="quickTaskDrillingCurrentPosition">Current Position</label>
                    <input type="text" id="quickTaskDrillingCurrentPosition" name="quickTaskDrillingCurrentPosition" placeholder="0" readonly>
                    <button id="quickTaskDrillingRefreshPositionButton" title="Refresh current position">Refresh</button>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingZStartPosition">Start Position Z</label>
                    <input type="text" id="quickTaskDrillingZStartPosition" name="quickTaskDrillingZStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <hr>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingDepth">Drilling Depth (mm)</label>
                    <input type="text" id="quickTaskDrillingDepth" name="quickTaskDrillingDepth" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingFeedRate">Drilling Feed Rate</label>
                    <input type="text" id="quickTaskDrillingFeedRate" name="quickTaskDrillingFeedRate" placeholder="50" value="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingRetractFeedRate">Retract Feed Rate</label>
                    <input type="text" id="quickTaskDrillingRetractFeedRate" name="quickTaskDrillingRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskDrillingPeckCheckbox">Peck Drilling</label>
                    <input type="checkbox" id="quickTaskDrillingPeckCheckbox" name="quickTaskDrillingPeckCheckbox" value="Pecking">
                </div>

                <div class="modal-pad-bottom" id="quickTaskDrillingPeckingDepthContainer" style="display: none;">
                    <label for="quickTaskDrillingPeckingDepth">Pecking Depth (mm)</label>
                    <input type="text" id="quickTaskDrillingPeckingDepth" name="quickTaskDrillingPeckingDepth" placeholder="2" value="2">
                </div>

                <div class="modal-pad-bottom">
                    <button id="quickTaskDrillingExecuteButton" class="execute disabled-button" title="Execute drilling command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="white" />
                        </svg>
                    </button>
                    <button id="quickTaskDrillingStopButton" class="execute interaction-ready-warn-button" title="Stop drilling command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="white" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskDrillingCopyToClipboardButton" class="disabled-button" title="Copy command to clipboard" disabled>
                        Copy command<br>to clipboard
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskDrillingLabel">Execution in progress...</span>
                    <progress id="quickTaskDrillingProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskDrillingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Boring Modal-->
        <div id="quickTaskBoringModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Boring Quick Task</h2>
                <div class="modal-pad-bottom">
                    <!-- Current position -->
                    <label for="quickTaskBoringCurrentPosition">Current Position</label>
                    <input type="text" id="quickTaskBoringCurrentPosition" name="quickTasBoringCurrentPosition" placeholder="0" readonly>
                    <button id="quickTaskBoringRefreshPositionButton" title="Refresh current position">Refresh</button>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringXStartPosition">Start Position X (Radius mm)</label>
                    <input type="text" id="quickTaskBoringXStartPosition" name="quickTaskBoringXStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringZStartPosition">Start Position Z</label>
                    <input type="text" id="quickTaskBoringZStartPosition" name="quickTaskBoringZStartPosition" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <hr>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringDepth">Boring Hole Depth (mm)</label>
                    <input type="text" id="quickTaskBoringDepth" name="quickTaskBoringDepth" placeholder="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringFeedRate">Cut Feed Rate</label>
                    <input type="text" id="quickTaskBoringFeedRate" name="quickTaskBoringFeedRate" placeholder="100">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringRetractFeedRate">Retract Feed Rate</label>
                    <input type="text" id="quickTaskBoringRetractFeedRate" name="quickTaskBoringRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringType">Boring Type
                        <span class="tooltip-icon"
                            data-tooltip="Absolute cuts to a specified diameter. Relative cuts to a specified depth.">?</span>
                    </label>
                    <select id="quickTaskBoringType" name="quickTaskBoringType">
                        <option value="Absolute" selected>Absolute</option>
                        <option value="Relative">Relative</option>
                    </select>
                </div>
                <div class="modal-pad-bottom" id="quickTaskBoringFinalDiameterContainer">
                    <label for="quickTaskBoringFinalDiameter">Final Diameter</label>
                    <input type="number" id="quickTaskBoringFinalDiameter" name="quickTaskBoringFinalDiameter" placeholder="1">
                </div>
                <div class="modal-pad-bottom" id="quickTaskBoringDepthOfCutContainer" style="display: none;">
                    <label for="quickTaskBoringDepthOfCut">Depth of cut (mm)</label>
                    <input type="number" id="quickTaskBoringDepthOfCut" name="quickTaskBoringDepthOfCut" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringPasses">Passes
                        <span class="tooltip-icon" data-tooltip="This value is calculated">?</span>
                    </label>
                    <input type="number" id="quickTaskBoringPasses" name="quickTaskBoringPasses" placeholder="1" value="4" min="1" step="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringDepthPerPass">Max Depth Per Pass (mm)
                        <span class="tooltip-icon"
                            data-tooltip="This value might get adjusted if the depth isnt devisible exactly by this value">?</span>
                    </label>
                    <input type="number" id="quickTaskBoringDepthPerPass" name="quickTaskBoringDepthPerPass" placeholder="0.2" value="0.2">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskBoringFinishingDepth">Depth of finishing pass (mm)
                    </label>
                    <input type="number" id="quickTaskBoringFinishingDepth" name="quickTaskBoringFinishingDepth" placeholder="0.1" value="0.1">
                </div>
                <div class="modal-pad-bottom">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskBoringExecuteButton" class="execute disabled-button" title="Execute Boring command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="white" />
                        </svg>
                    </button>
                    <button id="quickTaskBoringStopButton" class="execute interaction-ready-warn-button" title="Stop boring command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="white" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskBoringCopyToClipboardButton" class="disabled-button" title="Copy command to clipboard" disabled>
                        Copy command<br>to clipboard
                    </button>
                </div>
                <div class="modal-pad-bottom" style="display: none;">
                    <span id="quickTaskBoringProgressBarLabel">Execution in progress...</span>
                    <progress id="quickTaskBoringProgressBar" max="1"></progress>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskBoringCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Grooving Modal-->
        <div id="quickTaskGroovingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Grooving Modal</h2>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingDepth">Depth of groove in mm:</label>
                    <input type="text" id="quickTaskGroovingDepth" name="quickTaskGroovingDepth" placeholder="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingWidth">Width of groove in mm:</label>
                    <input type="text" id="quickTaskGroovingWidth" name="quickTaskGroovingWidth" placeholder="50">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingFeedRate">Cut Feed rate</label>
                    <input type="text" id="quickTaskGroovingFeedRate" name="quickTaskGroovingFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskGroovingRetractFeedRate">Retract Feed rate</label>
                    <input type="text" id="quickTaskGroovingRetractFeedRate" name="quickTaskGroovingRetractFeedRate" placeholder="200" value="200">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskGroovingExecuteButton" class="execute" title="Execute grooving command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskGroovingStopButton" class="execute interaction-ready-warn-button" title="Stop grooving command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskGroovingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Cone Modal-->
        <div id="quickTaskConeModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Quick Task: Cone</h2>
                <div class="modal-pad-bottom">
                    <label for="coneStartingDepth">Starting Depth (radius mm)</label>
                    <input type="text" id="coneStartingDepth" name="coneStartingDepth" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="coneEndingDepth">Ending Depth (radius mm)</label>
                    <input type="text" id="coneEndingDepth" name="coneEndingDepth" placeholder="0.2">
                </div>
                <div class="modal-pad-bottom">
                    <label for="coneInternalExternal">External or Internal</label>
                    <select id="coneInternalExternal" name="coneInternalExternal">
                        <option value="External">External</option>
                        <option value="Internal">Internal</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="coneLength">Length</label>
                    <input type="text" id="coneLength" name="coneLength" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <label for="conePasses">Passes</label>
                    <input type="text" id="conePasses" name="conePasses" placeholder="1">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskConeExecuteButton" class="execute" title="Execute cone command">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskConeStopButton" class="execute interaction-ready-warn-button" title="Stop cone command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskConeCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Threading Modal-->
        <div id="quickTaskThreadingModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Threading Quick Task</h2>

                <div class="modal-pad-bottom">
                    <span id="quickTaskThreadingDescription">The threading task will automatically cut a thread based on the outer diameter spec of the thread.<br>
                        The beginning of the thread length will start from your current position</span>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingExternalOrInternal">External or Internal</label>
                    <select id="quickTaskThreadingExternalOrInternal" name="quickTaskThreadingExternalOrInternal">
                        <option value="External" selected>External</option>
                        <option value="Internal">Internal</option>
                    </select>
                </div>

                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingType">Threading Type</label>
                    <select id="quickTaskThreadingType" name="quickTaskThreadingType">
                        <option value="Metric" selected>Metric</option>
                        <option value="UNC">UNC</option>
                        <option value="Custom" disabled>Custom</option>
                    </select>
                </div>

                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingSize">Thread Size</label>
                    <select id="quickTaskThreadingSize" name="quickTaskThreadingSize" disabled>
                        <option value="">Select Thread Size</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingDirection">Thread Direction</label>
                    <select id="quickTaskThreadingDirection" name="quickTaskThreadingDirection">
                        <option value="Right" selected>Right handed thread</option>
                        <option value="Left">Left handed thread</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingLength">Thread Length (mm)</label>
                    <input type="text" id="quickTaskThreadingLength" name="quickTaskThreadingLength" placeholder="10">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskThreadingPasses">Number of passes
                        <span class="tooltip-icon"
                        data-tooltip="Automatically calculated based on 0.1mm per pass. But you can set your own passes.">?</span>
                    </label>
                    <input type="text" id="quickTaskThreadingPasses" name="quickTaskThreadingPasses" placeholder="5">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskThreadingExecuteButton" class="execute disabled-button" title="Execute threading command" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="white" />
                        </svg>
                    </button>
                    <button id="quickTaskThreadingStopButton" class="execute interaction-ready-warn-button" title="Stop threading command" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="white" />
                        </svg>
                    </button>
                    <div class="modal-pad">
                        <button id="quickTaskThreadingCopyToClipboardButton" class="disabled-button" title="Copy command to clipboard" disabled>
                            Copy command<br>to clipboard
                        </button>
                    </div>
                    <div class="modal-pad-bottom" style="display: none;">
                        <span id="quickTaskThreadingProgressBarLabel">Execution in progress...</span>
                        <progress id="quickTaskThreadingProgressBar" max="1"></progress>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskThreadingCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Quick Task Tool offsets Modal-->
        <div id="quickTaskToolOffsetsModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Tool offsets wizard</h2>

                <div class="modal-pad-bottom">
                    <p>Before setting offsets be sure your primary tool (T0 which should be a grooving tool) has been zero'ed on your centre line and Z reference. See this video guide: link</p>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsToolNumber">Tool Number (eg T1)</label>
                    <select type="text" id="quickTaskToolOffsetsToolNumber" name="quickTaskToolOffsetsToolNumber" placeholder="T1">
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsToolType">Tool Type
                        <span class="tooltip-icon"
                            data-tooltip="External tools touch off on front of probe, Internal on the rear.">?</span>
                    </label>
                    <select id="quickTaskToolOffsetsToolType" name="toolOffsetsToolType">
                        <option value="External-Profiling" selected>External: Profiling</option>
                        <option value="External-Facing">External: Facing</option>
                        <option value="External-Grooving">External: Grooving</option>
                        <option value="External-Threading">External: Threading</option>
                        <option value="External-Other">External: Other</option>
                        <option value="Internal-Boring">Internal: Boring</option>
                        <option value="Internal-Grooving">Internal: Grooving</option>
                        <option value="Internal-Threading">Internal: Threading</option>S
                        <option value="Internal-Other">Internal: Other</option>
                        <option value="Drill">Drill</option>
                    </select>
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsOffsetX">X Value</label>
                    <input type="text" id="quickTaskToolOffsetsOffsetX" name="quickTaskToolOffsetsOffsetX" placeholder="0">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsOffsetZ">Z Value</label>
                    <input type="text" id="quickTaskToolOffsetsOffsetZ" name="quickTaskToolOffsetsOffsetZ" placeholder="0">
                </div>
                <div class="modal-pad-bottom">
                    <label for="quickTaskToolOffsetsProbeDiameter">Probe diameter</label>
                    <input type="text" id="quickTaskToolOffsetsProbeDiameter" name="quickTaskToolOffsetsProbeDiameter" placeholder="5">
                </div>
                <div class="modal-pad-bottom">
                </div>
                <div class="modal-pad-bottom">
                    <button id="quickTaskToolOffsetsExecuteButton" class="execute" title="Set tool offset">
                        <Span>Set Tool Offset</Span>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M8 5v14l11-7z" fill="green" />
                        </svg>
                    </button>
                    <button id="quickTaskToolOffsetsStopButton" class="execute interaction-ready-warn-button" title="Stop gcode" style="display: none;">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">
                            <path d="M6 6h12v12H6z" fill="red" />
                        </svg>
                    </button>
                    <div class="modal-pad-bottom" style="display: none;">
                        <span id="quickTaskToolOffsetsLabel">Execution in progress...</span>
                        <progress id="quickTaskToolOffsetsProgressBar" max="1"></progress>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="quickTaskToolOffsetsCloseButton">Close</button>
                </div>
            </div>
        </div>

        <!-- Not Connected warning -->
        <div id="notConnectedModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Not Connected</h2>
                <div class="modal-pad-bottom">
                    <span>Please connect to the controller before executing jobs</span>
                </div>
                <div class="modal-pad">
                    <button id="notConnectedCloseButton">Close</button>
                </div>
            </div>
        </div>
        <!-- Manual Task Modal -->
        <div id="manualTaskModal" class="task-modal">
            <div class="task-modal-content">
                <h2>Manual Task Instructions</h2>
                <hr>
                <div>
                    <span id="manualTaskName"></span>
                </div>
                <div class="modal-pad">
                    <textarea id="manualTaskInstructions" name="manualTaskInstructions" class="full-width-textarea" rows="4" cols="50" disabled></textarea>
                </div>
                <div class="modal-pad">
                    <button id="cancelManualTask">Cancel</button>
                    <button id="completeManualTask" class="interaction-ready-button">Next Task --></button>
                </div>
            </div>
        </div>
        <!-- Gcode Task Modal -->
        <div id="cncTaskModal" class="task-modal">
            <div class="task-modal-content">
                <h2>CNC Task Gcode</h2>
                <hr>
                <div>
                    <span id="cncTaskName"></span>
                </div>
                <div class="modal-pad">
                    <textarea id="cncTaskGcode" name="cncTaskGcode" class="full-width-textarea" rows="4" cols="50" disabled></textarea>
                </div>
                <div class="modal-pad">
                    <button id="cancelCncTask">Cancel</button>
                    <button id="executeGcode">Execute Gcode</button>
                </div>
                <div class="modal-pad">
                    <button id="completeCncTask" disabled>Next Task --></button>
                </div>
                <div id="currentGcodeLineContainer" class="modal-pad">
                    <span id="currentGcodeLineLabel">Current Gcode Line:</span>
                    <span id="currentGcodeLine"></span>
                </div>
                <div id="currentFeedrateContainer" class="modal-pad">
                    <span id="currentFeedrateLabel">Current Feedrate:</span>
                    <span id="currentFeedrate"></span>
                </div>
                <div id="cncTaskSenderProgressContainer" class="modal-pad">
                    <span id="cncTaskSenderProgressLabel">Execution in progress...</span>
                    <progress id="cncTaskSenderProgress" max="1"></progress>
                </div>
            </div>
        </div>
        <!-- key Emulation Task Modal -->
        <div id="emulationTaskModal" class="task-modal">
            <div class="task-modal-content">
                <h2>Key Emulation Task</h2>
                <hr>
                <div>
                    <span id="emulationTaskName"></span>
                </div>
                <div class="modal-pad">
                    <ul id="emulationExecutionTasks">
                        <!-- List items will be added here -->
                    </ul>
                    <div class="modal-pad">
                        <button id="completeEmulationTask" disabled>Mark Complete</button>
                    </div>
                    <div id="emulationTaskSenderProgressContainer" class="modal-pad">
                        <span id="emulationTaskSenderProgressLabel">Execution in progress...</span>
                        <progress id="emulationTaskSenderProgress" max="1"></progress>
                    </div>
                </div>
            </div>
        </div>
        <!-- All tasks Complete Modal -->
        <div id="completeTaskModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>All Tasks Complete</h2>
                <div class="modal-pad">
                    <button id="completeTaskCloseButton">Close</button>
                </div>
            </div>
        </div>
        <!-- Job Cancelled Modal -->
        <div id="jobCancelledModal" class="task-modal">
            <div class="task-modal-content center-modal">
                <h2>Job Cancelled</h2>
                <div>
                    <button id="jobCancelledCloseButton">Close</button>
                </div>
            </div>
        </div>
        <!-- Save Job Modal -->
        <div id="saveJobModal" class="task-modal">
            <div class="task-modal-content">
                <span id="saveJobModalClose" class="close-modal">&times;</span>
                <h2>Save Job</h2>
                <hr>
                <div class="modal-pad">Project:</div>
                <div>
                    <select id="saveProjectNameSelect">
                    </select>
                </div>
                <div id="newProjectNameContainer" style="display: none;">
                    <div class="modal-pad">New project name:</div>
                    <div>
                        <input id="saveProjectNameInput" type="text" class="planner-save-text" placeholder="Name of Project"></input>
                    </div>
                </div>
                <div class="modal-pad">Group name:</div>
                <div>
                    <select id="saveJobGroupNameSelect">
                    </select>
                </div>
                <div id="newJobGroupNameContainer" style="display: none;">
                    <div class="modal-pad">New group name:</div>
                    <div>
                        <input id="saveJobGroupNameInput" type="text" class="planner-save-text" placeholder="Name of Group"></input>
                    </div>
                </div>
                <div class="modal-pad">Name of Job:</div>
                <div>
                    <select id="saveJobNameSelect">
                    </select>
                </div>
                <div id="newJobNameContainer" style="display: none;">
                    <div class="modal-pad">New Job name:</div>
                    <div>
                        <input id="saveJobNameInput" type="text" class="planner-save-text" placeholder="Name of Job"></input>
                    </div>
                </div>
                <div class="modal-pad">
                    <button id="saveJobSaveButton">Save</button>
                </div>
            </div>
        </div>
        <!-- export Job Modal -->
        <div id="exportJobModal" class="task-modal">
            <div class="task-modal-content">
                <span id="exportJobModalClose" class="close-modal">&times;</span>
                <h2>Export Job</h2>
                <hr>
                <div class="modal-pad">Project:</div>
                <div>
                    <select id="exportJobProjectNameSelect">
                    </select>
                </div>
                <div class="modal-pad">Group:</div>
                <div>
                    <select id="exportJobGroupNameSelect">
                    </select>
                </div>
                <div class="modal-pad">Job:</div>
                <div>
                    <select id="exportJobNameSelect">
                    </select>
                </div>
                <div class="modal-pad">
                    <button id="exportJobSaveButton">Save</button>
                </div>
            </div>
        </div>
        <!-- Save Collection -->
        <div id="saveCollectionModal" class="task-modal">
            <div class="task-modal-content">
                <span id="saveCollectionModalClose" class="close-modal">&times;</span>
                <div>
                    <div>Which collection would you like to save the tasks to?</div>
                    <div class="modal-pad">
                        <select id="saveCollectionModalToSaveTo" name="collectionToSaveToModal">
                        </select>
                    </div>
                    <div id="newCollectionNameContainerModal" style="display: none;">
                        <div class="modal-pad">New Collection Name:</div>
                        <div>
                            <input type="text" id="newCollectionNameModal" name="newCollectionNameModal" placeholder="Enter collection name...">
                        </div>
                    </div>

                    <div class="modal-pad">
                        <button id="saveAvailableTaskCollectionButtonModal">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- new task modal-->
        <div id="newTaskModal" class="task-modal">
            <div class="task-modal-content">
                <span id="closeNewTaskModal" class="close-modal">&times;</span>
                <div id="newTaskHelpText">
                    <h2 id="taskTextTitle">Add a new task</h2>
                    <hr>
                    <div class="modal-pad">Task Name:</div>
                    <div>
                        <input type="text" id="newTaskName" name="newTaskName" placeholder="Enter task name...">
                    </div>
                    <div class="modal-pad">Task Type:</div>
                    <div>
                        <select id="newTaskType" name="newTaskType">
                            <option value="manual">Manual</option>
                            <option value="gcode">GCode</option>
                            <option value="emulation" disabled>Key Emulation</option>
                        </select>
                    </div>
                    <div class="modal-pad">Task Description:</div>
                    <div>
                        <textarea id="newTaskDescription" name="newTaskDescription" class="full-width-textarea" rows="4" cols="50" placeholder="Enter Description..."></textarea>
                    </div>
                    <div id="gcodeTaskContainer" style="display:none">
                        <div class="modal-pad">Task GCode:</div>
                        <div>
                            <textarea id="newTaskGcode" name="newTaskGcode" class="full-width-textarea" rows="4" cols="50" placeholder="Disabled for manual tasks" disabled></textarea>
                        </div>

                        <div class="modal-pad">

                            <label for="newTaskGcodeRepeatable">
                                <input type="checkbox" id="newTaskGcodeRepeatable" name="newTaskGcodeRepeatable">
                                Check to make task repeatable
                            </label>
                        </div>
                    </div>
                    <hr>
                    <div id="emulationOuterContainer" class="emulate-noselect" style="display:none">
                        <div>
                            <span>Use built in controller functions by emulating button presses
                                Simply click the buttons you want to emulate to build up a sequence which will be
                                displayed at the bottom. Each emulated press will have a 500ms delay between them.
                                <br>
                                <br>
                                <i>Tip: Hover over the buttons for a description.</i>
                            </span>
                        </div>
                        <div id="emulationInnerContainer">
                            <div class="flexCol outerCol">
                                <div id="numberContainer">
                                    <div id="emulationNewTasksNumbers">
                                        <button id="emulateKey9" data-button-key="B_9" class="standard-font material-symbols-outlined">
                                            9
                                        </button>
                                        <button id="emulateKey8" data-button-key="B_8" class="standard-font material-symbols-outlined">
                                            8
                                        </button>
                                        <button id="emulateKey7" data-button-key="B_7" class="standard-font material-symbols-outlined">
                                            7
                                        </button>
                                        <button id="emulateKey6" data-button-key="B_6" class="standard-font material-symbols-outlined">
                                            6
                                        </button>
                                        <button id="emulateKey5" data-button-key="B_5" class="standard-font material-symbols-outlined">
                                            5
                                        </button>
                                        <button id="emulateKey4" data-button-key="B_4" class="standard-font material-symbols-outlined">
                                            4
                                        </button>
                                        <button id="emulateKey3" data-button-key="B_3" class="standard-font material-symbols-outlined">
                                            3
                                        </button>
                                        <button id="emulateKey2" data-button-key="B_2" class="standard-font material-symbols-outlined">
                                            2
                                        </button>
                                        <button id="emulateKey1" data-button-key="B_1" class="standard-font material-symbols-outlined">
                                            1
                                        </button>
                                        <button id="emulateKey0" data-button-key="B_0" class="standard-font material-symbols-outlined">
                                            0
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="flexCol middleCol">
                                <div id="modeContainer">
                                    <div id="emulationNewTasksMode">
                                        <button id="emulateKeyBack" data-button-key="B_BACKSPACE" class="material-symbols-outlined">
                                            backspace
                                        </button>
                                        <button id="emulateKeyGearbox" data-button-key="B_MODE_GEARS" class="material-symbols-outlined">
                                            manufacturing
                                        </button>
                                        <button id="emulateKeyTurning" data-button-key="B_MODE_TURN" class="material-symbols-outlined">
                                            reply
                                        </button>
                                        <button id="emulateKeyFacing" data-button-key="B_MODE_FACE" class="material-symbols-outlined">
                                            turn_slight_left
                                        </button>
                                        <button id="emulateKeyCone" data-button-key="B_MODE_CONE" class="material-symbols-outlined">
                                            arrow_forward_ios
                                        </button>
                                        <button id="emulateKeyParting" data-button-key="B_MODE_CUT" class="material-symbols-outlined">
                                            publish
                                        </button>
                                        <button id="emulateKeyThreading" data-button-key="B_MODE_THREAD" class="material-symbols-outlined">
                                            home_improvement_and_tools
                                        </button>
                                        <button id="emulateKeyMode" data-button-key="B_MODE_OTHER" class="standard-font material-symbols-outlined">
                                            M
                                        </button>
                                    </div>
                                </div>
                                <div id="movementContainer">
                                    <div id="emulationNewTasksMovement">
                                        <button id="emulateKeyLeft" data-button-key="B_LEFT" class="material-symbols-outlined">
                                            arrow_left_alt
                                        </button>
                                        <button id="emulateKeyRight" data-button-key="B_RIGHT" class="material-symbols-outlined">
                                            arrow_right_alt
                                        </button>
                                        <button id="emulateKeyUp" data-button-key="B_UP" class="material-symbols-outlined">
                                            arrow_upward_alt
                                        </button>
                                        <button id="emulateKeyDown" data-button-key="B_DOWN" class="material-symbols-outlined">
                                            arrow_downward_alt
                                        </button>
                                        <button id="emulateKeyPlay" data-button-key="B_ON" class="material-symbols-outlined">
                                            play_arrow
                                        </button>
                                        <button id="emulateKeyStop" data-button-key="B_OFF" class="material-symbols-outlined">
                                            crop_square
                                        </button>
                                        <button id="emulateKeyStopLeft" data-button-key="B_STOPL" class="material-symbols-outlined">
                                            keyboard_tab_rtl
                                        </button>
                                        <button id="emulateKeyStopRight" data-button-key="B_STOPR" class="material-symbols-outlined">
                                            keyboard_tab
                                        </button>
                                        <button id="emulateKeyStopUp" data-button-key="B_STOPU" class="material-symbols-outlined">
                                            vertical_align_top
                                        </button>
                                        <button id="emulateKeyStopDown" data-button-key="B_STOPD" class="material-symbols-outlined">
                                            vertical_align_bottom
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="flexCol outerCol">
                                <div id="otherContainer">
                                    <div id="emulationNewTasksOther">
                                        <button id="emulateKeyZ" data-button-key="B_Z" class="standard-font material-symbols-outlined">
                                            Z
                                        </button>
                                        <button id="emulateKeyX" data-button-key="B_X" class="standard-font material-symbols-outlined">
                                            X
                                        </button>
                                        <button id="emulateKeyB" data-button-key="B_B" class="standard-font material-symbols-outlined">
                                            B
                                        </button>
                                        <button id="emulateKeyA" data-button-key="B_A" class="standard-font material-symbols-outlined">
                                            A
                                        </button>
                                        <button id="emulateKeyAngle" data-button-key="B_DISPL" class="material-symbols-outlined" title="Angle/Taco">
                                            rotate_left
                                        </button>
                                        <button id="emulateKeySteps" data-button-key="B_STEPZ" class="material-symbols-outlined">
                                            signal_cellular_alt
                                        </button>
                                        <button id="emulateKeySettings" data-button-key="B_SETTINGS" class="material-symbols-outlined">
                                            settings
                                        </button>
                                        <button id="emulateKeyReverse" data-button-key="B_REVERSE" class="material-symbols-outlined">
                                            sync_alt
                                        </button>
                                        <button id="emulateKeyMeasure" data-button-key="B_MEASURE" class="material-symbols-outlined">
                                            space_bar
                                        </button>
                                        <button id="emulateKeyPlus" data-button-key="B_PLUS" class="standard-font material-symbols-outlined">
                                            +
                                        </button>
                                        <button id="emulateKeyMinus" data-button-key="B_MINUS" class="standard-font material-symbols-outlined">
                                            -
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <span>
                                Emulated sequence: <i>Tip: Drag to reorder or delete</i>
                            </span>
                        </div>
                        <div class="emulation-modal-pad-border">
                            <div id="emulationNewTasks">
                            </div>
                        </div>
                        <div class="modal-pad-bottom">
                            <div id="emulatedTasksDelete" class="container-wrapper-inner">
                                <span>
                                    Drag here to delete
                                </span>
                            </div>
                            <div id="emulatedButtonListDelete" class="container-wrapper-delete">

                            </div>
                        </div>
                    </div>
                    <div class="modal-pad">Collection to save to:</div>
                    <div>
                        <select id="collectionToSaveTo" name="collectionToSaveTo">
                        </select>
                    </div>
                    <div id="newCollectionNameContainer" style="display: none;">
                        <div class="modal-pad">New Collection Name:</div>
                        <div>
                            <input type="text" id="newCollectionName" name="newCollectionName" placeholder="Enter collection name...">
                        </div>
                    </div>
                    <div class="modal-pad">
                        <button id="saveNewTaskButton">Save</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="helpModal" class="help-modal">
            <div class="help-modal-content">
                <span id="closeHelpModal" class="close-modal">&times;</span>
                <div id="helpText">
                    <div>This tool is designed to be used in conjunction with LatheCode:</div>
                    <div><a href="https://kachurovskiy.github.io/lathecode/" target="_blank">https://kachurovskiy.github.io/lathecode/</a></div>
                    <div><strong>Please note that this tool is to be used at your own risk and I cannot gaurentee that
                            it will work. This tool targets my custom fork of the H4 firmware which you can find
                            here:</strong> <a href="https://github.com/Festivejelly/nanoels" target="_blank">https://github.com/Festivejelly/nanoels</a></div>
                    <hr>
                    <div>How to use:</div>
                    <ul style="list-style-type: disc; padding-left: 20px;">
                        <li>Use LatheCode to generate the G-code, then paste it into this tool.</li>
                        <li>You can also write the G-code by hand for simple operations such as boring or grooving.
                            <a href="#" id="exampleCode">Click here</a> to load an example.
                        </li>
                        <li>Click"Simulate" to plot the moves onto the canvas.</li>
                        <li>movement lines marked with"; cut" will show in <span class="line red-line"></span><span class="text-red">red</span>.</li>
                        <li>movement lines marked with"; travel" will show in <span class="line green-line"></span><span class="text-green">green</span>.</li>
                        <li>movement lines marked with"; retract" will show in <span class="line orange-line"></span><span class="text-orange">orange</span>.</li>
                        <li>movement lines not marked will default to <span class="line green-line"></span><span class="text-green">green</span>.</li>
                        <li>All other moves will be considered travel moves and will show in green.</li>
                        <li>Any G-code you paste or write can be saved into the browser's local storage. This is useful for saving common operations.</li>
                        <li>When you're ready, you can send the G-code to the Nano ELS H4 by clicking"Send."
                        </li>
                        <li>More functionality to come soon! Version 0.2</li>
                        <li>Please provide feedback, raise issues or make suggestions here: <a href="https://github.com/Festivejelly/LatheGcodeVisualiser" target="_blank">https://github.com/Festivejelly/LatheGcodeVisualiser</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="zoomModal" class="zoom-modal">
            <div class="zoom-modal-content" style="background-color: #242424;">
                <span id="closeZoomModal" class="close-modal">&times;</span>
                <canvas id="zoomCanvas" width="1600" height="1200"></canvas>
                <div id="sliderAndButtonContainer">
                    <div id="zoomSliderContainer" class="innerContainer" style="width: 400px;">
                        <input type="range" id="zoomProgressSlider" min="0" max="100" value="0" style="width: 100%;">
                        <div id="zoomSliderLabel" style="text-align: center;"><br>Drag to see moves</div>
                    </div>
                    <div id="displayOptionsContainerZoom" class="innerContainer">
                        <label>
                            <input type="checkbox" id="showCutsZoom" checked> Show Cut Moves
                        </label>
                        <label>
                            <input type="checkbox" id="showNonCutsZoom" checked>
                            Show Non-Cut Moves
                        </label>
                    </div>
                    <button id="zoomCloseButton">Close</button>
                </div>
            </div>
        </div>
    </div>
</body>

</html>